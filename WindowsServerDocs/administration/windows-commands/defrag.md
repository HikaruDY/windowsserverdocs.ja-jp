---
title: defrag
description: 'Windows コマンド」のトピック * * *- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: aaf1d1ac-996a-4282-9b4d-1e8245ff162c
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 6b5f6231273fb9fe9a99a1cd1bf72dbd0bad71af
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2019
ms.locfileid: "66433910"
---
# <a name="defrag"></a>defrag

>適用先:Windows 10、Windows Server (半期チャネル)、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

検索し、システムのパフォーマンスを向上させるためにローカル ボリュームの断片化されたファイルを統合します。
ローカル メンバーシップ**管理者**はこのコマンドを実行するために必要な最小のグループ、またはそれと同等です。

## <a name="syntax"></a>構文
```
defrag <volumes> | /C | /E <volumes>    [/H] [/M [n]| [/U] [/V]]
defrag <volumes> | /C | /E <volumes> /A [/H] [/M [n]| [/U] [/V]]
defrag <volumes> | /C | /E <volumes> /X [/H] [/M [n]| [/U] [/V]]
defrag <volume> [/<Parameter>]*
```
## <a name="parameters"></a>パラメーター

|パラメーター|説明|
|-------|--------|
|`<volume>`|分析または最適化するボリュームのドライブ文字またはマウント ポイントのパスを指定します。|
|A|指定されたボリュームには、分析を実行します。|
|C|すべてのボリューム上の操作を実行します。|
|D|(これは、既定値) 従来のデフラグを実行します。 階層化ボリュームは、従来のデフラグを実行容量レベルでのみです。|
|E|指定されたもの以外のすべてのボリューム上の操作を実行します。|
|G|指定されたボリュームに記憶域階層を最適化します。|
|H|通常の優先順位で操作を実行 (既定値は低い)。|
|N|階層の最適化は、各ボリュームに最大 n 秒間実行します。|
|K|指定されたボリュームには、スラブの統合を実行します。|
|L|指定されたボリュームに retrim を実行します。|
|M [n]|各ボリューム上の操作をバック グラウンドで並列に実行されます。 最大 n 個のスレッドは、並列で記憶域階層を最適化します。|
|O|メディアの種類ごとの適切な最適化を実行します。|
|T|指定されたボリュームで既に実行中の操作を追跡します。|
|U|画面の操作の進行状況を出力します。|
|V|断片化の統計情報を含む詳細な出力を印刷します。|
|x|指定されたボリュームに空き領域の統合を実行します。|
|?|このヘルプ情報が表示されます。|

## <a name="remarks"></a>注釈
- 特定の種類のファイル システム ボリュームまたはドライブを最適化することはできません。
  -   ファイル システムがロックされているボリュームを最適化することはできません。
  -   ファイル システムがダーティとマークされているボリュームを最適化し、破損している可能性を示すことはできません。 実行する必要があります**chkdsk**ダーティ ボリューム、最適化を行うことができます。 使用して、ボリュームがダーティかどうかを判断できます、 **fsutil**ダーティ クエリ コマンド。 詳細については**chkdsk**と**fsutil**ダーティを参照してください[その他の参照](defrag.md#BKMK_additionalRef)します。
  -   ネットワーク ドライブを最適化することはできません。
  -   Cdrom を最適化することはできません。
  -   されていないファイル システム ボリュームを最適化することはできません**NTFS**、 **ReFS**、 **Fat**または**Fat32**します。
- Windows server 2008 R2、Windows Server 2008、および Windows Vista では、ボリュームの最適化をスケジュールできます。 ただし、ソリッド ステート ドライブ (SSD) または SSD 上に存在する仮想ハード_ディスク (VHD) 上のボリュームを最適化するようにスケジュールすることはできません。
- ここで示す手順を実行するには、ローカル コンピューターの Administrators グループに属しているか、適切な権限を委任されている必要があります。 コンピューターがドメインに参加している場合は、Domain Admins グループのメンバーがここで示す手順を実行できます。 セキュリティ ベスト プラクティスとして、使用を検討して**実行**この手順を実行します。
- ボリュームは少なくとも 15% の空き領域が必要**デフラグ**完全かつ適切に最適化します。 **デフラグ**ファイルの断片の並べ替えの領域としてこのスペースを使用します。 ボリュームの空き領域、15% 未満である場合**デフラグ**は部分的にしか最適化します。 ボリュームの空き領域を増やすには、不要なファイルを削除または別のディスクに移動します。
- 中に**デフラグ**を分析し、ボリュームの最適化、点滅するカーソルが表示されます。 ときに**デフラグ**が完成に分析し、ボリュームの最適化、分析レポート、最適化のレポート、または両方のレポートを表示し、コマンド プロンプトを終了します。
- 既定では、**デフラグ**を指定しない場合は、分析と最適化の両方のレポートの概要を表示、 **/a**または **/v**パラメーター。
- 」と入力して、テキスト ファイルに、レポートを送信することができます **>** <em>ファイル名.txt</em>ここで、*ファイル名.txt*は指定したファイル名です。 たとえば次のようになります。`defrag volume /v > FileName.txt`
- キーを押して、コマンド行で、最適化プロセスを中断する**CTRL + C**します。
- 実行している、**デフラグ**コマンドとディスク デフラグ ツールでは、相互に排他的です。 ボリュームを最適化するディスク デフラグ ツールを使用しているかどうかを実行して、**デフラグ**、コマンドラインでコマンド、**デフラグ**コマンドは失敗します。 逆に、実行する場合、**デフラグ**コマンドやディスク デフラグ ツールを開いて、ディスク デフラグ ツールの最適化オプションをご利用いただけません。

## <a name="BKMK_examples"></a>例
進行状況と詳細な出力を提供しながらドライブ C 上のボリュームの断片化を解消するには、次のように入力します。
```
defrag C: /U /V
```
ドライブ C および D にバック グラウンドで同時にボリュームを最適化するには、次のように入力します。
```
defrag C: D: /M
```
C ドライブにマウントされたボリュームの断片化の分析を実行し、進行状況を提供する、次のように入力します。
```
defrag C: mountpoint /A /U
```
通常の優先順位を持つすべてのボリュームを最適化し、詳細な出力を行うため、次のように入力します。
```
defrag /C /H /V
```

## <a name="BKMK_scheduledTask"></a>スケジュールされたタスク
デフラグのタスクを実行するメンテナンス タスクとしてスケジュール済み、毎週実行するようにスケジュールは通常、します。 管理者を使用して、頻度を変更できます**ドライブの最適化**アプリケーション。
- スケジュールされたタスクから実行する場合**デフラグ**Ssd に対して次のポリシーには。
   - **従来のデフラグ**(つまり移動するファイルをまとめて、適度に連続する) と**retrim** 1 か月に 1 回だけ実行します。
   - 両方**従来デフラグ**と**retrim**がスキップされ、 **analysis**は実行されません。
      - ユーザーが実行した場合**従来デフラグ**手動で、SSD と 3 週間後、最後のスケジュールされたタスクの実行し、[次へ] スケジュールされたタスクの実行は実行**analysis**と**retrim**が、スキップ**従来デフラグ**その SSD 上。
   - 場合**analysis**はスキップされます、**前回実行された**で時間**ドライブの最適化**は更新されません。  Ssd に対しては、**前回実行された**で時間**ドライブの最適化**1 か月前にすることができます。
- このメンテナンス タスク可能性がありますいないデフラグ、すべてのボリュームもため、このタスクは、次の。
   - デフラグを実行するには、コンピューターをスリープ解除しません。
   - コンピューターが AC 電源、上にあり、コンピューターがバッテリ電源に切り替わった場合停止している場合にのみが起動します。
   - コンピューターがアイドル状態である場合を停止します。

## <a name="BKMK_additionalRef"></a>その他の参照
-   [chkdsk](chkdsk.md)
-   [fsutil](fsutil.md)
-   [ダーティ fsutil](fsutil-dirty.md)
-   [コマンド ライン構文の記号](command-line-syntax-key.md)
