---
title: Windows Server のバランス電源プランのチューニング プロセッサの電源管理 (PPM)
description: Windows Server のバランス電源プランのチューニング プロセッサの電源管理 (PPM)
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: Qizha;TristanB
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 8a2ef4fd39554446aaac686e142ad24f53b4efaa
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59863053"
---
# <a name="processor-power-management-ppm-tuning-for-the-windows-server-balanced-power-plan"></a>Windows Server のバランス電源プランのチューニング プロセッサの電源管理 (PPM)

Windows Server 2008 以降、Windows Server は、次の 3 つの電源プランを提供します。**分散**、**高性能**、および**スクリーン セーバーの電源を**します。 **バランス**電源プランが一連の標準的なサーバー ワークロードの最適なエネルギー効率を提供することを目的と既定の選択肢です。 このトピックでは説明の既定の設定を確認するために使用されているワークロードには、**バランス**Windows のいくつか過去のリリースのスキーム。

既定の電源設定の調整を考慮にする場合がありますが大幅に異なるワークロードの特性またはパフォーマンスとこれらのワークロードよりも電力要件を持つサーバー システムを実行する場合 (つまり、カスタムの電源プランを作成します)。 チューニングの有用な情報の 1 つのソースは、[サーバー ハードウェアの電源に関する考慮事項](../power.md)します。 または、ことができますが、**高性能**電源プランが認識する一定レベルの応答性の向上と引き換えにヒットする重要なエネルギーを実行すること可能性がありますが、環境に最適な選択肢です。

>[!Important]
> カスタムを作成し、結果は、ワークロードの特性によって異なります、非常によく理解できるように特定の必要がある場合を除き、Windows Server に含まれている電源ポリシーを活用する必要があります。

## <a name="windows-processor-power-tuning-methodology"></a>Windows プロセッサの電源のチューニング方法


### <a name="tested-workloads"></a>テスト対象のワークロード

"一般的なのでしょうか。 のベストエフォートのセットをカバーするワークロードが選択されています。 Windows Server のワークロード。 明らかにこのセットは実際のサーバー環境の全体の幅の担当者にするものではありません。

データ駆動型の次の 5 つのワークロードでは、各電源ポリシーにチューニングします。

-   **IIS Web サーバーのワークロード**

    Web の基礎と呼ばれる Microsoft 内部ベンチマークは、IIS Web サーバーを実行しているプラットフォームのエネルギー効率を最適化するために使用されます。 セットアップには、web サーバーと web アクセスのトラフィックをシミュレートする複数のクライアントが含まれています。 (メモリ内)、動的、静的なホットの配布と静的コールド (ディスク アクセスが必要な) web ページは、実稼働サーバーの統計の調査によるです。 完全な使用率 (テスト済みのスペクトルの一方の end) に、サーバーの CPU コアをプッシュするには、は、セットアップには十分に高速のネットワークとディスク リソースが必要があります。

-   **SQL Server データベースのワークロード**

    [TPC-e](http://www.tpc.org/tpce/default.asp)ベンチマークは、データベース パフォーマンスの分析のための一般的なベンチマーク。 OLTP ワークロードのチューニングの最適化の PPM の生成に使用されます。 このワークロードは、大量のディスク I/O を備え、そのため、記憶域システム、メモリのサイズの高パフォーマンス要件があります。

-   **ファイル サーバー ワークロード**

    Microsoft が開発したベンチマークと呼ばれる[FSCT](http://www.snia.org/sites/default/files2/sdc_archives/2009_presentations/tuesday/BartoszNyczkowski-JianYan_FileServerCapacityTool.pdf) SMB ファイル サーバーの負荷を生成するために使用します。 サーバーの設定サイズの大きなファイルを作成し、多くのクライアント システム (実際または仮想化) を使用してファイルを開く、閉じるを生成、読み取りおよび書き込み操作。 操作の組み合わせは、実稼働サーバーの統計の調査に基づいています。 CPU、ディスク、およびネットワーク リソースを強調しています。

-   **SPECpower – JAVA ワークロード**

    [SPECpower\_ssj2008](http://spec.org/power_ssj2008/)は能力とパフォーマンスの特性を共同で評価される最初の業界標準の SPEC ベンチマークです。 CPU 負荷のレベルをさまざまなサーバー側 Java ワークロードになります。 多くのディスクまたはネットワーク リソースは必要ありませんが、メモリ帯域幅に関する特定の要件があります。 ユーザー モードでほぼすべての CPU アクティビティの実行します。カーネル モードのアクティビティには、大きな影響を与えるベンチマークの電源および電源管理の決定を除くパフォーマンス特性はありません。

-   **アプリケーション サーバー ワークロード**

    [SAP SD](http://global.sap.com/campaigns/benchmark/index.epx)ベンチマークを使用して、アプリケーション サーバーの負荷を生成します。 2 階層のセットアップは、データベースと同じサーバー ホスト上のアプリケーション サーバーで使用されます。 このワークロードでは、テスト対象の他のワークロードとは異なりますパフォーマンス メトリックとしての応答時間を使用します。 そのための応答性の PPM パラメーターの影響を確認に使用されます。 それにもかかわらず、すべての待機時間の重要な実稼働ワークロードの代表者にすることはありません。

ベンチマーク SPECpower 以外のすべてのパフォーマンス分析のために設計された最初と、ピーク負荷のレベルで実行するために作成されました。 実際の運用サーバーの一般的なはであり、さらに興味深いの中規模軽いロードからがただし、レベル**バランス**の最適化を計画します。 意図的に実行ベンチマークさまざまな負荷レベルで (10% の手順) で 10% までに 100% から (例: アクティブなユーザー/クライアントの数を減らすこと) をさまざまな調整方法を使用しています。

### <a name="hardware-configurations"></a>ハードウェア構成

Windows の各リリースでは、現在のほとんどの実稼働サーバーは、電源プランの分析と最適化プロセスで使用されます。 場合によっては、テストは、次の Windows リリースのリリース スケジュールが一致する実稼働前のシステムで実行されました。

ほとんどのサーバーが 1 ~ 4 プロセッサのソケットで販売されていること、およびサーバーのスケール アップする可能性が低いエネルギー効率の主な考慮事項があるため、電源プランの最適化テストは主に 2 つのソケットと 4 ソケット システムで実行します。 RAM、ディスク、および各テストのネットワーク リソースの量が管理することなどの実際のサーバー環境のために、通常は、コスト制限を考慮しながら、その容量までを実行するには、各システムの許可を選択します適切な構成です。

>[!Important]
> システムは、ピーク時の負荷でを実行する場合でも通常最適化低レベルの負荷の一貫して、ピーク負荷のレベルで実行するサーバーを使用することができるため、**高性能**電源プランの場合を除き、エネルギー効率は、優先度の高いです。

### <a name="metrics"></a>メトリック

すべてのテスト済みのベンチマークは、パフォーマンス メトリックとしてのスループットを使用します。 応答時間は、(SAP、プライマリ メトリックである) を除くこれらのワークロードについて、SLA 要件としてと見なされます。 たとえば、ベンチマークの実行が有効と見なさ"でしょうか。 場合は、平均値または最大応答時間は、特定の値より小さいです。

したがって、チューニング分析も PPM では、パフォーマンス メトリックとしてスループットが使用されます。  最上位の負荷レベル (100% の CPU 使用率) では、目標は、スループットは電源管理の最適化のための複数の % 低下しないことです。 主要な考慮事項は、中、低負荷のレベルで (下記を参照) のように、電源効率を最大化します。

![電源効率性の数式](../../media/serverperf-ppm-formula.jpg)

低周波数で CPU コアを実行すると、エネルギー消費量が軽減されます。 ただし、低周波数は通常スループットが低下し、応答時間が増加します。 **バランス**の電源プランの応答性、電力効率性の意図的なトレードオフがあります。 SAP ワークロードのテストと、その他のワークロードには、応答時間の Sla は、応答時間の増加が固有のワークロード (たとえば 5%) は、特定のしきい値を超えていないことを確認します。

>[!Note]
> システムに切り替えるかする必要があります、ワークロードは、パフォーマンス メトリックとして、応答時間を使用している場合、**高性能**電源プランまたは変更**バランス**で提案されている電源プラン[迅速な応答時間のバランス電源プランのパラメーターをお勧めします](recommended-balanced-plan-parameters.md)します。

### <a name="tuning-results"></a>チューニングの結果

Microsoft は Windows Server 2008 以降、Windows の各リリースの最新のサーバーのプロセッサの PPM パラメーターを最適化するには、Intel と AMD と連携してください。 パラメーターの組み合わせの PPM の膨大な数は、それぞれ異なる負荷レベルで最適な電源効率を検索する前に説明されているワークロードのテストされています。 アルゴリズムの洗練されたソフトウェアとして、ハードウェアの電源のアーキテクチャとして進化, それぞれ新しい Windows Server 常がまたはテスト ワークロードの範囲全体でその以前のバージョンよりも電源効率を等しきます。

次の図は、Windows Server 2008 R2 を実行している 4 ソケットの実稼働サーバー上の別の TPC-e 負荷レベルで電源効率の例を示します。 中程度の負荷レベルが Windows Server 2008 との比較で 8% 改善が表示されます。

![電源効率性の比較](../../media/serverperf-ppm-figure1.jpg)

## <a name="customized-tuning-suggestions"></a>カスタマイズされたチューニングの推奨事項

使用、既定の 5 つのワークロードから大幅にプライマリ ワークロードの特性が異なる場合**バランス**電源プランの PPM チューニング、最適を検索する 1 つまたは複数の PPM パラメーターを変更することで試すことができます、環境。

パラメーターの複雑さと数、困難な作業では、可能性がありますが、特定の環境の電力消費量とワークロードの有効性の最適なトレードオフを探している場合は、労力を費やす価値可能性があります。

 PPM の調整可能なパラメーターの完全なセットが見つかります[プロセッサの電源管理のチューニング](https://msdn.microsoft.com/windows/hardware/gg566941.aspx)します。 いくつかの最も簡単な power パラメーターで開始する可能性があります。

-   **プロセッサ パフォーマンスの向上しきい値とプロセッサ パフォーマンスの向上時刻**– より大きな値には、アクティビティの増加にパフォーマンスの応答が速度が遅い

-   **プロセッサ パフォーマンスの低下しきい値**– 値が大きい quicken アイドル期間 power 応答

-   **プロセッサ パフォーマンスの低下時間**– より大きな値がアイドル状態のときより段階的にパフォーマンスを低下

-   **プロセッサ パフォーマンスの向上ポリシー** –"Single でしょうか。 ポリシーが向上し、持続的なアクティビティへの応答をパフォーマンスの低下します。"Rocket でしょうか。 ポリシーは、アクティビティの増加にすばやく反応します。

-   **プロセッサ パフォーマンスの低下ポリシー** –"Single でしょうか。 ポリシーが長いアイドル期間が経過より段階的にパフォーマンスを減少します。"Rocket でしょうか。 ポリシーを削除 power 非常に短時間アイドル状態の期間を入力するときに

>[!Important]
> 任意の実験を開始する前に、まず、右側の PPM パラメーターの選択を行い、チューニング作業を軽減する際に役立つ、ワークロードを理解する必要があります。

### <a name="understand-high-level-performance-and-power-requirements"></a>高レベルのパフォーマンスと電源の要件を理解します。

場合は、ワークロードが"リアルタイムでしょうか。 (例: 故障または他の影響を受けやすい表示されているエンドユーザーに影響を与えます)、に切り替える必要があります多くの場合の電力消費量が環境内の主な基準でない場合や応答性が非常に厳密な要件(例:は株式仲買、)、**高性能**電源プラン。 それ以外の場合のワークロードの応答時間の要件を理解し、し、引き続きそれらの要件を満たしている最適な電源効率の PPM パラメーターを調整する必要があります。

### <a name="understand-underlying-workload-characteristics"></a>基になるワークロードの特性を理解します。

ワークロードを把握し、チューニングの実験のパラメーター セットを設計する必要があります。 たとえば、CPU コアの頻度が非常に増やす必要がある場合 (重要なアイドル期間とバーストのワークロードがあると仮定が新しいトランザクションがときに、非常に高速の応答性が必要) 高速で、プロセッサのパフォーマンス向上ポリシー"rocket でしょうか。 に設定する必要があります。 (これは、名前が示すようがシュートする期間のステップ実行するのではなく、その最大値に CPU コア周波数)。

ワークロードが非常に集中的な場合は、CPU の頻度をバーストの到着後に早くステップ実行を開始する、PPM をチェックする間隔を削減できます。 少数のコアで、可能性のあるも改善する可能性がで実行するワークロードを強制する、コア パーキングを有効にすることができますし、ワークロードが高いスレッドの同時実行を持っていない場合、プロセッサのキャッシュ ヒット率を使用します。

中程度の使用率のレベル (つまり、ワークロードが大きくないしないレベル) で CPU の周波数を向上する場合は、プロセッサ パフォーマンスの拡大/縮小のしきい値はアクティビティの特定のレベルが確認されるまで反応を調整できます。

### <a name="understand-periodic-behaviors"></a>定期的な動作を理解します。

日中と夜間、週末、または、さまざまなパフォーマンス要件にすることがあります。 または異なるタイミングで実行されているさまざまなワークロードがある可能性があります。 この場合、PPM パラメーターの 1 つのセットが最適でないの全期間。 複数のカスタムの電源プランを考案することができます、ために、さまざまな期間の調整やスクリプトなどの動的なシステム構成の方法で電源プランの切り替えもすることは。

ここでも、これは重要なハードウェアのアップグレードまたは負荷の変化がある場合に繰り返される必要がありますがどの程度の値は、チューニングのこの型から得られるの質問のため、最適化プロセスの複雑さを追加します。

Windows は、このため、**バランス**ないため、多くの場合でおそらく手作業 - 特定のサーバー上の特定のワークロードのチューニングの労力を費やす価値の電源プラン、最初の場所。

## <a name="see-also"></a>関連項目
- [サーバー ハードウェアのパフォーマンスに関する考慮事項](../index.md)
- [サーバー ハードウェアの電源に関する考慮事項](../power.md)
- [電源とパフォーマンスのチューニング](power-performance-tuning.md)
- [プロセッサの電源管理の調整](processor-power-management-tuning.md)
- [バランスの取れたプラン パラメーターをお勧めします。](recommended-balanced-plan-parameters.md)
