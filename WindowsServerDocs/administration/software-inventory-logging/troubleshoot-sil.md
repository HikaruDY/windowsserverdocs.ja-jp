---
title: ソフトウェア インベントリ ログのトラブルシューティング
description: ソフトウェア インベントリ ログの展開の一般的な問題を解決する方法について説明します。
ms.custom: na
ms.prod: windows-server-threshold
ms.technology: manage-software-inventory-logging
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
author: brentfor
ms.author: coreyp
manager: lizapo
ms.date: 10/16/2017
ms.openlocfilehash: 6ea8a336e2c40b55e2ad6b508d89db7dcb668315
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59832853"
---
# <a name="troubleshoot-software-inventory-logging"></a>ソフトウェア インベントリ ログのトラブルシューティング 

>適用先:Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows Server 2008 R2 の Windows Server (半期チャネル)

##<a name="understanding-sil"></a>SIL を理解します。

SIL のトラブルシューティングを開始する前に、そのコンポーネントとそのしくみをよく理解が必要です。 次のビデオでは、SIL および SIL アグリゲーターの概要とそれらを使用して転送する方法とレポートのインベントリ データを与えます。

1. [ソフトウェア インベントリ ログ (SIL) (10:57) の概要](https://channel9.msdn.com/Blogs/Regular-IT-Guy/An-Introduction-to-Software-Inventory-Logging-SIL)

2. [ソフトウェア インベントリ ログ。SIL アグリゲーター (14:34) の設定](https://channel9.msdn.com/Blogs/windowsserver/Software-Inventory-Logging-Setting-up-SIL-Aggregator)

3. [ソフトウェア インベントリ ログ。SIL 転送 (7:20) を有効にします。](https://channel9.msdn.com/Blogs/windowsserver/Software-Inventory-Logging-Enabling-SIL-Forwarding)

##<a name="how-sil-data-flow-works"></a>SIL データが動作をフローする方法

SIL フレームワークは、2 つの主要なコンポーネントとの通信の 2 つのチャネルがあります。 両方の間でデータのフローでは、チャネル、および、両方のコンポーネント間では、(仮想化された、またはクラウド環境で--純粋に物理的な環境だけでかまいません 1 つの通信チャネルを想定) SIL 展開を成功させるために必要です。 コンポーネントとそれを正しくデプロイする SIL のデータ フローを理解する必要があります。 後は、上記の概要ビデオ両方チャネル上で、コンポーネントとデータのフローを示すアーキテクチャ図を見てきましたされます。 オレンジ色の矢印は、WinRM を介してリモート クエリを示します、緑の破線の矢印は、HTTPS からの投稿、SIL アグリゲーターに SIL で各 WS 終了ノードを示します。

![](../media/software-inventory-logging/image1.png)

SIL に問題が発生した場合の場合に関連していますのデータ フローの中断、チャネルを経由し、コンポーネント間。 次は、次のセクションでの 3 つの問題を解決するトラブルシューティング手順の後、データ フローに関連する最も一般的な問題に示します。

-   **データ フローの問題 1** –**発行 SilReport コマンドレットを使用する場合、レポートにデータがない**(または通常のデータがありません)。

-   **データ フローの問題 2** –**が不明なホストで多くのサーバー**レポートにします。

-   **データ フローの問題 3** –**すぎます不明な OS として示されている物理ホストで多数の Vm**レポート、またはを使用する場合に生成されたエラーにおける**Publish-sildata** SIL を実行している Windows サーバー。

##<a name="troubleshooting-data-flow-issues"></a>データ フローの問題のトラブルシューティング

開始する前に、SIL アグリゲーターを使い始める前に理解する必要があります、**開始 SilAggregator**コマンドレット。

>[!IMPORTANT]
>されませんデータ レポートのローカル システム時刻の午前 3 時に、SQL データ キューブが処理されるまでです。 トラブルシューティング、キューブのデータが処理されるまでの手順に進まないでください。

キューブが処理、またはキューブがこれまで (新規インストールの場合) の処理前に次の手順をリアルタイムで SQL データ キューブを処理する場合は、前回よりも新しいレポート (または、レポートに表示されない) 内のデータのトラブルシューティングを行う:

1. SQL Server の管理者としてログインし、実行**SSMS**コマンド プロンプトでします。
2. データベース エンジンに接続します。
3. 展開**SQL Server エージェント**順に展開**ジョブ**します。
4. 右クリックして**SILStagingRefresh**選び**ステップでジョブを開始**します。
5. クリックして**開始**更新の進行状況バーが終了するまで待機します。
6. 実行管理者として PowerShell を開き、**発行 silreport openreport**コマンドレット。

データがないままで、レポート場合、は、3 つのデータ フローに関する問題のトラブルシューティングを続行します。

###<a name="data-flow-issue-1"></a>データ フローの問題 1 

####<a name="no-data-in-the-report-when-using-the-publish-silreport-cmdlet-or-data-is-generally-missing"></a>発行 SilReport コマンドレットを使用する場合、レポートにデータがない (または、データは一般に不足している)

データがない場合は、SQL データ キューブがまだ処理もしない原因と考えられます。 最近が処理が不足しているデータ キューブの処理の前に、アグリゲーターで到着する必要がありますと思われる場合は、逆の順序でデータのパスに従ってください。 トラブルシューティングを行うには、一意のホストと一意の VM を選択します。 逆の順序でデータ パスになります**SILA レポート** &lt; **SILA データベース** &lt; **SILA ローカル ディレクトリ** &lt;  **。リモートの物理ホスト**または**SIL/エージェントのタスクを実行している WS VM**します。

####<a name="check-to-see-if-data-is-in-the-database"></a>データは、データベースを確認してください。

データをチェックする 2 つの方法はあります。**Powershell**または**SSMS**します。

>[!Important]
>SILA データベースにデータを挿入するため、キューブが少なくとも 1 回処理された場合、このデータはレポートに反映する必要があります。 データベースのデータがない場合、物理ホストのポーリングが失敗して、または HTTPS、またはその両方で何が受信されません。

 ####<a name="powershell"></a>PowerShell

1. 実行管理者として PowerShell を開き、 **get silvmhost**コマンドレットを実行し、 **get silaggregator**。

    >[!NOTE]
    >出力**get silaggregator**模倣は常に、 **Windows サーバーの詳細 タブ**の Excel レポートします。 異なる結果を期待しないでください。

2. 実行**get silvmhost**
 - ありますを使用してホストを追加し、ホストが表示されない場合、**追加 silvmhost**コマンドレット。
 - ホストとして表示されている場合**不明な**問題 2 に移動します。 d - ホストが表示されますが、ある場合ありません**datetime**下、**最近ポーリング**列で、次に移動**問題 2**以下。

**その他の関連するコマンド**

**Get SilAggregator Computername&lt;データをプッシュする既知のサーバーの fqdn&gt;**:キューブが処理する前に、データベースからコンピューター (VM) に関する情報が生成されます。 したがってこのコマンドレットは、SIL データをプッシュする前に、または、午前 3 時にキューブ処理せず、HTTPS (または、このセクションの冒頭で説明されている、リアルタイムでキューブを更新していないかどうか) 経由で Windows Server のデータベース内のデータの確認を使用できます。

**Get SilAggregator %vmhostname&lt;ポーリング済み物理ホストの fqdn が Get SilVmHost コマンドレットを使用する場合に、[最近使用したポーリング] 列の値をある&gt;**:キューブが処理する前に、物理ホストについて、データベースから情報が生成されます。

####<a name="ssms"></a>SSMS

n**をポーリングするホストからのデータを確認します。**
 
1. 開いている**SSMS**に接続して、**データベース エンジン**します。
2. 展開**データベース**、展開、 **SoftwareInventoryLogging**データベースを展開**テーブル**を右クリックして、 **HostInfo**テーブルし、上位 1000 行を選択します。 

    テーブルの 1 つまたは複数のホストにデータがある場合、/those ホストに対するポーリングが成功した少なくとも 1 回。

 **Vm、または HTTPS 経由でデータがプッシュされるスタンドアロン サーバーからデータを確認します。** 

1. 開いている**SSMS**に接続して、**データベース エンジン**します。
a2 です。 展開**データベース**、展開、 **SoftwareInventoryLogging**データベースを展開**テーブル**を右クリックして、 **VMInfo**テーブルし、上位 1000 行を選択します。 

    >[!NOTE] 
    >各行の一意の VM が 1 つの処理を表す**bmil**ファイルは正常に HTTPS 経由でプッシュされ、SIL アグリゲーターで処理します。 Bmil ファイルは、SIL が使用する独自のファイル、1 つ作成されますが、各 SIL インスタンスであるのみ必要なときにメモでは、仮想環境で SIL と SILA を使用します。 します。 それ以外の場合の HTTPS トラフィックのみが必要/必要です)。

 キューブが処理した後、データベース内のすべてのデータを SIL レポートに反映される必要があります。

###<a name="data-flow-issue-2"></a>データ フロー問題 2
####<a name="too-many-servers-under-unknown-host"></a>不明なホストでサーバーが多すぎます

これは、SIL アグリゲーターが仮想マシンをホストしている物理ホストを正常にポーリングしていないときに、仮想環境で発生する可能性があります。

1. 開いている**PowerShell**実行で、管理者として、 **get silvmhost**コマンドレット。

    -   ホストとして表示されている場合**不明な**、**追加 silvmhost**コマンドレットが正しく動作しなかった – 通常、これらのホストにアクセスするための追加、無効な資格情報のため (そのため、不明な)。 資格情報が検証される場合の自動検出可能性がありますが、 **hosttype**と**hypervisortype**で、**追加 silvmhost**コマンドレットによって認識されませんでした、プラットフォームです。 詳細なトラブルシューティングのこのような場合は、使用可能な手順が、ここで取り上げていない (SIL アグリゲーターのイベント ビューアー チャネルを確認してください)。

    -   ホストが一覧される場合と**hosttype**と**hypervisortype**ない値が一覧表示**不明な**、つまり、 Windows と、HyperV または Ubuntu、Xen などがあるありません**datetime** **最近のポーリング**列、ポーリングが正常にまだ行われていません。

        -   発生するポーリングのホストを追加した後 1 時間ほど待機する必要があります (この間隔の設定と仮定した場合: 既定値にチェックを使用して、 **get silaggregator**コマンドレット)。

        -   1 時間を経過したホストが追加されたため場合、は、ポーリング タスクが実行されていることを確認します。**タスク スケジューラ**を選択します**ソフトウェア インベントリ ログ アグリゲーター**  **Microsoft** &gt; **Windows**確認タスクの履歴。

    -   ホストが表示されているの値がない場合**RecentPoll**、 **HostType**、または**HypervisorType**、ほとんど無視できます。 これは、HyperV 環境でのみ発生します。 このデータは、実際には、HTTPS 経由で実行されている物理ホストを識別する、Windows Server VM から取り込まれます。 これが報告して、データベースを使用して、マイニングが必要ですが、特定の VM を特定するに役立ちます、 **Get SilAggregatorData**コマンドレット。

ホストが正常にポーリングして後、は、これらの物理ホスト SILA データベース内のデータを表示するができますが、 **datetime** **最近ポーリング**。 上記の問題の 1 セクションは、このデータを取得するための手順を説明します。

###<a name="data-flow-issue-3"></a>データ フローの問題 3
####<a name="too-many-physical-hosts-with-vms-listed-as-unknown-os"></a>不明な OS として表示されている Vm での物理ホストが多すぎます

1. 1 つ Windows Server 終了ノード (VM) でこれらのホストのいずれかがわかっている、管理者としてログインを選択します。
2. 管理者として PowerShell を開きます。
3. 確認**SilLogging**を使用して実行している、 **Get-sillogging**コマンドレット。
 - を実行している場合を使用して手動で SIL データをプッシュしよう**Publish-sildata**します。

  - エラーがある場合。
     - 確認、 **targeturi**が**https://** エントリにします。
     - すべての前提条件が満たされていることを確認します。 
     - Windows Server のすべての必要な更新プログラムがインストールされていることを確認 (SIL の前提条件を参照してください)。 (WS 2012 R2 のみ) を確認する簡単な方法では、次のコマンドレットを使用してこれらの検索です。**Get-silwindowsupdate \*3060、 \*3000**
     - 適切なストアでインベントリされるローカル サーバー上で、アグリゲーターでの認証に使用される証明書がインストールされていることを確認**SilLogging**します。
     - SIL アグリゲーターのアグリゲーターでの認証に使用されている証明書の証明書の拇印が使用してリストに追加されますが、 **Set-silaggregator** **-AddCertificateThumbprint**コマンドレット。
     - エンタープライズ証明書を使用する場合、SIL が有効になっているサーバーが、証明書を作成したドメインに参加していること、あるいはルート証明機関で検証できることを確認します。 アグリゲーターへのデータの転送/プッシュを試みるローカル マシン上で証明書が信頼されていない場合、この操作は失敗しエラーが返されます。

    問題が解決しないかどうかが上記のすべてのチェックおよび検証がされています。

    - SIL アグリゲーターをインストールするために使用する証明書が正常であり、SIL アグリゲーター サーバーそのものの名前と一致することを確認します。 また、SIL アグリゲーターをインストールするためにエンタープライズ証明書が使用される場合、証明書が作成したドメインにアグリゲーターを参加させる必要がある場合があります (この手順は、他のコンピューターが正常に同じ SIL アグリゲーターに転送している場合は、必要ありません)。

    -  最後に、転送/プッシュを試行しているサーバー上のキャッシュされた SIL ファイルの次の場所を確認できる**\Windows\System32\Logfiles\SIL**します。 場合**SilLogging**が開始され、1 時間以上が実行されているまたは**Publish-sildata**が最近、実行ファイルがないこのディレクトリには、アグリゲーターへのログ記録よりも、成功しました。

エラーなしに、およびコンソールに出力されませんが、データ プッシュ/Windows Server の終了ノードからに発行 HTTPS 経由で SIL アグリゲーターが成功した場合。 管理者として SIL アグリゲーターにデータ転送、ログインの経路をたどるし、到着したデータ ファイルを確認します。 移動して**Program Files (x86)** &gt; **Microsoft SIL アグリゲーター** &gt; SILA ディレクトリ。 リアルタイムで到着したデータ ファイルを見ることができます。

>[!NOTE] 
>1 つ以上のデータ ファイルが転送される可能性がありますが、 **Publish-sildata**コマンドレット。 SIL 終了ノードには、最大 30 日間の失敗したプッシュの数をキャッシュします。 次の成功したプッシュが、すべてのデータ ファイルを処理するため、アグリゲーターに変わります。 これで、SIL アグリゲーターを新たに設定でしたを表示する独自のセットアップする前にも終了ノードからのデータ。

>[!NOTE] 
>SILA 従う SILA ディレクトリ内のトラフィックの少ない状況に関連するデータ ファイルを処理するときに規則があります。 大量のトラフィックには、常にリアルタイムで処理がトリガーされます。 既定の動作は、ある処理が開始いずれかまたは 15 分後に、ディレクトリ内に 100 個のファイルが受信した後です。 小規模環境でのエンド ツー エンドのトラブルシューティングを行うときは、15 分待機する必要があります。

これらのファイルが処理された後、データベース内のデータが表示されます。
