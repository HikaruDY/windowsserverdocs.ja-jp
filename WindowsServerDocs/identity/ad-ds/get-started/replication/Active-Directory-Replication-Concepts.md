---
ms.assetid: 4cc9c16c-1928-4dce-a3a8-6229be28eb65
title: Active Directory レプリケーションの概念
description: ''
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 087dee7c914b81d97c6cf3a2ea985d809cb57fe6
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59812353"
---
# <a name="active-directory-replication-concepts"></a>Active Directory レプリケーションの概念

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

サイトのトポロジを設計する前に、いくつかの Active Directory レプリケーションの概念の理解します。  
  
-   [接続オブジェクト](#BKMK_1)  
  
-   [KCC](#BKMK_2)  
  
-   [フェールオーバーの機能](#BKMK_3)  
  
-   [[サブネット]](#BKMK_4)  
  
-   [サイト](#BKMK_5)  
  
-   [サイト リンク](#BKMK_6)  
  
-   [サイト リンク ブリッジ](#BKMK_7)  
  
-   [サイト リンクの推移性](#BKMK_8)  
  
-   [グローバル カタログ サーバー](#BKMK_9)  
  
-   [ユニバーサル グループ メンバーシップのキャッシュ](#BKMK_10)  
  
## <a name="BKMK_1"></a>接続オブジェクト  
接続オブジェクトは、ソース ドメイン コント ローラーからレプリケーション先のドメイン コント ローラーへのレプリケーション接続を表す Active Directory オブジェクトです。 ドメイン コント ローラーが 1 つのサイトのメンバーであり、サイトで Active Directory Domain Services (AD DS) 内のサーバー オブジェクトで表されます。 各サーバー オブジェクトには、NTDS 設定オブジェクトをサイトにレプリケートするドメイン コント ローラーを表す子があります。  
  
接続オブジェクトは、移行先サーバー上の NTDS 設定オブジェクトの子です。 2 つのドメイン コント ローラーの間に発生するレプリケーションは、1 つのサーバー オブジェクトにもう一方の入力方向のレプリケーションを表す接続オブジェクトが必要です。 ドメイン コント ローラーのすべてのレプリケーション接続は、NTDS 設定オブジェクトの下の接続オブジェクトとして格納されます。 接続オブジェクトは、レプリケーション元サーバーを識別する、レプリケーションのスケジュールが含まれています、およびレプリケーション トランスポートを指定します。  
  
知識整合性チェッカー (KCC) が自動的に、接続オブジェクトを作成しますが、手動で作成することもできます。 KCC によって作成された接続オブジェクトが Active Directory サイトに表示され、サービス スナップインとして**<automatically generated>** 通常の動作条件下で十分なと見なされます。 管理者によって作成された接続オブジェクトは、接続オブジェクトを手動で作成されます。 手動で作成した接続オブジェクトは、作成時に、管理者によって割り当てられた名前によって識別されます。 変更する場合、 **<automatically generated>** 接続オブジェクトを変更した管理接続オブジェクトに変換して、GUID の形式にオブジェクトを表示します。 KCC では、手動または変更された接続オブジェクトへの変更は行われない。  
  
## <a name="BKMK_2"></a>KCC  
KCC は、すべてのドメイン コント ローラーで実行され、Active Directory フォレストのレプリケーション トポロジを生成する組み込みのプロセスです。 KCC は、サイト (サイト) 内、または (サイト間) のサイト間レプリケーションが行われているかどうかに応じて、別々 のレプリケーション トポロジを作成します。 KCC は、新しいドメイン コント ローラー、既存のドメイン コント ローラーの削除、ドメイン コント ローラーとの間のサイト、コストと、スケジュールを変更して、ドメイン コント ローラーの移動の加算に対応するためにトポロジを動的に調整します。一時的に利用不可またはエラー状態にします。  
  
サイト内で大規模なサイトでの待機時間を減らす別のショートカットの接続での双方向リング書き込み可能なドメイン コント ローラー間の接続は常に配置されます。 その一方で、サイト間トポロジには、1 つのサイト間の接続は、各ディレクトリ パーティションの 2 つのサイト間が存在し、ショートカットの接続を含まない一般的には、ツリーのまたがりメモリ割り当ての階層化です。 ツリーと Active Directory レプリケーション トポロジのまたがりメモリ割り当ての詳細については、Active Directory レプリケーション トポロジのテクニカル リファレンスを参照してください ([https://go.microsoft.com/fwlink/?LinkID=93578](https://go.microsoft.com/fwlink/?LinkID=93578))。  
  
各ドメイン コント ローラーは、KCC は、他のドメイン コント ローラーからの接続を定義する一方向の受信接続オブジェクトを作成してレプリケーション ルートを作成します。 同じサイト内のドメイン コント ローラーは、KCC は、管理者の介入なしに自動的に接続オブジェクトを作成します。 複数のサイトがある場合は、サイト間でのサイト リンクを構成して、各サイトの 1 つの KCC とサイト間の接続を自動的に作成されます。  
  
### <a name="kcc-improvements-for-windows-server-2008-rodcs"></a>Windows Server 2008 Rodc の KCC の機能強化  

Windows Server 2008 で新しく使用可能な読み取り専用ドメイン コント ローラー (RODC) に対応するために、KCC の機能強化を数多くあります。 RODC の一般的な配置シナリオでは、ブランチ オフィスです。 このシナリオで最もよく展開されている Active Directory レプリケーション トポロジは、ハブとスポークの設計、ハブ サイト内のブリッジヘッド サーバーの数が少ない複数のサイトのブランチのドメイン コント ローラーをレプリケートする場所に基づいています。  
  
このシナリオで RODC をデプロイする利点の 1 つは、一方向のレプリケーションです。 ブリッジヘッド サーバーは、管理とネットワークの使用量を削減すると、RODC からレプリケートする必要はありません。  
  
ただし、以前のバージョンの Windows Server オペレーティング システムで、ハブ スポーク トポロジによって強調表示されている管理課題の 1 つは、ハブで新しいブリッジヘッド ドメイン コント ローラーを追加した後がないことを再配布する自動メカニズム、ブランチのドメイン コント ローラーと新しいハブ ドメイン コント ローラーを活用するために、ハブ ドメイン コント ローラーの間のレプリケーション接続。  
  
Windows Server 2003 ドメイン コント ローラーのことができます、Windows Server 2003 のブランチ オフィス展開ガイドから Adlb.exe などのツールを使用して、ワークロードを再調整. ([https://go.microsoft.com/fwlink/?LinkID=28523](https://go.microsoft.com/fwlink/?LinkID=28523))。  
  
Windows Server 2008 rodc KCC の通常の機能を提供しますによって再調整 Adlb.exe などの別のツールを使用する必要があります。 新しい機能は、既定で有効です。 次のレジストリ キーを RODC に設定を追加することで、無効にできます。  
  
**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters**  
  
**"ランダムな BH Loadbalancing が許可されている"**  
**1 = 有効 (既定)、0 = 無効になっています**  
  
これらの KCC 機能強化を使用する方法についての詳細については、ブランチ オフィス用に Active Directory ドメイン サービスを展開を計画して参照してください ([https://go.microsoft.com/fwlink/?LinkId=107114](https://go.microsoft.com/fwlink/?LinkId=107114))。  
  
## <a name="BKMK_3"></a>フェールオーバーの機能  
サイトでは、レプリケーションがネットワーク障害とオフラインのドメイン コント ローラーにルーティングを確認します。 KCC が AD DS で発生した変更のレプリケーション トポロジを調整する指定した間隔で実行される、新しいドメイン コント ローラーが追加されたときなど、新しいサイトが作成されます。 KCC は、すべての接続が動作していないかどうかを決定する既存の接続のレプリケーションの状態を確認します。 失敗したドメイン コント ローラーにより接続が動作していない場合、KCC 自動的に作成他のレプリケーション パートナーへの一時的な接続 (該当する場合) のレプリケーションを実行することを確認します。 サイト内のすべてのドメイン コントローラが利用できない場合、KCC で別のサイトからドメイン コント ローラー間のレプリケーション接続が自動的に作成されます。  
  
## <a name="BKMK_4"></a>サブネット  
サブネットは、一連の論理 IP アドレスが割り当てられている TCP/IP ネットワークのセグメントです。 サブネットは、ネットワーク上の物理的に近接を識別する方法でコンピューターをグループ化します。 AD DS にサブネット オブジェクトは、サイトにコンピューターをマップに使用されるネットワーク アドレスを特定します。  
  
## <a name="BKMK_5"></a>サイト  
サイトには、信頼性の高い高速ネットワーク接続で 1 つまたは複数の TCP/IP サブネットを表す Active Directory オブジェクトです。 サイトの情報では、Active Directory のアクセスと、物理ネットワークの使用状況を最適化するためにレプリケーションを構成することができます。 サイト オブジェクト、サブネットのセットと関連付けられます、フォレスト内の各ドメイン コント ローラーがその IP アドレスに従って、Active Directory サイトに関連付けられています。 サイトが 1 つ以上のドメインからドメイン コント ローラーをホストできるし、は、複数のサイトでドメインを表すことができます。  
  
## <a name="BKMK_6"></a>サイト リンク  
サイト リンクは、KCC が Active Directory レプリケーションの接続を確立するために使用する論理パスを表す Active Directory オブジェクトです。 サイト リンク オブジェクトは、均一のコストを指定したサイト間トランスポート経由で通信できるサイトのセットを表します。  
  
サイト リンク内に含まれるすべてのサイトは、同じネットワークの種類を使用して接続されていると見なされます。 サイトは、1 つのサイトのドメイン コント ローラーが別のサイト内のドメイン コント ローラーからディレクトリの変更をレプリケートできますされるように、サイト リンクを使用して他のサイトに手動でリンクする必要があります。 サイト リンクがレプリケーション中に、物理ネットワーク上のネットワーク パケットが行う実際のパスに対応していないために、Active Directory レプリケーションの効率を向上させるために冗長的なサイト リンクを作成する必要はありません。  
  
サイト リンクによっては、2 つのサイトが接続されていると、レプリケーション システムは、各サイトのブリッジヘッド サーバーと呼ばれる特定のドメイン コントローラ間の接続を自動的に作成します。 Windows Server 2008 で、同じディレクトリ パーティションをホストするサイトのすべてのドメイン コントローラは候補をブリッジヘッド サーバーとして選択されているのです。 KCC によって作成されたレプリケーション接続は、すべての候補のブリッジヘッド サーバーのレプリケーション作業負荷を共有するサイトの間でランダムに分散されます。 既定では、ランダムな選択処理では、接続オブジェクトが、サイトに最初に追加されたときに 1 回だけを配置します。  
  
## <a name="BKMK_7"></a>サイト リンク ブリッジ  
サイト リンク ブリッジは、サイト リンクのセットを表す Active Directory オブジェクトは、一般的なトランスポートを使用して通信があるすべてのサイトができます。 サイト リンク ブリッジには、相互にレプリケーションへの通信リンクを使用して直接接続されていないドメイン コント ローラーが有効にします。 通常、サイト リンク ブリッジは、ルーター (または一連のルーター) に、IP ネットワーク上に対応します。  
  
既定では、KCC は推移的なルートを共通のいくつかのサイトがあるすべてのサイト リンクを形成できます。 この動作を無効にすると、各サイト リンクは、独自の個別で分離されたネットワークを表します。 1 つのルートとして扱うことがサイト リンクのセットは、サイト リンク ブリッジを通じて表現されます。 各ブリッジは、ネットワーク トラフィックの分離の通信環境を表します。  
  
サイト リンク ブリッジは、サイト間の推移的な物理接続を論理的に表現するメカニズムです。 サイト リンク ブリッジには、含まれるサイト リンクの任意の組み合わせを使用して、それらのサイトに保持されているディレクトリ パーティションの相互接続に最低コストのルートを決定する KCC ができます。 サイト リンク ブリッジは、ドメイン コント ローラーへの接続を実際には提供されません。 サイト リンク ブリッジを削除する場合、KCC はリンクを削除までに結合されたサイト リンク経由のレプリケーションが続行されます。  
  
サイト リンク ブリッジは、必要なは、サイトにも隣接するサイトは、ドメイン コント ローラーでホストされていないディレクトリ パーティションをホストしているドメイン コント ローラーが含まれている場合のみが、そのディレクトリ パーティションをホストしているドメイン コント ローラーは、の他の 1 つまたは複数のサイトにあります。フォレスト。 隣接するサイトは、1 つのサイト リンクに含まれる 2 つまたは複数のサイトとして定義されます。  
  
サイト リンク ブリッジは、中間のサイトを使用して接続されていない 2 つのサイト間の推移的なパスを提供する 2 つのサイト リンク間の論理接続を作成します。 サイト間トポロジ ジェネレーター (ISTG) のためには、ブリッジは暫定的なサイトを使用して物理的な接続を意味します。 ブリッジは、暫定的なサイトのドメイン コント ローラーがレプリケーション パスを提供するには意味しません。 ただし、ある場合は、中間のサイトにレプリケートされるディレクトリ パーティションをホストするドメイン コント ローラーが含まれている場合、その場合サイト リンク ブリッジは必要ありませんがこれです。  
  
結果として得られるパスの合計コストを作成する各サイト リンクのコストが追加されます。 サイト リンク ブリッジは、中間のサイトには、ディレクトリ パーティションをホストしているドメイン コント ローラーが含まれていないと、低コストのリンクが存在しない場合に使用されます。 中間サイトに、ディレクトリ パーティションをホストするドメイン コント ローラーが含まれている場合は切断されている 2 つのサイトは暫定的なドメイン コント ローラーへのレプリケーション接続を設定し、ブリッジを使用しません。  
  
## <a name="BKMK_8"></a>サイト リンクの推移性  
すべてのサイト リンクは推移的、または「ブリッジ」既定では KCC が、サイトがサイト リンクによって直接接続されていませんが、推移的を介して接続されている、サイト間でドメイン コント ローラーのレプリケーション パートナーを決定するレプリケーション接続を作成するサイト リンクがブリッジされ、スケジュールが重なると、一般的なサイトのセット。 これは、サイト リンクの組み合わせによって、他のサイトに任意のサイトを接続できることを意味します。  
  
一般に、完全なルーティング ネットワークでは、するは必要ありませんレプリケーション変更のフローを制御する場合を除き、任意のサイト リンク ブリッジを作成します。 ネットワークが完全にルーティングされていない場合、不可能なレプリケーションの試行を回避するためにサイト リンク ブリッジを作成する必要があります。 特定のトランスポートのすべてのサイト リンクは、そのトランスポート用に 1 つのサイト リンク ブリッジに暗黙的に属しています。 既定のサイト リンク ブリッジが自動的に、および Active Directory オブジェクトはそのブリッジがないことを表します。 **すべてのサイト リンク ブリッジ**IP と簡易メール転送プロトコル (SMTP) の両方のサイト間トランスポート コンテナーのプロパティで設定は、自動サイト リンク ブリッジを実装します。  
  
> [!NOTE]  
> SMTP レプリケーションは、AD DS はの将来のバージョンではサポートされません。そのため、SMTP のコンテナーにサイト リンク オブジェクトを作成しないでください。  
  
## <a name="BKMK_9"></a>グローバル カタログ サーバー  
グローバル カタログ サーバーが、フォレスト内のすべてのオブジェクトに関する情報を格納しているドメイン コント ローラー アプリケーションは、要求されたデータを格納する特定のドメイン コント ローラーに参照しなくても AD DS を検索することができます。 すべてのドメイン コント ローラーのようにグローバル カタログ サーバーには、スキーマと構成ディレクトリ パーティションの書き込み可能な完全なレプリカとそれをホストしているドメインのドメイン ディレクトリ パーティションの書き込み可能な完全なレプリカが格納されます。 さらに、グローバル カタログ サーバーは、フォレスト内の他のすべてのドメイン部分、読み取り専用レプリカを格納します。 ドメイン部分を読み取り専用レプリカには、ドメインが属性 (オブジェクトを検索するため最もよく使用されるこれらの属性) のサブセットのみのすべてのオブジェクトが含まれます。  
  
## <a name="BKMK_10"></a>ユニバーサル グループ メンバーシップのキャッシュ  
ユーザーのユニバーサル グループ メンバーシップ情報をキャッシュするドメイン コント ローラーは、ユニバーサル グループ メンバーシップのキャッシュできます。 ユニバーサル グループ メンバーシップをキャッシュする Active Directory サイトとサービス スナップインを使用して Windows Server 2008 を実行するドメイン コント ローラーを有効にすることができます。  
  
ユニバーサル グループ メンバーシップのキャッシュを有効にすると、ドメイン コント ローラーがすべてのフォレストにあるオブジェクトをレプリケートする必要がないために、ネットワーク帯域幅の使用量を最小限に抑えるドメイン内にあるすべてのサイトでグローバル カタログ サーバーの必要があります。 認証のドメイン コント ローラーは常にユニバーサル グループ メンバーシップ情報を取得するグローバル カタログにアクセスする必要がないために、ログオンにかかる時間も減少します。 詳細については、ユニバーサル グループ メンバーシップのキャッシュを使用する場合は、次を参照してください。[計画のグローバル カタログ サーバーの配置](../../../ad-ds/plan/Planning-Global-Catalog-Server-Placement.md)します。  
  


