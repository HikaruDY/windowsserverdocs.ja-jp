---
ms.assetid: 4cc9c16c-1928-4dce-a3a8-6229be28eb65
title: "Active Directory レプリケーションの概念"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 45753c048f9bb1cb174daade1d408b88b3686b4b
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2017
---
# <a name="active-directory-replication-concepts"></a>Active Directory レプリケーションの概念

>適用対象: Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

サイトのトポロジを設計する前に習熟していくつか Active Directory レプリケーションの概念です。  
  
-   [接続オブジェクト](#BKMK_1)  
  
-   [KCC](#BKMK_2)  
  
-   [フェールオーバー機能](#BKMK_3)  
  
-   [サブネット](#BKMK_4)  
  
-   [サイト](#BKMK_5)  
  
-   [サイト リンク](#BKMK_6)  
  
-   [サイト リンク ブリッジ](#BKMK_7)  
  
-   [サイト リンクの推移性](#BKMK_8)  
  
-   [グローバル カタログ サーバー](#BKMK_9)  
  
-   [ユニバーサル グループ メンバーシップのキャッシュ](#BKMK_10)  
  
## <a name="BKMK_1"></a>接続オブジェクト  
接続オブジェクトは、ソース ドメイン コントローラから宛先ドメイン コントローラへのレプリケーション接続を表す Active Directory オブジェクトです。 ドメイン コント ローラーは、1 つのサイトのメンバであるし、は、サイトで Active Directory ドメイン サービス (AD DS) 内のサーバー オブジェクトで表されます。 各サーバー オブジェクトには、子サイトにレプリケートするドメイン コント ローラーを表すオブジェクトを NTDS 設定があります。  
  
接続オブジェクトは、移行先サーバー上の NTDS 設定オブジェクトの子です。 次の 2 つのドメイン コント ローラー間で発生するレプリケーションは、1 つのサーバー オブジェクトから、他の入力方向のレプリケーションを表す接続オブジェクトが必要です。 ドメイン コント ローラーのすべてのレプリケーション接続は、NTDS 設定オブジェクトの下にある接続オブジェクトとして格納されます。 接続オブジェクトは、レプリケーション元サーバーを識別し、レプリケーションのスケジュールが含まれています、レプリケーションのトランスポートを指定します。  
  
知識整合性チェッカー (KCC) が自動的に、接続オブジェクトを作成しますが、手動で作成することもできます。 Active Directory サイトに、KCC によって作成された接続オブジェクトが表示され、サービス スナップインとして** <automatically generated> ** 、通常の動作条件下で適切なと見なされます。 管理者によって作成された接続オブジェクトは、接続オブジェクトを手動で作成されます。 手動で作成した接続オブジェクトは、管理者によって作成されたときに割り当てられた名前で識別されます。 変更する際に、 ** <automatically generated> **接続オブジェクトの管理者によって変更後の接続オブジェクトに変換して、オブジェクト GUID の形式で表示されます。 KCC は、手動または変更された接続オブジェクトに対する変更を行いません。  
  
## <a name="BKMK_2"></a>KCC  
KCC は、すべてのドメイン コントローラ上で実行され、Active Directory フォレストのレプリケーション トポロジを生成する組み込みのプロセスです。 KCC は、サイト (サイト) 内、または (サイト間) のサイト間でレプリケーションが行われているかどうかに応じて、別々 のレプリケーション トポロジを作成します。 KCC はエラー状態に新しいドメイン コント ローラー、既存のドメイン コント ローラーの削除、またはドメイン コント ローラーとの間のサイト、変更のコスト、およびスケジュール、および一時的に使用できるドメイン コント ローラーの動きの追加に対応するトポロジを動的に調整します。  
  
サイト内の大規模なサイトでレイテンシーを低減するその他のショートカットの接続での双方向リング書き込み可能なドメイン コント ローラー間の接続が常に配置されます。 その一方で、サイト間トポロジは、いずれかのサイト間の接続が各ディレクトリ パーティションの 2 つのサイト間で存在し、接続のショートカットを含まない、通常は、ツリーのまたがりメモリ割り当ての階層化します。 ツリーと Active Directory レプリケーション トポロジのまたがりメモリ割り当ての詳細については、Active Directory レプリケーション トポロジのテクニカル リファレンスを参照してください ([https://go.microsoft.com/fwlink/?LinkID=93578](https://go.microsoft.com/fwlink/?LinkID=93578))。  
  
各ドメイン コント ローラー、KCC はレプリケーションのルートを他のドメイン コント ローラーからの接続を定義する一方向の受信接続オブジェクトを作成することでを作成します。 同じサイト内のドメイン コント ローラー、KCC は管理者の介入なしに自動的に接続オブジェクトを作成します。 複数のサイトがある場合と、サイト間でのサイト リンクを構成する各サイトに 1 つの KCC がもサイト間の接続を自動的に作成されます。  
  
### <a name="kcc-improvements-for-windows-server-2008-rodcs"></a>Windows Server 2008 の Rodc の KCC 機能強化  

多数の Windows Server 2008 に新たに使用できる読み取り専用ドメイン コント ローラー (RODC) に合わせて KCC 改善があります。 RODC の一般的な展開シナリオでは、ブランチ オフィスです。 このシナリオで最もよく展開されている Active Directory レプリケーション トポロジは、ハブ サイト内のブリッジヘッド サーバーの数が少ないブランチで複数のサイトのドメイン コント ローラーを複製する場所、ハブとスポークの設計に基づいています。  
  
このシナリオでは、RODC を展開する利点の 1 つは、一方向のレプリケーションです。 ブリッジヘッド サーバーから、RODC は、管理、およびネットワーク使用率を削減をレプリケートする必要はありません。  
  
ただし、以前のバージョンの Windows Server オペレーティング システムでハブ スポーク トポロジで強調表示されている管理チャレンジが 1 つでは、ハブの新しいブリッジヘッド ドメイン コント ローラーを追加するがないこと、ブランチのドメイン コント ローラーと新しいハブ ドメイン コント ローラーを利用するハブ ドメイン コント ローラーの間のレプリケーション接続を再配布する自動メカニズムです。  
  
Windows Server 2003 ドメイン コントローラーのことができます、Windows Server 2003 のブランチ オフィス展開ガイドから Adlb.exe などのツールを使用して、ワークロードを再調整. ([https://go.microsoft.com/fwlink/?LinkID=28523](https://go.microsoft.com/fwlink/?LinkID=28523))。  
  
Windows Server 2008 の Rodc の KCC の通常の機能を提供によって再分配 Adlb.exe などの他のツールを使用する必要があります。 新しい機能は既定で有効にします。 次のレジストリ キーを RODC に設定を追加することで、無効にできます。  
  
**\System\currentcontrolset\services\ntds\parameters**  
  
**「ランダム BH ロードバランシングが許可されている」**  
**1 = 有効 (既定)、0 = 無効になっています。**  
  
これらの KCC 機能強化の仕組みに関する詳細については、計画とブランチ オフィスに Active Directory ドメイン サービスを展開するを参照してください ([https://go.microsoft.com/fwlink/?LinkId=107114](https://go.microsoft.com/fwlink/?LinkId=107114))。  
  
## <a name="BKMK_3"></a>フェールオーバー機能  
サイトでは、そのレプリケーションは、ネットワークの障害とオフラインのドメイン コント ローラーの周囲ルーティングを確認します。 KCC が AD DS に加えられた変更のレプリケーション トポロジを調整する指定された間隔で実行される、新しいドメイン コント ローラーが追加された場合など、新しいサイトを作成します。 KCC は、すべての接続が機能していないかどうかを決定する既存の接続のレプリケーションの状態を確認します。 障害が発生したドメイン コント ローラーのために、接続が動作しない場合、KCC 自動的に作成他のレプリケーション パートナーの一時的な接続 (該当する場合) にそのレプリケーションが行われることを確認します。 サイト内のすべてのドメイン コントローラが利用できない場合、KCC は自動的に別のサイトからドメイン コント ローラー間のレプリケーション接続を作成します。  
  
## <a name="BKMK_4"></a>サブネット  
サブネットは、一連の論理 IP アドレスが割り当てられている、TCP/IP ネットワークのセグメントです。 サブネットは、ネットワーク上の物理的に近づくを識別する方法でコンピューターをグループ化します。 AD DS のサブネット オブジェクトは、コンピューターにマップのサイトに使用されるネットワーク アドレスを識別します。  
  
## <a name="BKMK_5"></a>サイト  
サイトは、Active Directory オブジェクトを表す信頼性の高い高速ネットワーク接続と 1 つまたは複数の TCP/IP サブネットです。 サイトの情報では、Active Directory のアクセスと物理ネットワークの使用を最適化するためにレプリケーションを構成することができます。 サイト オブジェクトのサブネットのセットに関連付けは、フォレスト内の各ドメイン コント ローラーがその IP アドレスに従って、Active Directory サイトと関連付けられています。 サイトを 1 つ以上のドメインからドメイン コント ローラーをホストし、複数のサイトでドメインを表すことができます。  
  
## <a name="BKMK_6"></a>サイト リンク  
サイト リンクは、Active Directory オブジェクトを KCC が Active Directory レプリケーション用の接続を確立するために使用する論理パスを表すです。 サイト リンク オブジェクトは、指定したサイト間トランスポート経由 uniform コストで通信できるサイトのセットを表します。  
  
サイト リンク内に含まれるすべてのサイトは、同じネットワークの種類によって接続されていると見なされます。 1 つのサイトのドメイン コント ローラーは、別のサイト内のドメイン コント ローラーからディレクトリの変更をレプリケートできますされるようにサイト リンクを使用してサイトを手動で他のサイトにリンクされます。 サイト リンクがレプリケーション中に、物理ネットワーク上のネットワーク パケットが取得した実際のパスに対応していないために、Active Directory レプリケーションの効率を向上させるために、冗長なサイト リンクを作成する必要はありません。  
  
2 つのサイトは、サイト リンクによって接続されているときに、レプリケーション システムは自動的に各サイトのブリッジヘッド サーバーと呼ばれる特定のドメイン コントローラ間の接続を作成します。 Windows Server 2008 で、同じディレクトリ パーティションをホストするサイト内のすべてのドメイン コントローラはブリッジヘッド サーバーとして選択された場合に候補です。 KCC によって作成されたレプリケーション接続はランダムにレプリケーションの作業負荷を共有するサイト内のすべての候補ブリッジヘッド サーバー間で配布されます。 既定では、ランダムな選択処理では、接続オブジェクトがサイトに最初に追加された場合、1 回だけを配置します。  
  
## <a name="BKMK_7"></a>サイト リンク ブリッジ  
Active Directory サイト リンクのセットを表すオブジェクトをサイト リンク ブリッジには、一般的なトランスポートを使用して通信があるすべてのサイトができます。 サイト リンク ブリッジは、相互にレプリケートする通信リンクによって直接接続されていないドメイン コント ローラーを有効にします。 通常、サイト リンク ブリッジは、ルーター (またはルーターの設定) に IP ネットワーク上に対応します。  
  
既定では、KCC は一部のサイトに共通して、すべてのサイト リンクを通じて推移的なルートを形成できます。 この動作を無効にすると、各サイト リンクは明確で分離されたネットワークを表します。 単一のルートとして扱うことがサイト リンクのセットは、サイト リンク ブリッジ経由で表されます。 各ブリッジでは、ネットワーク トラフィックの分離の通信環境を表します。  
  
サイト リンク ブリッジは、サイト間で推移的な物理的な接続を論理的に表すメカニズムです。 サイト リンク ブリッジでは、KCC を付属のサイト リンクの任意の組み合わせを使用して、これらのサイトに保持されているディレクトリ パーティションの相互接続には、少なくとも高価なルートを決定します。 サイト リンク ブリッジは、ドメイン コント ローラーへの接続を実際には提供されません。 サイト リンク ブリッジを削除する場合、KCC はリンクを削除するまでの結合されたサイト リンク経由でレプリケーションが続行されます。  
  
サイト リンク ブリッジは、サイトにも、隣接するサイトでドメイン コント ローラーでホストされていないディレクトリ パーティションをホストしているドメイン コント ローラーが含まれている場合に必要なだけが、そのディレクトリ パーティションをホストしているドメイン コント ローラーがフォレストの他の 1 つまたは複数のサイトであります。 隣接サイトは、1 つのサイト リンクに含まれる 2 つまたは複数のサイトとして定義されます。  
  
サイト リンク ブリッジでは、中間のサイトを使用して切断されている 2 つのサイト間で推移的なパスを提供する 2 つのサイト リンク間の論理的な接続を作成します。 サイト間トポロジ ジェネレーター (ISTG) の目的上、ブリッジは暫定的なサイトを使用して物理的な接続を意味します。 ブリッジでは、中間サイト内のドメイン コント ローラーがレプリケーション パスを提供することを意味しません。 ただし、暫定的なサイトにレプリケートされるディレクトリ パーティションをホストするドメイン コント ローラーが含まれている場合に発生する、その場合、サイト リンク ブリッジは必要ありませんがこのします。  
  
結果として得られるパスの合計コストを作成する、各サイト リンクのコストが追加されます。 中間のサイトには、ディレクトリ パーティションをホストしているドメイン コント ローラーが含まれていないと、下位レベルのコストのリンクが存在しない場合、サイト リンク ブリッジに使用されます。 暫定的なサイトには、ディレクトリ パーティションをホストするドメイン コント ローラーが含まれている、切断されている 2 つのサイトは暫定的なドメイン コント ローラーへのレプリケーション接続の設定し、ブリッジを使用していません。  
  
## <a name="BKMK_8"></a>サイト リンクの推移性  
既定ですべてのサイト リンクは、推移的なまたは「ブリッジ」にします。 サイト リンクがブリッジされ、重複する、スケジュール、KCC は、サイトがサイト リンクによって直接接続されていないが、一連の共通のサイトで推移的に接続するときに、サイト間でドメイン コント ローラーのレプリケーション パートナーを決定するレプリケーション接続を作成します。 これはサイト リンクの組み合わせによって、他のサイトに任意のサイトを接続できることを意味します。  
  
一般に、完全なルーティング ネットワークでは、必要はありませんレプリケーションの変更のフローを制御する必要がない限り、任意のサイト リンク ブリッジを作成します。 ネットワークが完全にルーティングされていない場合は、不可能なレプリケーション試行を避けるためにサイト リンク ブリッジを作成する必要があります。 特定のトランスポートのすべてのサイト リンクは、そのトランスポート用の 1 つのサイト リンク ブリッジに暗黙的に属しています。 既定のサイト リンク ブリッジ、自動的が発生し、Active Directory オブジェクトはそのブリッジがないことを表します。 **すべてのサイト リンク ブリッジ**設定、IP と簡易メール転送プロトコル (SMTP) の両方のサイト間トランスポート コンテナーのプロパティには自動サイト リンク ブリッジを実装します。  
  
> [!NOTE]  
> SMTP レプリケーションは、AD DS; の将来のバージョンではサポートされません。そのため、SMTP コンテナーでのサイト リンク オブジェクトの作成は推奨されません。  
  
## <a name="BKMK_9"></a>グローバル カタログ サーバー  
グローバル カタログ サーバーが、フォレスト内のすべてのオブジェクトに関する情報を格納するドメイン コント ローラー アプリケーションは、要求されたデータを格納する特定のドメイン コント ローラーを参照することがなく AD DS を検索することができます。 すべてのドメイン コント ローラーのようには、グローバル カタログ サーバーは、スキーマ パーティションと構成ディレクトリ パーティションのフル、書き込み可能なレプリカとそれをホストしているドメインのドメイン ディレクトリ パーティションのフル、書き込み可能なレプリカを格納します。 さらに、グローバル カタログ サーバーは、フォレスト内のすべての他のドメイン、読み取り専用の部分的なレプリカを格納します。 ドメインを読み取り専用の部分的なレプリカには、ドメインが、属性 (オブジェクトを検索するために最もよく使用されるこれらの属性) のサブセットのみのすべてのオブジェクトが含まれます。  
  
## <a name="BKMK_10"></a>ユニバーサル グループ メンバーシップのキャッシュ  
ユーザーのユニバーサル グループ メンバーシップ情報をキャッシュするドメイン コント ローラーは、ユニバーサル グループ メンバーシップのキャッシュできます。 実行している Windows Server 2008 ユニバーサル グループ メンバーシップをキャッシュする Active Directory サイトとサービス スナップインを使用しているドメイン コント ローラーを有効にすることができます。  
  
ユニバーサル グループ メンバーシップのキャッシュを有効にすると、グローバル カタログ サーバーがドメイン コント ローラーがすべてのフォレストにあるオブジェクトをレプリケートする必要がないために、ネットワーク使用帯域幅を最小化、ドメイン内のすべてのサイトでの必要があります。 認証のドメイン コント ローラーは常にユニバーサル グループ メンバーシップ情報を取得するためにグローバル カタログにアクセスする必要がないために、ログオンにかかる時間も減少します。 詳細については、ユニバーサル グループ メンバーシップのキャッシュを使用する場合、次を参照してください。[グローバル カタログ サーバーの配置を計画](../../../ad-ds/plan/Planning-Global-Catalog-Server-Placement.md)します。  
  


