---
ms.assetid: 7a7ab95c-9cb3-4a7b-985a-3fc08334cf4f
title: 最低限の特権の管理モデルを実装する
description: ''
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 08/09/2018
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 609ea0bd796a4d3696e14c7499be047ebdd83183
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59868853"
---
# <a name="implementing-least-privilege-administrative-models"></a>最低限の特権の管理モデルを実装する

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

抜粋は[、管理者アカウントのセキュリティ計画ガイド](https://technet.microsoft.com/library/cc162797.aspx)1999 年 4 月 1 日の最初の発行者します。

> "セキュリティに関連するトレーニング コースとドキュメントの最低限の特権の原則の実装をについて説明します。 まだ組織めったに従います。 原理はシンプルで、大幅に正しく適用することの影響は、セキュリティが向上し、リスクを軽減します。 原則の内容はすべてのユーザーが、現在のタスクと完了に必要な絶対最小アクセス許可を持つユーザー アカウントでログオンする必要があります。 これによりその他の攻撃の間での悪意のあるコードに対して保護を提供します。 この原則は、コンピューターとそれらのコンピューターのユーザーに適用されます。   
> "この原則がうまく理由の 1 つは強制をいくつかの調査を行うことです。 たとえばにコンピューターまたはユーザーが本当に必要なアクセス権を特定して、それらを実装します。 多くの組織にとって、このタスク最初に感じられるかもしれません多くの作業です。ただし、これはネットワーク環境を正常にセキュリティで保護する基本的な手順です。
> "する必要があります権限を付与するすべてのドメイン管理者のユーザーのドメインで最低限の特権の概念です。 たとえば、管理者が特権アカウントを使用してログオン、誤ってウイルス プログラムを実行する場合、ウイルス管理アクセス権をローカル コンピューターとドメイン全体にがあります。 管理者は特権 (管理者以外) のアカウントでログオンが代わりに、による被害のウイルスの範囲のみなります、ローカル コンピューター、ローカル コンピューターのユーザーとして実行されるためです。
> "別の例では、アカウント、ドメイン レベルの管理者権限を許可する必要があります特権のない別のフォレスト内の権限、フォレスト間に信頼関係がある場合でもです。 そうしておけば、攻撃者が 1 つの管理対象のフォレストを侵害する場合は、広範囲の損害を防ぐためです。 組織は定期的に監査を承認されていない特権のエスカレーションを防ぐために、ネットワークです。"  

次の抜粋は、 [Microsoft Windows Security Resource Kit](https://www.microsoftpressstore.com/store/microsoft-windows-security-resource-kit-9780735621749)、最初に発行されている 2005。  

> "最小限の作業を実行するために必要な特権の付与の観点からセキュリティを常に考えます。 多すぎる特権を持つアプリケーションを侵害する必要があります、攻撃者は、最小限の特権の下で、アプリケーションであった場合に、何を超える攻撃を展開することにあります。 たとえば、無意識にウイルスを起動する電子メールの添付ファイルを開くには、ネットワーク管理者の結果を確認します。 管理者がドメイン管理者アカウントを使用してログオンした場合、ウイルス ドメイン内のすべてのコンピューターで管理者特権を持ってし、ネットワーク上のほぼすべてのデータにしたがって無制限にアクセスします。 場合は、管理者がログオン、ローカル管理者アカウントを使用して、ウイルスがローカル コンピューターの管理者特権を持ってし、そのため、コンピューター上の任意のデータにアクセスし、キー ストロークのログ記録ソフトウェアなどの悪意のあるソフトウェアをインストールすることでしょうコンピューター。 管理者が通常のユーザー アカウントを使用してログオンした場合、ウイルスは、管理者のデータにのみアクセスし、悪意のあるソフトウェアをインストールすることはできません。 この例での電子メールを読み取るために必要な最低限の特権を使用して、潜在的なセキュリティ侵害の範囲が大幅に減少します。"  

## <a name="the-privilege-problem"></a>特権の問題

前述の抜粋で説明する原則が変更されていない Active Directory の実装を評価するには可変が見つけることがない権限と日常的な実行に必要なものをはるかに超えたアクセス許可が付与されているアカウントの数が過剰作業します。 環境のサイズが過度に特権のアカウントの実際の数に影響が、proportionmidsized ディレクトリではなくあります数十個のアカウントの最も高い特権を持つグループに数百または数千回も大規模なインストールを持つことがあります。 攻撃者には、攻撃者のスキルとコレクションの高度化に関係なく、いくつかの例外のパスを選ぼう通常に従います。 ツールとアプローチの複雑さは、ときにのみ簡単のメカニズムが失敗したり、阻止防御者が増加します。  

残念ながら、多くの環境で抵抗を最小限のパスは、広範囲でかつ深い特権を持つアカウントの過剰な使用のことがわかっています。 広範な権限は、権限とアクセス許可などの環境での大きなセクション間で特定のアクティビティを実行するアカウントを許可するには、ヘルプ デスクのスタッフが権限を与える多くのユーザー アカウントのパスワードをリセットできるようにします。  

詳細な特権は、母集団の幅が狭いセグメントに適用されている強力な特権です、このような権限を与えることをエンジニア リング管理者サーバーで実行できるように修復します。 広範な権限も詳細な権限が、必ずしも危険性がドメイン内の多数のアカウントには、アカウントのいずれかが侵害された場合のみ、広範囲でかつ深い特権が付与される完全にはと、にすばやく使用できますに環境を再構成する、攻撃者の目的でも破壊されたり、インフラストラクチャの大きなセグメント。  

Pass-the-hash 攻撃、資格情報盗用攻撃の一種でありは、ユビキタスため、それらの実行にツールを自由に使用できる、簡単に使える、多くの環境は、攻撃に対して脆弱であるためです。 Pass-the-hash 攻撃では、実際の問題をただしではありません。 問題の核心は、2 つあります。  

1. 1 台のコンピューターの詳細な特権を取得し、他のコンピューターに大まかには、その特権を反映し、攻撃者は、通常は簡単です。  
2. コンピューティング環境の間で高いレベルの特権での永続的なアカウントが多すぎるは通常です。

Pass the hash 攻撃が排除される場合でも、攻撃者は、さまざまな戦略ではない、さまざまな戦略を使用するだけですが。 ツールの資格情報の盗難を含むマルウェアを植えるのではなくこれら植物のキーストロークをログに記録するマルウェアや任意の数は、環境全体で強力な資格情報をキャプチャするには、他のアプローチを利用して可能性があります。 ターゲットでは、戦術に関係なくは同じ: 広範囲でかつ深い特権を持つアカウント。  

過剰な権限の許可のみにない Active Directory が侵害された環境でします。 組織は必要以上の権限の許可を付与する習慣を開発した、ときに、次のセクションで説明したように、インフラストラクチャ全体が通常見つかります。  

## <a name="in-active-directory"></a>Active directory

Active Directory では、EA、DA BA グループを含む、過度のアカウントを検索する一般的なは。 ほとんどの場合、組織の EA のグループには、最小限のメンバーが含まれています、DA グループには、通常、EA グループ内のユーザーの数の乗数が含まれます、管理者グループには、通常、その他のグループを組み合わせるの人口より多いメンバーが含まれます。 管理者は、何らかの方法での信念により多くの場合、これは"特権"DAs または EAs よりも少ない。 権限とこれらの各グループに付与されるアクセス許可が異なる場合、中に効果的にみなす均等に強力なグループ自分自身の他の 2 つのメンバーと、1 つのメンバーであるためです。  

## <a name="on-member-servers"></a>メンバー サーバー

ローカルおよびドメインのアカウントの少数から多数の入れ子になったグループに至るまでのメンバーシップが見つかったら、多くの環境でメンバー サーバー上のローカルの Administrators グループのメンバーシップを取得する場合、展開するの何百、何千を表示サーバーでローカルの管理者特権を持つアカウント。 メンバー サーバーのローカル管理者グループ、ドメイン内のこれらのグループのメンバーシップを変更できるすべてのユーザーがすべてのシステムの管理制御を得ることができますという事実を考慮せずに多くの場合、大規模なメンバーシップを持つドメイン グループが入れ子になったローカルの Administrators グループのグループを入れ子にされています。  

## <a name="on-workstations"></a>ワークステーションで

ワークステーションが通常メンバー サーバーには、多くの環境でよりも、ローカルの Administrators グループの数が少ないメンバーを持つユーザーは自分のパーソナル コンピューターのローカルの Administrators グループのメンバーシップが付与されます。 UAC が有効になっている場合でも、これが、発生すると、それらのユーザーは各自のワークステーションの整合性を管理者特権でのリスクを提示します。  

> [!IMPORTANT]  
> 慎重に考慮する必要がありますユーザーが各自のワークステーションの管理者権限を必要として、Administrators グループのメンバーであるコンピューター上の別のローカル アカウントを作成する優れた方法がある場合は、かどうか。 ユーザーには、昇格が必要がある場合、特権の昇格をローカル アカウントの資格情報に提供できるが、アカウントはローカルであるために、他のコンピューターを危険にさらすまたはドメイン リソースへのアクセスには使用できません。 すべてのローカル アカウントと同様、ローカルの特権を持つアカウントの資格情報する必要がありますで一意である;で複数のワークステーション上と同じ資格情報をローカル アカウントを作成する場合は、pass the hash 攻撃に対してコンピューターを公開します。  

## <a name="in-applications"></a>アプリケーションで

攻撃のターゲットの組織の知的財産では、データの流出を許可するアプリケーション内での強力な特権が与えられているアカウントを対象にできます。 機密データへのアクセス権を持つアカウントが付与されていないドメインまたはオペレーティング システム、アプリケーションの構成を操作できるアカウントで管理者特権またはアプリケーションの情報へのアクセスを提供します存在するリスクです。  

## <a name="in-data-repositories"></a>データ リポジトリ

ドキュメントやその他のファイルの形式で知的財産へのアクセスを求めている攻撃者が、アカウントをターゲットとその他のターゲットを持つ場合は、ファイルへのアクセス制御を格納する、ファイル、またはでもグループまたはロールに直接アクセス アカウントファイルにアクセスします。 やなどのコントラクトのドキュメントを保存するファイル サーバーが使用され、Active Directory グループを使用して、ドキュメントにアクセスする場合、攻撃者は、グループのメンバーシップを変更することができますできます侵害されたアカウントをグループに追加契約へのアクセスドキュメント。 ドキュメントへのアクセスが SharePoint などのアプリケーションで提供されている場合、攻撃者は前述のようにアプリケーションを特定できます。  

## <a name="reducing-privilege"></a>特権の削減

大きい方とより複雑な環境では、難しく管理およびセキュリティ保護になります。 小規模な組織でのレビューと特権の削減に、比較的単純な話を指定することがありますが、各追加のサーバー、ワークステーション、ユーザー アカウント、および組織で使用されているアプリケーションは、セキュリティで保護する必要がある別のオブジェクトを追加します。 あるため困難または不可能なも正しく、組織のすべての側面をセキュリティで保護された IT インフラストラクチャ、活動の焦点は、特権のビルトイン アカウントは、通常最も危険を作成する特権を持つアカウントで最初にする必要があり、Active Directory、およびワークステーションとメンバ サーバーでローカル アカウントの特権でのグループ。  

### <a name="securing-local-administrator-accounts-on-workstations-and-member-servers"></a>ワークステーションとメンバ サーバー上のローカル管理者アカウントをセキュリティで保護します。

このドキュメントでは、既に説明したように、Active Directory を保護する方法では説明、ディレクトリに対する攻撃の大半は、個々 のホストに対する攻撃として開始します。 メンバー システム上のローカル グループを保護するための完全なガイドラインを提供することはできませんが、次の推奨事項は、ワークステーションとメンバ サーバーのローカル管理者アカウントを保護するために使用できます。  

#### <a name="securing-local-administrator-accounts"></a>ローカル管理者アカウントのセキュリティ保護

メイン ストリーム サポートで現在の Windows のすべてのバージョンでは、ローカル管理者アカウントは、アカウントに pass the hash およびその他の資格情報盗難攻撃で使用できなくなります既定で無効になります。 ただし、古いオペレーティング システムが含まれているドメインまたはローカル管理者アカウントを有効になっているのメンバー サーバーとワークステーションの間でセキュリティ侵害が反映されるまでに説明したようこれらのアカウントを使用することができます。 このため、次のコントロールはドメインに参加しているシステム上のすべてのローカル管理者アカウントをお勧めします。  

これらのコントロールを実装するための詳細な手順が記載[付録 h:ローカル管理者アカウントとグループをセキュリティで保護する](../../../ad-ds/plan/security-best-practices/Appendix-H--Securing-Local-Administrator-Accounts-and-Groups.md)します。 これらの設定を実装する前に、ローカルの管理者アカウントが使用されないように現在環境内のコンピューターでサービスを実行したり、これらのアカウントを使用する必要があります、その他のアクティビティを実行します。 これらの設定を運用環境で実装する前に徹底的にテストします。  

#### <a name="controls-for-local-administrator-accounts"></a>コントロールのローカル管理者アカウント

ビルトイン Administrator アカウントをメンバー サーバー上のサービス アカウントとして使用しない必要がありますも、ローカル コンピューターにログオンに使用されるある (これは、アカウントが無効になっている場合でも許可されて、セーフ モードでを除く)。 ここで説明する設定を実装する目的は、各コンピューターのローカル管理者アカウントが保護制御は最初が反転される場合を除き、使用されていることを防ぐためです。 これらのコントロールを実装して、管理者アカウントの変更を監視できます大幅に短縮する攻撃の成功の確率値そのターゲットのローカル管理者アカウント。  

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-joined-systems"></a>ドメインに参加しているシステム上の管理者アカウントを制限する Gpo を構成します。

次のユーザー権利を管理者アカウントを追加作成し、ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクする 1 つまたは複数の gpo、**コンピューター \policies\windows 設定 \ セキュリティ \ Policies\ユーザー権利の割り当て**:  

- ネットワークからのこのコンピューターへのアクセスを拒否する
- バッチ ジョブとしてのログオンを拒否
- サービスとしてのログオンを拒否
- リモート デスクトップ サービスを使ったログオンを拒否

これらのユーザー権利を管理者アカウントを追加する場合は、追加するかどうか、ローカルの管理者アカウントまたはドメインの管理者アカウントのところで、アカウントのラベルを付けることを指定します。 たとえば、NWTRADERS ドメインの管理者のアカウントにこれらを拒否するを追加する権限、としてアカウントを入力**別**、NWTRADERS ドメインの管理者アカウントをまたは参照します。 ローカル管理者アカウントを制限するためには、次のように入力します。**管理者**これらのユーザー権利のグループ ポリシー オブジェクト エディターで設定します。  

> [!NOTE]  
> 場合でも、ローカルの管理者アカウントが名前変更、ポリシーがまだ適用されます。  

これらの設定が誤ってまたは悪意をもって有効になっている場合でも、他のコンピューターに接続するコンピューターの管理者アカウントを使用することはできないことを確認します。 ローカルの管理者アカウントを使用してローカルのログオンを完全に無効にすることはできませんもする必要がありますしようとするためには、ディザスター リカバリー シナリオで使用するコンピューターのローカル管理者アカウントが設計されているためです。  

メンバー サーバーまたはワークステーションになるドメインから切断しないその他のローカル アカウント許可されている管理者特権を持つ、コンピューターをセーフ モードに起動できる、管理者アカウントを有効にすることができます。、およびアカウントの効果に使用できます。コンピューターを修復します。 修復が完了すると、管理者アカウントが無効にもう一度必要があります。  

### <a name="securing-local-privileged-accounts-and-groups-in-active-directory"></a>ローカルの特権アカウントと Active Directory でグループをセキュリティで保護します。

*鉄則 6 つの番号します。コンピューターの管理者が信頼できるセキュリティが。* - [(バージョン 2.0) のセキュリティに関する 10 の鉄則](https://technet.microsoft.com/security/hh278941.aspx)  

ここで提供される情報は、最上位の特権のビルトイン アカウントと Active Directory でグループを保護するための一般的なガイドラインを提供するためのものです。 詳細な手順についてでも示します[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)、[付録 e:Active Directory の Enterprise Admins グループのセキュリティ保護](../../../ad-ds/plan/security-best-practices/Appendix-E--Securing-Enterprise-Admins-Groups-in-Active-Directory.md)、[付録 f:Active Directory の Domain Admins グループのセキュリティ保護](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)、および[付録 g:Active Directory の管理者グループをセキュリティで保護する](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)します。  

これらの設定を実装する前に、環境に適しているかどうかを判断するには、十分にすべての設定もテストする必要があります。 すべての組織はこれらの設定を実装できるようになります。  

#### <a name="securing-built-in-administrator-accounts-in-active-directory"></a>Active Directory でビルトイン Administrator アカウントのセキュリティ保護

Active Directory 内の各ドメインの管理者アカウントがドメインの作成の一環として作成されます。 このアカウントが既定では、ドメイン内の管理者グループ、Domain Admins のメンバーと、アカウントが、Enterprise Admins グループのメンバーでも、ドメインがフォレスト ルート ドメインの場合は、します。 ドメインのローカル管理者アカウントの使用に予約する初期のビルドのアクティビティと、場合によっては、ディザスター リカバリーのシナリオに対してのみです。 ビルトイン Administrator アカウントを他のアカウントを使用しないことに、修復を有効にするために使用できることを確認するには、フォレスト内のドメインの管理者アカウントの既定のメンバーシップを変更しないでください。 代わりに、フォレスト内の各ドメインの Administrator アカウントをセキュリティ保護するためのガイドラインに従う必要があります。 これらのコントロールを実装するための詳細な手順が記載[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  

#### <a name="controls-for-built-in-administrator-accounts"></a>ビルトイン Administrator アカウントの制御

ここで説明する設定を実装する目的は、各ドメインの管理者アカウント (グループではなく) を防ぐためにコントロールの数が逆になっていない場合に使用されるからです。 これらのコントロールを実装し、変更の管理者アカウントの監視、ドメインの管理者アカウントを活用することで、攻撃が成功する可能性を大幅に短縮できます。 フォレスト内の各ドメインの管理者アカウントには、次の設定を構成する必要があります。  

##### <a name="enable-the-account-is-sensitive-and-cannot-be-delegated-flag-on-the-account"></a>アカウントの「アカウントは重要なので委任できない」フラグを有効にします。

既定では、Active Directory のすべてのアカウントに委任できます。 委任は、コンピューターまたはコンピューターには、認証アカウントの資格情報を提示するサービスまたはサービス アカウントの代理でサービスを取得するには、他のコンピューターにできます。 有効にすると、**アカウントは重要なので委任できない**属性ドメイン ベースのアカウントでは、他のコンピューターまたはサービスを利用する攻撃を制限すると、ネットワーク上にアカウントの資格情報が提示することはできませんアカウントの資格情報を使用して、他のシステムへの委任します。  

##### <a name="enable-the-smart-card-is-required-for-interactive-logon-flag-on-the-account"></a>アカウントの「対話型ログオンに必要なのスマート カードが」フラグを有効にします。

有効にすると、**対話型ログオンにスマート カードが必要**Windows アカウントの属性が 120 文字のランダムな値に、アカウントのパスワードをリセットします。 組み込みの管理者アカウントでこのフラグを設定してアカウントのパスワードを長くだけでなく、複雑では、すべてのユーザーが不明します、ことを確認します。 技術的には、この属性は、有効にする前に、アカウント用のスマート カードを作成する必要はありませんが、可能であれば、アカウントの制限を構成する前に管理者アカウントごとにスマート カードを作成する必要があり。、スマート カードに格納する必要があります。セキュリティで保護された場所。  

設定が、**対話型ログオンにスマート カードが必要**フラグは、アカウントのパスワードをリセット、アカウントの既知の値に設定してから、アカウントのパスワードをリセットする権限を持つユーザーをすることが、アカウントの名前と、ネットワークのリソースにアクセスする新しいパスワード。 このため、アカウントの他のコントロールを実装する必要があります。  

##### <a name="configuring-gpos-to-restrict-domains-administrator-accounts-on-domain-joined-systems"></a>ドメインに参加しているシステムでのドメインの管理者アカウントを制限する Gpo を構成します。

ドメインの管理者アカウントを無効化により、アカウントが効果的に使用できない、場合に、アカウントが誤ってまたは悪意をもって有効、アカウントの追加の制限を実装する必要があります。 これらのコントロールは、管理者アカウントによって最終的に取り消すことができます、目標は、攻撃者の進行状況を遅くコントロールを作成して、破損、アカウントの制限を与えることができます。  

作成し、ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクする 1 つまたは複数の Gpo で各ドメインの管理者アカウントでは、次のユーザー権利を追加**コンピューター \policies\windows 設定 \ セキュリティの設定ユーザー権利の割り当て**:  

- ネットワークからのこのコンピューターへのアクセスを拒否する  
- バッチ ジョブとしてのログオンを拒否  
- サービスとしてのログオンを拒否  
- リモート デスクトップ サービスを使ったログオンを拒否  

> [!NOTE]  
> この設定をローカルの管理者アカウントを追加すると、ローカルの管理者アカウントまたはドメイン管理者アカウントを構成しているかどうかを指定する必要があります。 たとえば、NWTRADERS ドメインのローカルの管理者アカウントにこれらを拒否するを追加する権限、としてアカウントを入力する必要がありますか**別**、NWTRADERS ドメインのローカル管理者アカウントを参照またはします。 入力した場合**管理者**これらユーザーの権限設定では、グループ ポリシー オブジェクト エディターでは、GPO を適用する各コンピューターのローカルの管理者アカウントを制限します。  
>
> ドメイン ベースの管理者アカウントと同じ方法でメンバー サーバーとワークステーションのローカルの管理者アカウントを制限することをお勧めします。 したがって、これらのユーザーの権限設定を一般に、フォレスト内の各ドメインの管理者アカウントとローカル コンピューターの管理者アカウントを追加する必要があります。 

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-controllers"></a>ドメイン コント ローラーの管理者アカウントを制限する Gpo を構成します。

各ドメイン、フォレスト内では、ドメイン コント ローラーの既定のポリシーまたはドメイン コント ローラーの OU にリンクされているポリシーを各ドメインの管理者アカウントでは、次のユーザー権利を追加する変更する必要があります**コンピューターの構成Windows \windows settings \local policies \user Rights 割り当て**:  

- ネットワークからのこのコンピューターへのアクセスを拒否する  
- バッチ ジョブとしてのログオンを拒否  
- サービスとしてのログオンを拒否  
- リモート デスクトップ サービスを使ったログオンを拒否  

> [!NOTE]  
> これらの設定が有効な場合は、アカウントがドメイン コント ローラーにローカルでログオンできますが、ローカル管理者アカウントをドメイン コント ローラーへの接続に使用できません、ことを確認します。 このアカウントを有効になっているだけとディザスター リカバリーのシナリオで使用する必要があります、ため、少なくとも 1 つのドメイン コント ローラーに物理的にアクセスが公開される予定または他のアカウントのドメイン コント ローラーをリモートでアクセスするアクセス許可を持つができると予想されます。このオプションを使用するとします。  

##### <a name="configure-auditing-of-built-in-administrator-accounts"></a>ビルトイン Administrator アカウントの監査を構成します。

各ドメインの管理者アカウントをセキュリティで保護し、それを無効になっているときは、アカウントに変更を監視する監査を構成する必要があります。 アカウントが有効になっている、そのパスワードをリセットすると、または他の変更を行ったアカウントに、アラートがユーザーまたは組織のインシデント対応チームだけでなく、AD DS の管理を担当するチームに送信する必要があります。  

### <a name="securing-administrators-domain-admins-and-enterprise-admins-groups"></a>Administrators、Domain Admins と Enterprise Admins グループのセキュリティ保護

#### <a name="securing-enterprise-admin-groups"></a>エンタープライズ管理者のグループをセキュリティで保護します。

フォレスト ルート ドメインに格納されているが、Enterprise Admins グループに含めないでくださいユーザー ドメインのローカル管理者アカウントのような例外を日常的に、前述のセキュリティ保護の提供と[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  

EA へのアクセスが必要な場合は、Enterprise Admins グループにアカウントを持つ EA 権限とアクセス許可を必要とするユーザーを一時的に配置する必要があります。 彼らのアクティビティの監査や可能であれば、不注意による誤使用や構成の誤りの可能性を最小限に抑えるには、変更を実行する 1 つのユーザーと、変更を観察し、別のユーザーで実行する必要がありますが、ユーザーは、高い特権を持つアカウントを使用して、. アクティビティが完了したら、アカウントが EA グループから削除する必要があります。 これにより、手動の手順を通じて行うことができ、プロセス、サード パーティ製の特権 id/アクセス management (PIM/PAM) のソフトウェア、またはその両方の組み合わせを解説します。 ガイドラインは Active Directory で権限を持つグループのメンバーシップを制御するアカウントの作成を使用できるに用意されて[魅力的なアカウント資格情報の盗難を](../../../ad-ds/plan/security-best-practices/Attractive-Accounts-for-Credential-Theft.md)および詳細な手順については、で提供される[付録 i:アカウントおよび Active Directory でグループ管理アカウントを作成する保護される](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)します。  

エンタープライズ管理者は、既定では、フォレスト内の各ドメインでの組み込みの Administrators グループのメンバーです。 各ドメインの管理者グループから Enterprise Admins グループを削除すると、フォレストのディザスター リカバリー シナリオが発生した場合 EA 権限が必要になるために、不適切な変更です。 Enterprise Admins グループが、フォレストの管理者グループから削除された場合は、各ドメインの管理者グループに追加する必要があり、他のコントロールを実装する必要があります。  

- 前述のように、Enterprise Admins グループに含めないでください」の説明に従ってセキュリティで保護する必要がありますフォレスト ルート ドメインの管理者アカウントのような例外を日常的にユーザー[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
- メンバー サーバーと各ドメインにワークステーションを含む Ou にリンクされた、Gpo では、次のユーザー権利を EA のグループを追加してください。  
   - ネットワークからのこのコンピューターへのアクセスを拒否する  
   - バッチ ジョブとしてのログオンを拒否  
   - サービスとしてのログオンを拒否  
   - ローカル ログオンを拒否  
   - リモート デスクトップ サービス経由でのログオンを拒否します。  

これにより、EA のグループのメンバーでメンバー サーバーとワークステーションにログオンできなくなります。 ジャンプ サーバーをドメイン コント ローラーと Active Directory の管理に使用する場合は、ジャンプ サーバーが制限された、Gpo がリンクされていないする OU 内にあることを確認します。  

- プロパティまたは EA グループのメンバーシップに変更を行った場合にアラートを送信するは、監査を構成する必要があります。 これらのアラートを送信する、最低限、ユーザーまたは Active Directory の管理や事故対応を担当するチームに。 プロセスと一時的にグループの正当な作成が実行時に、通知手順を含む、EA グループを設定するための手順を定義することも必要があります。  
  
#### <a name="securing-domain-admins-groups"></a>Domain Admins グループのセキュリティ保護

Enterprise Admins グループの場合と同様に、Domain Admins グループのメンバーシップはビルドまたはディザスター リカバリーのシナリオでのみ必要な必要があります。 ありません日常的なユーザー アカウント、ドメインのローカル管理者アカウントを除く DA グループが」の説明に従って設定された場合[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
DA アクセスが必要な場合、対象のドメインの DA グループにこのレベルのアクセスを必要とするアカウントを一時的に配置する必要があります。 ユーザーは、高い特権を持つアカウントを使用して、アクティビティを監査および可能であれば、不注意による誤使用や構成の誤りの可能性を最小限に抑えるには、変更を実行する 1 つのユーザーと、変更を観察し、別のユーザーで実行する必要があります。 アクティビティが完了したらは、Domain Admins グループから、アカウントを削除する必要があります。 これにより、手動の手順を通じて行うことができ、サード パーティ製の特権 id/アクセス management (PIM/PAM) のソフトウェアを使用して、プロセス、または両方の組み合わせを解説します。 ガイドラインは Active Directory で権限を持つグループのメンバーシップを制御するアカウントの作成を使用できるに用意されて[付録 i:アカウントおよび Active Directory でグループ管理アカウントを作成する保護される](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)します。  
  
ドメイン管理者は、既定では、すべてのメンバー サーバーと、それぞれのドメイン内のワークステーションにローカルの Administrators グループのメンバーです。 サポート性およびディザスター リカバリー オプションに影響するので、この既定の入れ子を変更しないでください。 Domain Admins グループがメンバー サーバー上のローカルの Administrators グループから削除された場合は、各メンバー サーバーとリンクされた Gpo で制限されたグループ設定を使用してドメインにワークステーションの管理者グループに追加する必要があります。 次の一般的なコントロールで詳しく説明する[付録 f:Active Directory の Domain Admins グループのセキュリティ保護](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)も実装する必要があります。  

フォレスト内の各ドメインの Domain Admins グループ。  

1. DA、ドメインのビルトイン Administrator アカウントのような例外グループからすべてのメンバーを削除」の説明に従ってように保護されている指定[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
2. メンバー サーバーと各ドメインにワークステーションを含む Ou にリンクされた、Gpo では、次のユーザー権利を DA グループを追加してください。  
   - ネットワークからのこのコンピューターへのアクセスを拒否する  
   - バッチ ジョブとしてのログオンを拒否  
   - サービスとしてのログオンを拒否  
   - ローカル ログオンを拒否  
   - リモート デスクトップ サービスを使ったログオンを拒否  
  
   これにより、DA グループのメンバーでメンバー サーバーとワークステーションにログオンできなくなります。 ジャンプ サーバーをドメイン コント ローラーと Active Directory の管理に使用する場合は、ジャンプ サーバーが制限された、Gpo がリンクされていないする OU 内にあることを確認します。  

3. プロパティまたは DA グループのメンバーシップに変更を行った場合にアラートを送信するは、監査を構成する必要があります。 これらのアラートを送信する、最低限、ユーザーまたは AD DS の管理や事故対応を担当するチームに。 プロセスと一時的にグループの正当な作成が実行時に、通知手順を含む、DA グループを設定するための手順を定義することも必要があります。  

#### <a name="securing-administrators-groups-in-active-directory"></a>Active Directory の管理者グループのセキュリティ保護

EA および DA グループと同様に、管理者 (BA) グループのメンバーシップはビルドまたはディザスター リカバリーのシナリオでのみ必要な必要があります。 ありません日常的なユーザー アカウント、ドメインのローカル管理者アカウントを除く、Administrators グループが」の説明に従って設定された場合[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  

管理者のアクセスが必要な場合は、対象のドメインの管理者グループにこのレベルのアクセスを必要とするアカウントを一時的に配置する必要があります。 ユーザーは、高い特権を持つアカウントを使用して、アクティビティが監査し、不注意による誤使用や構成の誤りの可能性を最小限に抑えるには、変更を実行するユーザーと、変更を観察し、別のユーザーで実行可能であれば。 アクティビティが完了したら、アカウントは、Administrators グループからすぐに削除する必要があります。 これにより、手動の手順を通じて行うことができ、サード パーティ製の特権 id/アクセス management (PIM/PAM) のソフトウェアを使用して、プロセス、または両方の組み合わせを解説します。  

管理者は、既定では、ほとんどのそれぞれのドメイン内の AD DS オブジェクトの所有者です。 このグループのメンバーシップは、所有権またはオブジェクトの所有権を取得する機能が必要なビルドおよびディザスター リカバリーのシナリオで必要な可能性があります。 さらに、DAs と EAs は、お客様の権利と、Administrators グループの既定のメンバーシップに基づいてアクセス許可の数を継承します。 既定のグループは入れ子の Active Directory で権限を持つグループを変更しないでくださいと」の説明に従って、各ドメインの管理者グループを保護する必要があります[付録 g:Active Directory の管理者グループをセキュリティで保護する](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)、および一般的な手順を以下にします。  

1. 」の説明に従ってように保護されている、ドメインのローカル管理者アカウントのような例外、Administrators グループからすべてのメンバーを削除[付録 d:Active Directory でビルトイン Administrator アカウントを保護する](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
2. メンバー サーバーまたはワークステーションにログオンするは、ドメインの管理者グループのメンバーが必要はありません。 ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクされている 1 つまたは複数の Gpo では、次のユーザー権利を管理者グループを追加してください。  
   - ネットワークからのこのコンピューターへのアクセスを拒否する  
   - バッチ ジョブとしてログオンを拒否します。  
   - サービスとしてのログオンを拒否  
   - これにより、Administrators グループのメンバーからログオンするか (複数のコントロールが最初に違反がある) 限り、メンバー サーバーまたはワークステーションに接続するために使用されている、場所、資格情報でしたキャッシュして侵害されたことです。 権限の少ないシステムにログオンする権限を持つアカウントを使用しないでくださいと、多くの攻撃に対する保護により、これらのコントロールを適用します。  

3. At 権限 (これらの権限を既に持っていない) 場合のドメイン コント ローラーを次のユーザー フォレスト、Administrators グループの各ドメインで OU を付与する必要があります、ために必要な機能を実行する管理者グループのメンバーが許可すれば、フォレスト全体のディザスター リカバリー シナリオの場合:  
   - ネットワークからこのコンピューターにアクセスする  
   - ローカル ログオンを許可  
   - リモート デスクトップ サービスを使ったログオンを許可する  

4. プロパティまたは Administrators グループのメンバーシップに変更を行った場合にアラートを送信するは、監査を構成する必要があります。 これらのアラートを送信する、少なくとも、AD DS の管理を担当するチームのメンバー。 アラートは、セキュリティ チームのメンバーにも送信する必要があり、Administrators グループのメンバーシップを変更するための手順を定義する必要があります。 具体的には、これらのプロセスでは、セキュリティ チームに通知する、Administrators グループはアラートが送信されると予想される時間し、アラームが発生しないように変更するときにプロシージャを含める必要があります。 さらに、Administrators グループの使用が完了し、使用するアカウント、グループから削除されたときに、セキュリティ チームに通知するプロセスを実装する必要があります。  

> [!NOTE]  
> Gpo 内の管理者グループに制限を実装すると、Windows は、ドメインの管理者グループだけでなく、コンピューターのローカルの Administrators グループのメンバーに、設定を適用します。 したがって、Administrators グループに制限を実装するには注意を使用する必要があります。 ローカル ログオンまたはリモート デスクトップ サービス経由のログオンが、Administrators グループのメンバーは、ネットワーク、バッチおよびサービスのログオンを禁止するには、任意の場所が実装可能なことをお勧めは制限されません。 これらのログオンの種類をブロックしているローカルの Administrators グループのメンバーごとのコンピュータの正当な管理をブロックできます。 次のスクリーン ショットの組み込みの不正使用をブロックする構成設定がローカルおよびドメイン管理者アカウントのローカルまたはドメインのビルトイン管理者グループの不正使用だけでなく。 なお、**リモート デスクトップ サービスを使ったログオンを拒否する**ローカル コンピューターのメンバーであるアカウントのこれらのログオンもブロックはこの設定に含めるために、ユーザー権限で、Administrators グループが含まれません管理者グループ。 このセクションで説明されている権限を持つグループのいずれかのコンテキストで実行するコンピューター上のサービスが構成される場合は、サービスとアプリケーションの失敗を生成してこれらの設定を実装できます。 そのため、すべてがのこのセクションでは、推奨事項には、必ず十分なテスト設定の適用性の環境内でします。  
>
> ![最小限の特権管理者モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_3.gif)  

### <a name="role-based-access-controls-rbac-for-active-directory"></a>Active Directory のロールベースのアクセス制御 (RBAC)

一般に、ロールベースのアクセス制御 (RBAC) は、ユーザーをグループ化し、ビジネス ルールに基づいてリソースへのアクセスを提供するメカニズムです。 Active Directory の場合は、これには、過剰な特権を与えずに日常的な管理タスクを実行するロールのメンバーを許可する権限とアクセス許可を委任します。 ロールの作成のプロセスは AD DS 用の RBAC の実装します。 RBAC を使用した Active Directory のように設計し、既に所有しているサード パーティ製の製品、またはこれらのアプローチの任意の組み合わせを購入することでソフトウェアを活用することでネイティブのツールとインターフェイスを使用して実装できます。 このセクションでは、Active directory は、RBAC を実装するための手順を提供しませんが、代わりに、AD DS インストールで RBAC を実装する方法を選択する際に考慮すべき要因について説明します。  

#### <a name="native-approaches-to-rbac-for-active-directory"></a>RBAC を使用した Active Directory にネイティブ アプローチ

最も簡単な RBAC の実装では、AD DS グループとしての役割を実装し、権限とグループにロールの指定されたスコープ内で日常的な管理を実行するためにそのアクセス許可を委任できます。  

場合によっては、権限とジョブ関数を適切なアクセス許可を付与する Active Directory の既存のセキュリティ グループを使用できます。 たとえば、IT 組織内の特定の従業員が管理と DNS ゾーンとレコードのメンテナンスを担当する場合は、これらの責任を委任するだけでもかまいませんとして各 DNS 管理者のアカウントを作成して、DNS への追加Active Directory で管理者グループ。 DNS Admins グループのより高い特権を持つグループとは異なり、Active Directory の間でいくつかの強力な権限を持つが、このグループのメンバーは内の DNS を管理できるように、アクセス許可を委任されているもの侵害と不正使用を影響を受けますなる可能性があります。特権の昇格。

それ以外の場合は、セキュリティ グループを作成し、指定された管理タスクを実行するには、権限とグループのメンバーを許可する Active Directory オブジェクト、ファイル システム オブジェクト、およびレジストリ オブジェクトへのアクセス許可を委任する必要があります。 たとえば、ヘルプ デスクのオペレーターが、パスワードを忘れた場合のリセットの場合は、接続の問題を持つユーザーを支援し、アプリケーションの設定のトラブルシューティングする必要があります Active Directory でユーザー オブジェクトの委任の設定を結合するにはヘルプ デスク ユーザーを表示またはユーザーの構成設定を変更するユーザーのコンピューターにリモート接続を許可する権限。 各ロールを定義する、識別する必要があります。  

1. タスク、ロールのメンバーは、日常的に実行頻度の低いタスクを実行します。  
2. どのシステムとアプリケーションでは、権限とアクセス許可、ロールのメンバーを付与してください。  
3. ユーザーには、ロールのメンバーシップを付与する必要があります。  
4. ロールのメンバーシップの管理を実行する方法。  

多くの環境で手動で Active Directory 環境の管理用のロールベースのアクセス コントロールの作成は難しい場合が実装および管理します。 場合は、IT インフラストラクチャの管理の役割と責任を明確に定義が、管理しやすいネイティブ RBAC 展開の作成に役立つ追加ツールを活用したい場合があります。 たとえば、Forefront Identity Manager (FIM) の環境内で使用されている場合、作成と継続的な管理が簡単になりますが、管理者の役割の作成を自動化する FIM を使用できます。 System Center Configuration Manager (SCCM) と System Center Operations Manager (SCOM) を使用する場合は、アプリケーション固有ロール管理と監視機能、委任を使用して、一貫性のある構成とシステム間での監査を強制することもドメイン。 公開キー基盤 (PKI) を実装している場合は、発行し、環境の管理を担当する IT スタッフのスマート カードが必要です。 FIM 資格情報の管理 (FIM CM) を管理スタッフのロールと資格情報の管理を結合することもできます。  

それ以外の場合は、「組み込み」機能を提供するサード パーティの RBAC のソフトウェアを展開することも、組織に適してがあります。 RBAC を使用した Active Directory、Windows、および Windows 以外のディレクトリおよびオペレーティング システムの商用、既製の (闘い) ソリューションは、多くのベンダーによって提供されます。 ネイティブのソリューションとサードパーティ製品を選択するときは、次の要因を考慮してください。  

1. 予算:ソフトウェアとツールを既に所有している可能性がありますを使用して RBAC の開発に投資することによりには、ソリューションの配置に関連するソフトウェアのコストを削減することができます。 ただしを作成して、ネイティブの RBAC ソリューションのデプロイの経験があるスタッフがない場合は、ソリューションを開発するコンサルティングのリソースの情報を交換する必要があります。 予算が限られている場合に特には、独自に開発したソリューションの予想されるコスト「使える」ソリューションでは、展開にかかるコストを注意深く検討する必要があります。  
2. IT 環境の構成:Windows システムでは、主に、環境がで構成される場合、または Windows 以外のシステムとアカウントの管理の Active Directory を利用して既に場合は、カスタム ネイティブ ソリューション可能性があります、ニーズに最適なソリューションを提供します。 お客様のインフラストラクチャにすると、Windows を実行していないと、Active Directory で管理されていない多くのシステムが含まれている場合は、Active Directory 環境から個別に非 Windows システムの管理オプションを考慮する必要があります。  
3. ソリューション内の特権モデル:製品にそのサービス アカウントの Active Directory で高い特権を持つグループに配置依存は過剰な特権を必要としないプラン オプションいないは RBAC ソフトウェアに付与する場合は、したが本当に縮小されません、Active Directory の攻撃画面のみが変更されましたディレクトリ内の最も特権グループの構成。 アプリケーション ベンダーは、サービス アカウントを侵害され、悪意を持って使用されるアカウントの確率を最小限に抑えるコントロールを提供することができます、場合を除き、その他のオプションを検討したい場合があります。  

### <a name="privileged-identity-management"></a>Privileged Identity Management

Privileged identity management (PIM) で特権アカウントの管理 (PAM) または特権資格情報の管理 (PCM) は、設計、構築、および管理する方法の実装は特権のアカウントとも呼ば、インフラストラクチャ。 一般に、PIM は、アカウントは一時的な権利を与えるためのメカニズムを提供し、ビルドまたはブレークを実行するために必要なアクセス許可がまま特権アカウントに永続的に接続されているのではなく、関数を修正します。 PIM の機能を手動で作成またはを使用して実装されているかどうかは、次の機能の 1 つ以上のサードパーティ製ソフトウェアの展開ができる場合があります。  
  
- 「コンテナー」、特権アカウントのパスワードは、「チェック アウト」と、初期パスワードを割り当てられている、「チェックイン」アクティビティが完了したとき、パスワードをもう一度アカウントのリセット時に資格情報します。  
- 特権的な資格情報の使用に関する制限を期限付き  
- 1 回使用資格情報  
- 監視とアクティビティが完了したか、時刻を割り当てられたときに実行されるアクティビティと特権の自動削除のレポートでの特権の付与ワークフローによって生成された期限切れ  
- 必要に応じて、資格情報コンテナーから取得する資格情報を許可するアプリケーション プログラミング インターフェイス (Api) を使用してスクリプトでユーザー名とパスワードなどのハード コーディングされた資格情報の交換  
- サービス アカウントの資格情報の自動管理  

### <a name="creating-unprivileged-accounts-to-manage-privileged-accounts"></a>特権アカウントを管理する特権のないアカウントの作成

特権アカウントの管理の課題の 1 つは、既定で、特権、および保護されているアカウントを管理できるアカウントとグループが特権モードと保護されたアカウント。 Active Directory のインストールに適切な RBAC と PIM のソリューションを実装する場合、ソリューションがのみのグループを設定、ディレクトリ内の最も特権グループのメンバーシップを効果的に depopulate するためのアプローチを含めることができます。一時的とときに必要です。  

ただし、ネイティブの RBAC と PIM を実装する場合、必要なときに、Active Directory の特権がない場合や depopulating 特権の作成との唯一の関数をグループ化するアカウントの作成を検討する必要があります。 [付録 i:Active Directory 内の保護されたアカウントとグループの管理アカウントを作成する](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)この目的のためのアカウントの作成に使用できる手順について説明します。  

### <a name="implementing-robust-authentication-controls"></a>堅牢な認証の制御を実装します。

*鉄則 6 つの番号します。実際には、パスワードの推測を試みている人があります。* - [セキュリティ管理の 10 の鉄則](https://technet.microsoft.com/library/cc722488.aspx)  

Pass the hash およびその他の資格情報盗難攻撃は、Windows オペレーティング システムに固有ではないも新しい。 最初は、pass-the-hash 攻撃は、1997 年に作成されました。 従来は、ただし、これらの攻撃カスタマイズされたツールが必要が成功した場合に備わっていた、攻撃者に比較的高度なスキルが必要です。 ネイティブの資格情報を抽出する自由に利用できる、使いやすいツールの概要がここ数年で資格情報盗難攻撃の成功と数を急激に増加が発生しました。 ただし、資格情報盗難攻撃は、資格情報の対象となる、侵害された唯一のメカニズムではではありません。  

攻撃者のターゲットとする最も可能性のある環境内でアカウントを識別する必要がありますにとって強力な認証の制御を実装する資格情報盗難攻撃から保護するためのコントロールを実装する必要がありますがアカウント。 最も特権のアカウントは、ユーザー名やパスワードなどの単一要素認証を使用している場合 (両方とも「何か、」1 つの認証要素である)、それらのアカウントが厳密に保護されています。 いる攻撃者が必要なは、ユーザー名の知識と、アカウントに関連付けられたパスワードの情報とは、pass-the-hash 攻撃では必要ありません、攻撃者が資格情報の 1 つの要素をそのまま使用する任意のシステムにユーザーとして認証できます。  

多要素認証の実装が保護されない multi-factor authentication を実装する、保護されたシステムと組み合わせて、pass the hash 攻撃から。 保護されているシステムの実装に関する詳細情報が提供される[セキュリティで保護された管理ホストを実装する](../../../ad-ds/plan/security-best-practices/Implementing-Secure-Administrative-Hosts.md)、認証オプションの詳細については、次のセクション。  

#### <a name="general-authentication-controls"></a>一般的な認証の制御

スマート カードなどの多要素認証を実装していない場合は、これを検討してください。 スマート カードは、アクセスや、ユーザーが適切な PIN やパスコード、スマート カードに生体認証の識別子を提示しない限り、使用からユーザーの秘密キーの防止、公開/秘密キー ペアの秘密キーのハードウェア ベースの保護を実装します。 PIN またはパスコードを再利用する攻撃者が侵害されたコンピューターにキーストローク ロガーでユーザーの PIN やパスコードが傍受された場合でも、カードを物理的に存在するある必要があります。

スマート カードが、ユーザーことがあります実装比較的単純な Pin やパスコード ブルート フォース攻撃を受けやすいされている資格情報のないメカニズムを提供難色にくい実証が長くて複雑なパスワードの場合、またはレインボー テーブル攻撃です。 スマート カードの Pin は格納されません Active Directory またはローカルの SAM データベースが、資格情報ハッシュは、認証で使用されたスマート カードをコンピューターの LSASS の保護されたメモリにも保存できます。  

#### <a name="additional-controls-for-vip-accounts"></a>VIP アカウントの追加のコントロール

スマート カードまたはその他の証明書ベースの認証メカニズムを実装するもう 1 つのメリットは、VIP ユーザーにアクセスできる機密データを保護する認証メカニズム保証を利用する機能です。 この認証メカニズム保証については、ドメイン機能レベルを Windows Server 2012 または Windows Server 2008 R2 に設定してください。 有効にすると、認証メカニズム保証はユーザーの資格情報が証明書ベースのログオン メソッドを使用してログオン時に認証されるときにユーザーの Kerberos トークンに、グローバル グループの指定された管理者のメンバーシップを追加します。  

これにより、リソース管理者は、ファイル、フォルダー、およびに加えて使用する証明書の種類の証明書ベースのログオン メソッドを使用して、ユーザーがログに記録するかどうかに基づいて、プリンターなどのリソースへのアクセスを制御します。 たとえば、ユーザーがスマート カードを使用してログオンしたときに、ネットワーク上のリソースへのユーザーのアクセスとして指定できます別、ユーザーがスマート カードを使用しない場合に、どのようなアクセスから (つまり、ユーザーのログオン時ユーザー名とパスワードを入力して)。 認証メカニズム保証の詳細については、次を参照してください。、 [Windows Server 2008 R2 ステップ バイ ステップ ガイドでの AD DS の認証メカニズム保証](https://technet.microsoft.com/library/dd378897.aspx)します。  

#### <a name="configuring-privileged-account-authentication"></a>特権アカウントの認証を構成します。

すべての管理アカウントの Active Directory で有効にする、**対話型ログオンにスマート カードを要求**属性、および (最低限) への変更の監査の属性のいずれか、**アカウント**のタブ(たとえば、cn、name、sAMAccountName、userPrincipalName、および userAccountControl) のアカウント管理者のユーザー オブジェクト。  

設定が、**対話型ログオンにスマート カードを要求**アカウントで 120 文字のランダムな値に、アカウントのパスワードがリセットされ、によって上書きも、属性は、対話型ログオンにスマート カードが必要ですアカウントとアカウントのパスワードの変更を許可する権限を持つユーザーは、ユーザー名とパスワードだけで非対話型ログオンを確立するために使用できます。  

それ以外の場合の構成に応じてアカウントを Active Directory 証明書サービス (AD CS) またはサード パーティ製の PKI のユーザー プリンシパル名 (UPN) で Active Directory と証明書の設定での属性を管理または VIP アカウントを対象となることができます。前述のように、攻撃の特定の種類。  

##### <a name="upn-hijacking-for-certificate-spoofing"></a>証明書のスプーフィングの UPN のハイジャック

公開キー基盤 (Pki) に対する攻撃の徹底的に検討するは、このドキュメントの範囲外ですが、2008年以降、パブリックおよびプライベートの Pki への攻撃が指数関数的に増加しました。 パブリック Pki の侵害は幅広く公表されてが、組織の内部 PKI に対する攻撃はよりも多いでしょう。 このような攻撃の 1 つは、Active Directory と証明書は、攻撃者がなりすましの検出を困難に可能性のある方法では、その他のアカウントの資格情報を活用します。  

ドメインに参加しているシステムへの認証を証明書を提供する際に、証明書を Active Directory 内のユーザー オブジェクトにマップする件名または証明書のサブジェクト代替名 (SAN) 属性の内容が使用されます。 、証明書とその構築方法の種類に応じて証明書のサブジェクト属性では、次のスクリーン ショットに示すようにユーザーの共通名 (CN) が通常格納します。  

![最小限の特権管理者モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_4.gif)  

既定では、Active Directory は、アカウントの名前を連結して、ユーザーの CN を構築 +""+ 姓。 内のオブジェクトへの完全パスであるディレクトリ内の別の場所にユーザー アカウントの変更、アカウントの識別名 (DN) を移動するには、ただしの Active Directory 内のユーザー オブジェクトの CN コンポーネントが必要なまたは一意であることが保証されません、ディレクトリでは、前のスクリーン ショットの下部のペインで示すようにします。  

静的または一意の証明書のサブジェクト名は限りませんが、ため、サブジェクトの別名の内容を Active Directory でユーザー オブジェクトを見つけるによく使用されます。 証明書をユーザーにエンタープライズ証明機関から発行された (Active Directory で統合された Ca) の SAN 属性を通常ユーザーの UPN または電子メール アドレスが含まれます。 Upn は、AD DS フォレスト内で一意である保証は、ために、認証、または、認証プロセスに関連する証明書なしの一部として UPN でユーザー オブジェクトの特定が実行よくされます。  

認証証明書の SAN 属性で Upn の使用は、不正な証明書を取得する攻撃者が利用できます。 攻撃者には、ユーザー オブジェクトの Upn を読み書きする機能を持つアカウントが侵害された場合は、攻撃は次のように実装されます。  

VIP ユーザーの場合) などのユーザー オブジェクトの UPN 属性は一時的に別の値に変更されました。 SAM アカウント名の属性と CN の変更することも現時点では、この前に説明した理由のために必要な通常ではありません。  

ターゲット アカウントの UPN 属性が変更されている場合は、古い、有効なユーザー アカウントまたは新たに作成されたユーザー アカウントの UPN 属性がターゲット アカウントに割り当てられた最初の値に変更されます。 古い、有効なユーザー アカウントは、長期間、ログオンしていないが、無効になっていないアカウントです。 攻撃者は、次の理由で「的な風景の非表示」にする、対象となります。  

1. アカウントは有効ですが、最近使用されていない、ため、アカウントを使用する方法ではありませんアラートをトリガーする可能性がありますを無効になっているユーザー アカウントを有効にする場合があります。  
2. 既存のアカウントの使用は、気付き管理スタッフによる新しいユーザー アカウントの作成を必要としません。  
3. まだ有効になっている古いユーザー アカウントでは、さまざまなセキュリティ グループのメンバーでは、通常、およびへのアクセスを簡略化し、既存のユーザーに「描画」は、ネットワーク上のリソースへのアクセスが付与されます。  

ターゲットの UPN が構成されているようになりましたユーザー アカウントは、Active Directory 証明書サービスから 1 つまたは複数の証明書を要求に使用されます。  

証明書は、攻撃者のアカウントの取得されている、元の値に「新しい」アカウントおよびターゲット アカウントの Upn が返されます。  

攻撃者は、証明書に 1 つ以上、ユーザーが VIP ユーザーのアカウントが一時的に変更された場合、リソースおよびアプリケーションへの認証に表示されることができます。 特権アカウントと AD ds の変更に VIP アカウントを監視する必要がある理由を説明するこの攻撃のメカニズムを提供するすべての方法で証明書と PKI の対象にできる攻撃者の詳細については、このドキュメントの範囲外ですが、での属性のいずれかを変更するため、**アカウント** タブ (たとえば、cn、name、sAMAccountName、userPrincipalName、および userAccountControl) アカウント。 だけでなく、アカウントを監視するには、一連の可能な管理ユーザーとして小さな、アカウントを変更できるユーザーを制限する必要があります。 同様に、管理ユーザーのアカウントの保護および許可されていない変更を監視します。  
