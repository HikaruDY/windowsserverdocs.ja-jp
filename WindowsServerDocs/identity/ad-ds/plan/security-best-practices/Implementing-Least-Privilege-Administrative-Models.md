---
ms.assetid: 7a7ab95c-9cb3-4a7b-985a-3fc08334cf4f
title: "最低限の特権の管理モデルを実装します。"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 9716d442446b2705dfd2803d061cb884a5e72fbe
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2017
---
# <a name="implementing-least-privilege-administrative-models"></a>最低限の特権の管理モデルを実装します。

>適用対象: Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

次の抜粋です[の管理者アカウントのセキュリティの計画ガイド](https://technet.microsoft.com/library/cc162797.aspx)、1999 年 4 月 1 日に最初に公開します。  
  
> "について話し合う最低限の特権の原則の実装のほとんどのセキュリティ関連のトレーニング コースやドキュメントいない組織めったに従います。 原則は、単純なと大幅に正しく適用することの影響は、セキュリティが向上し、リスクを軽減します。 原則の内容はすべてのユーザーが絶対最小限のアクセス許可を現在のタスクと何も詳細を完了する必要のあるユーザー アカウントでログオンする必要があります。 これを行う、その他の攻撃の間での悪意のあるコードに対する保護を提供します。 コンピューターとこれらのコンピュータのユーザーにこの原則が適用されます。   
> "この原則がうまく理由の 1 つは強制的に内部調査することです。 たとえば、コンピューターまたはユーザーが実際に必要なアクセス権を特定し、し、それらを実装する必要があります。 多くの組織では、このタスク最初に見えますが多くの作業です。ただし、ネットワーク環境を正常にセキュリティで保護する基本的な手順があります。   
> "必要があります権限を付与するすべてのドメイン管理者のユーザーのドメイン下にある最低限の特権の概念です。 たとえば、管理者が特権アカウントを使用してログオンし、誤ってウイルス対策プログラムを実行する場合、ウイルスが管理アクセス権をローカル コンピューターとドメイン全体にします。 管理者が代わりにログオンしている場合非特権 (管理者以外) アカウントを使用して、破損の感染の範囲のみでしょう、ローカル コンピューター、ローカル コンピューターのユーザーとして実行するため。   
> "別の例では、アカウント ドメイン レベルの管理者権限を付与する必要がありますされませんが特権別のフォレストのフォレスト間に信頼関係がある場合でもします。 この手法では、攻撃者が 1 つの管理されているフォレストのセキュリティを侵害する場合は、広範な損害を防ぐのに役立ちます。 組織は、定期的に監査の特権のエスカレーションを承認されていないから保護するため、ネットワークします。"  
  
次の抜粋から、 [Microsoft Windows セキュリティ リソース キット](https://www.microsoft.com/learning/en/us/book.aspx?ID=6815&locale=en-us)、最初に発行されている 2005。  
  
> "常に、最小限のタスクを遂行するために必要な権限を付与するという点でセキュリティと思われます。 危険にさらされる必要がありますが多すぎる権限を持つアプリケーションは、攻撃者がどのような場合と、アプリケーションは、最小限の特権の下にあるされていたを超えて攻撃を展開できる可能性があります。 たとえば、知らないうちウイルスを起動する電子メールの添付ファイルを開くには、ネットワーク管理者の結果を確認します。 管理者がドメイン管理者アカウントを使用してログオンした場合、ウイルス、ドメイン内のすべてのコンピューターで管理者権限を持つし、ネットワークのほぼすべてのデータにしたがって無制限にアクセスします。 ログオンした場合、管理者は、ローカル管理者アカウントを使用して、ウイルス、ローカル コンピューター上の管理者権限を持つ、したがってができるコンピューター上のデータにアクセスして、コンピューターにキー ストローク ログ ソフトウェアなど、悪意のあるソフトウェアをインストールします。 管理者が通常のユーザー アカウントを使用してログオンした場合、ウイルス、管理者のデータにのみアクセス権を持ち、悪意のあるソフトウェアをインストールすることはできません。 この例では、電子メールを読み取る必要最小限の特権を使用して、セキュリティ侵害への潜在的な範囲は大幅に短縮されました。"  
  
## <a name="the-privilege-problem"></a>権限の問題  
上記の抜粋で説明した原則が変更されていないが、Active Directory のインストールを評価する際の可変を見つけられるしないアカウント権限とはるかに上回ります日常的な作業を実行するために必要なアクセス許可が付与されている数が多すぎます。 環境のサイズは、過度に特権を持つアカウントの生の番号に影響が、proportionmidsized ディレクトリではなくあります数十アカウントの最も高い特権グループに数百または数千大規模な環境を持つことがあります。 攻撃者のスキルとコレクションに見識に関係なく、いくつかの例外を攻撃者が通常最も容易なパスに従います。 ときにのみ防ことで簡単のメカニズムが失敗したりが阻止ツールとアプローチの複雑さが向上します。  
  
残念ながら、多くの環境で最もへの対抗のパスが実証されて broad と高度な特権を持つアカウントの使いすぎします。 広範な権限は、権限とアクセス許可などの環境での大規模な並び間で特定のアクティビティを実行するアカウントを許可するには、ヘルプ デスクのスタッフ付与するには多くのユーザー アカウントのパスワードをリセットすることを許可します。  
  
高度な特権が強力な特権母集団の狭いセグメントに適用される、このようなエンジニアが管理者の権限を与える、サーバー上で実行できるように修復します。 広範な権限も高度な特権が必ずしも危険がドメイン内の多くのアカウントが完全に付与されると広範の特権が侵害されたアカウントの 1 つだけの場合、ことができます簡単に使用する攻撃者の目的に、環境を再構成またはインフラストラクチャの大きなセグメントを破棄するのにはあってもします。  
  
資格情報盗難攻撃の種類であり、-、pass-the-hash 攻撃、ユビキタスため、それらの実行にツーリング自由に利用可能で、簡単に使い、多くの環境が、攻撃に対して脆弱であるためです。 Pass-the-hash 攻撃、実際の問題をただしはありません。 問題の核心は、2 つあります。  
  
1.  通常、単一のコンピューターに高度な特権を取得し、その他のコンピューターに広く特権を付与して反映されるまで、攻撃者による簡単です。  
  
2.  コンピューティング環境全体で高レベルの特権を持つが多すぎるの永続的なアカウントは通常です。  
  
Pass-the-hash 攻撃が排除される場合でも、攻撃者は、戦術、さまざまな戦略ではありませんを使用するだけがします。 資格情報の盗難ツールを含むマルウェアを仕掛けるではなく、下に、キーストロークをログに記録するマルウェアまたは、環境全体で強力な資格情報をキャプチャするには、その他の手法の任意の数を活用可能性があります。 戦術に関係なく、ターゲットは変わりません。 一般と高度な特権を持つアカウントです。  
  
過剰な特権の付与のみにない Active Directory が侵害された環境でします。 組織は許可が必要以上の権限を付与する習慣を開発した、ときに、次のセクションで説明したように、インフラストラクチャ全体にわたってが通常見つかます。  
  
## <a name="in-active-directory"></a>Active Directory で  
Active Directory では、EA、DA BA のグループに過剰な数のアカウントが含まれていることを検索する一般的なです。 ほとんどの場合、組織の EA グループには、最小限のメンバーが含まれています DA グループには、EA] グループで、ユーザーの数の乗数通常が含まれている、Administrators グループには、通常、他のグループを組み合わせるの人口よりも多くのメンバーが含まれます。 管理者は、何らかの理由で信念により多くの場合これは"特権"DAs または EAs よりも低くなります。 権限とこれらの各グループに付与されたアクセス許可が異なる中に、考慮する必要効果的に均等に強力なグループのため、1 つのメンバーが自分自身他の 2 つのメンバーを行うことができます。  
  
## <a name="on-member-servers"></a>メンバー サーバー上で  
メンバーシップのほんの一部ローカルおよびドメインのアカウントの多数の入れ子になったグループへの範囲が見つかったら、多くの環境でメンバー サーバー上のローカルの Administrators グループのメンバーシップを取得する場合、展開するは、明らかに数百台のサーバー上でローカルの管理者権限を持つアカウントの数千ものをも含め、します。 多くの場合は、大規模なメンバーシップを持つドメイン グループがメンバー サーバーのローカル管理者グループに、ドメイン内には、そのグループのメンバーシップを変更できる任意のユーザーには、すべてのシステムをローカルの Administrators グループで、グループのネストされた管理の制御を奪わという事実を考慮せず入れ子になった。  
  
## <a name="on-workstations"></a>ワークステーションで  
通常必要メンバー サーバーには、多くの環境でよりも大幅に減少、ローカルの Administrators グループのメンバーはワークステーションがユーザーには、パーソナル コンピューターに対するローカルの Administrators グループのメンバーシップが付与されます。 これが発生すると、UAC が有効になっている場合でも、それらのユーザーは各自のワークステーションの整合性に対する管理者特権でのリスクを提示します。  
  
> [!IMPORTANT]  
> 慎重に考慮する必要がありますユーザーが各自のワークステーションに対する管理者権限を必要として、Administrators グループのメンバであるコンピューターに別のローカル アカウントを作成する方がある場合は、かどうか。 ユーザーには、昇格が必要な場合、そのローカル アカウント、特権の昇格の資格情報で表示ができますが、アカウントは、ローカルであるために、他のコンピューターを侵害またはドメイン リソースへのアクセスには使用できません。 すべてのローカルのアカウントとただし、ローカルの権限を持つアカウントの資格情報する必要があります一意であります。複数のワークステーション上の同じ資格情報を持つローカル アカウントを作成する場合に、pass-the-hash 攻撃にコンピューターを公開できます。  
  
## <a name="in-applications"></a>アプリケーションで  
これには、ターゲットが組織の知的財産が攻撃を防ぐ、データの取り出しを許可するようにアプリケーション内での強力な特権が付与されたアカウントを対象となることができます。 機密データへのアクセス権を持つアカウント可能性がありますが付与されていないドメインまたはオペレーティング システムで管理者特権でアプリケーションまたはアプリケーションの情報へのアクセスの構成を操作できるアカウントは存在リスクを提供しています。  
  
## <a name="in-data-repositories"></a>データのリポジトリで  
ドキュメントおよびその他のファイルの形式で知的財産へのアクセスをシーク攻撃者ことができます、アカウントをターゲットとその他のターゲットを持つ場合と同様に、ファイルへのアクセス制御を格納する、ファイル、またはでもグループまたはアクセス権を持つファイルへの役割に直接アクセス権を持つアカウントです。 たとえば、契約のドキュメントを保存するファイル サーバーが使用され、Active Directory グループを使用してドキュメントにアクセスする場合は、攻撃者は、グループのメンバーシップを変更できます侵害されたアカウントをグループに追加できコントラクト ドキュメントにアクセスできます。 ドキュメントへのアクセスが SharePoint などのアプリケーションによって提供されている場合、前述のとおり、攻撃者はアプリケーションを特定することができます。  
  
## <a name="reducing-privilege"></a>特権を減らす  
よりも大規模かつ複雑な環境より困難を管理および保護がします。 小規模な組織で特権を減らすことを検討し、比較的単純なのある事案になっても、各追加のサーバー、ワークステーション、ユーザー アカウント、および組織で使用されているアプリケーションは、セキュリティで保護する必要がありますを別のオブジェクトを追加します。 できますが困難または不可能に正しくための組織のすべての側面をセキュリティで保護された IT インフラストラクチャでは、注意すべき作業最大のリスクを作成する権限を持つアカウントで最初に、アカウントおよび Active Directory のグループは通常、組み込みの特権およびワークステーションとメンバ サーバーでの特権を持つローカル アカウントします。  
  
### <a name="securing-local-administrator-accounts-on-workstations-and-member-servers"></a>ワークステーションとメンバ サーバー上のローカル管理者アカウントをセキュリティで保護します。  
ただし、このドキュメントでは、既に説明したように、Active Directory のセキュリティ保護に重点を置いています、個々 のホストに対する攻撃としてディレクトリに対する攻撃の大半を開始します。 メンバのシステム上のローカル グループをセキュリティ保護に関する完全ガイドラインを提供することはできませんが、次の推奨事項は、ワークステーションとメンバ サーバー上のローカル管理者アカウントを保護するために使用することができます。  
  
#### <a name="securing-local-administrator-accounts"></a>ローカル管理者アカウントをセキュリティで保護します。  
すべてのバージョンの Windows がメイン ストリーム サポート中、ローカルの Administrator アカウントは、- pass-the-hash およびその他の資格情報盗難攻撃の使用不可能になったアカウントは、既定で無効になります。 ただし、従来のオペレーティング システムを含むドメインまたはローカル管理者アカウントを有効になっているはメンバー サーバーやワークステーション間でセキュリティ侵害を反映されるまでに説明したようこれらのアカウントを使用することができます。 このため、次のコントロールがドメインに参加しているシステム上のすべてのローカル管理者アカウントをお勧めします。  
  
これらのコントロールを実装するための詳細については、「[付録 h: セキュリティで保護するローカル管理者アカウントとグループ](../../../ad-ds/plan/security-best-practices/Appendix-H--Securing-Local-Administrator-Accounts-and-Groups.md)します。 これらの設定を実装するには、前にただし、ことを確認するローカル管理者アカウントは現在使用されていません環境内のコンピューターでサービスを実行またはその他のアクティビティをこれらのアカウントに指定しないでを実行します。 実稼働環境に実装する前に、これらの設定を十分にテストします。  
  
#### <a name="controls-for-local-administrator-accounts"></a>ローカル管理者アカウントの制御  
ビルトイン Administrator アカウントをメンバー サーバー上のサービス アカウントとして使用しないでも、ローカル コンピューターにログオンに使用する、(、アカウントが無効になっている場合にも許可がセーフ モードを除く)。 ここで説明する設定を実装する目的から使用可能な保護制御が逆になる最初にしない限り、各コンピューターのローカル管理者アカウントを防ぐためにです。 これらのコントロールを実装して、管理者アカウントの変更を監視できます大幅に短縮する攻撃の成功の可能性そのターゲット ローカル管理者アカウント。  
  
##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-joined-systems"></a>ドメインに参加しているシステム上の管理者アカウントを制限する Gpo を構成します。  
次のユーザー権利を管理者アカウントを追加で作成し、ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクされる 1 つまたは複数の Gpo、**コンピューター ポリシー \windows 設定 \ セキュリティ \ Settings\User 権利の割り当て**:  
  
-   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
-   バッチ ジョブとしてログオンを拒否します。  
  
-   サービスとしてログオンを拒否します。  
  
-   リモート デスクトップ サービスを使ったログオンを拒否します。  
  
これらのユーザー権利を管理者アカウントを追加する場合は、追加するかどうか、ローカルの管理者アカウントまたはドメインの管理者アカウントの方法によって、アカウントのラベルを付けることを指定します。 たとえば、NWTRADERS ドメインの管理者アカウントをこれらの拒否を追加する権限、としてアカウントを入力**別**、NWTRADERS ドメインの管理者アカウントにするか参照します。 ローカルの Administrator アカウントを制限するためには、次のように入力します。**管理者**これらのユーザー権利のグループ ポリシー オブジェクト エディターで設定します。  
  
> [!NOTE]  
> ローカル管理者アカウントの名前が変更された場合でも、ポリシーが適用されます。  
  
これらの設定は、誤ってまたは悪意のある有効になっている場合でも、コンピューターの管理者アカウントを他のコンピューターへの接続に使用できないことを確認します。 ローカル管理者アカウントを使用してローカル ログオンを完全に無効にすることはできませんもする必要がありますしようとするためには、コンピューターのローカルの Administrator アカウントは、障害回復シナリオで使用される設計されているためです。  
  
必要がありますメンバー サーバーまたはワークステーションになる切断ない他のローカル アカウント付与された管理者特権を持つドメインから、セーフ モードに、コンピューターを起動できる、管理者アカウントを有効にすることができます、およびコンピューターの修復を有効にするため、アカウントを使用し、ことができます。 修復が完了したら、管理者アカウントが無効にもう一度必要があります。  
  
### <a name="securing-local-privileged-accounts-and-groups-in-active-directory"></a>Active Directory のローカルの権限を持つアカウントとグループをセキュリティで保護します。  
*法律は 6 番: コンピューターは、セキュアで、管理者が信頼できるのみです。* - [Ten Immutable Laws of Security (Version 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
ここで説明されている情報は、最上位の特権の組み込みアカウントと Active Directory のグループを保護するための一般的なガイドラインを提供する対象としています。 詳しい手順については、「[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)、[付録 e: セキュリティで保護する Enterprise Admins グループの Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-E--Securing-Enterprise-Admins-Groups-in-Active-Directory.md)、[付録 f: セキュリティで保護する Domain Admins グループの Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)、し、[[付録 g: セキュリティで保護する Administrators グループを Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)します。  
  
これらの設定のいずれかを実装する前に、環境に適しているかどうかを判断するには、十分にすべての設定もテストする必要があります。 すべての組織は、これらの設定を実装できるようになるとは限りません。  
  
#### <a name="securing-built-in-administrator-accounts-in-active-directory"></a>Active Directory の組み込み管理者アカウントをセキュリティで保護します。  
Active Directory 内の各ドメインの管理者アカウントがドメインの作成の一環として作成されます。 このアカウントは既定では、Domain Admins と、ドメイン内の管理者グループのメンバーと、アカウントが Enterprise Admins グループのメンバーでも、ドメインが、フォレスト ルート ドメインの場合は、します。 初期ビルド アクティビティと、場合によっては、障害回復シナリオ用のみには、ドメインのローカル管理者アカウントの使用を予約する必要があります。 ビルトイン Administrator アカウントをその他のアカウントは使用できません、修復を有効にするために使用できることを確認には、フォレスト内の任意のドメインの Administrator アカウントの既定のメンバーシップを変更しないでください。 代わりに、フォレスト内の各ドメインの Administrator アカウントを保護するためのガイドラインに従う必要があります。 これらのコントロールを実装するための詳細については、「[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
#### <a name="controls-for-built-in-administrator-accounts"></a>ビルトイン Administrator アカウントの制御  
コントロールの数が逆になる場合を除き、使用されている各ドメインの Administrator アカウント (グループではありません) を防ぐために、ここで説明する設定を実装することを目標です。 これらのコントロールを実装すると、管理者アカウントの変更の監視を行う、ドメインの Administrator アカウントを活用することで攻撃が成功する可能性を大幅に短縮できます。 フォレスト内の各ドメインの Administrator アカウントを次の設定を構成する必要があります。  
  
##### <a name="enable-the-account-is-sensitive-and-cannot-be-delegated-flag-on-the-account"></a>アカウントに「アカウントが機密性の高いと委任することはできません」フラグを有効にします。  
既定では、Active Directory 内のすべてのアカウントに委任できます。 委任は、コンピューターまたはコンピューターに認証されたアカウントの資格情報を表示するサービスまたはサービス アカウントの代わりにサービスを取得するには、他のコンピューターにできます。 有効にすると、**アカウントは重要なので委任できない**属性ドメイン ベースのアカウントでは、その他のコンピューターまたはサービス アカウントの資格情報を使用して、他のシステムへの委任を利用する攻撃を制限すると、ネットワーク上に、アカウントの資格情報が提示することはできません。  
  
##### <a name="enable-the-smart-card-is-required-for-interactive-logon-flag-on-the-account"></a>アカウントに「スマート カードは対話型ログオンに必要な」フラグを有効にします。  
有効にすると、**スマート カードが対話型ログオンに必要な**Windows アカウントの属性には、120 文字のランダムな値にアカウントのパスワードがリセットされます。 組み込みの管理者アカウントでこのフラグを設定しているアカウントのパスワードだけでなく長くて複雑なが任意のユーザーには不明ことを確認します。 技術的には、この属性を有効にする前に、アカウント用のスマート カードを作成する必要はありませんが、可能であれば、アカウントの制限を構成する前に管理者アカウントごとにスマート カードを作成する必要があり、スマート カードは、安全な場所に保存する必要があります。  
  
設定が、**スマート カードが対話型ログオンに必要な**フラグは、アカウントのパスワードをリセット、既知の値をアカウントに設定し、ネットワーク上で、アカウントの名前とリソースにアクセスする新しいパスワードを使用してから、アカウントのパスワードをリセットする権限を持つユーザーできないようにします。 このため、アカウントの他のコントロールを実装する必要があります。  
  
##### <a name="disable-the-account"></a>アカウントを無効にします。  
管理者アカウントが既に無効になっていない場合、アカウントのプロパティの構成を完了したときに無効にします。 これは、アカウントが最初に有効になっている場合を除き、任意の目的に使用されていることを防ぎます。 内でアカウントがない AD DS 環境の修復を実行するため、障害回復シナリオでは、ドメイン コント ローラーをセーフ モードを起動で、ビルトイン Administrator アカウント (ローカル ログオンからはブロックされません) をローカル ログオンでき必要に応じて、ドメインの管理者のアカウントを有効にできます。  
  
##### <a name="configuring-gpos-to-restrict-domains-administrator-accounts-on-domain-joined-systems"></a>ドメインに参加しているシステム上のドメインの管理者アカウントを制限する Gpo を構成します。  
効果的に使用不可能になったアカウントは、ドメインの Administrator アカウントを無効にすると、アカウントが誤ってまたは悪意のある有効になっている場合に、アカウントの追加の制限を実装する必要があります。 これらのコントロールは、管理者アカウントによって最終的に切り替えることができます、目標は、攻撃者の進行状況を低速コントロールを作成して、アカウントの損害の制限を与えることができます。  
  
次のユーザー権限が各ドメインの Administrator アカウントを追加で作成し、ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクされる 1 つまたは複数の Gpo、**コンピューター ポリシー \windows 設定 \ セキュリティ \ Settings\User 権利の割り当て**:  
  
-   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
-   バッチ ジョブとしてログオンを拒否します。  
  
-   サービスとしてログオンを拒否します。  
  
-   リモート デスクトップ サービスを使ったログオンを拒否します。  
  
> [!NOTE]  
> この設定をローカルの管理者アカウントを追加する場合は、ローカルの管理者アカウントまたはドメイン管理者アカウントを構成しているかどうかを指定する必要があります。 たとえば、NWTRADERS ドメインのローカルの Administrator アカウントにこれらの拒否を追加する権限、としてアカウントを入力する必要がありますか**別**、NWTRADERS ドメインのローカル管理者アカウントにするか参照します。 入力した場合**管理者**これらのユーザー権利の設定をグループ ポリシー オブジェクト エディターは、GPO を適用する各コンピューターのローカル管理者アカウントを制限します。  
>   
> ドメイン ベースの管理者アカウントと同じ方法でメンバー サーバーおよびワークステーション上のローカルの管理者アカウントを制限することをお勧めします。 そのため、これらのユーザーの権限設定に一般に、フォレスト内の各ドメインの管理者アカウントとローカル コンピューターの管理者アカウントを追加する必要があります。 次のスクリーン ショットは、ローカルの管理者アカウントとドメインの Administrator アカウントはこれらのアカウントは必要ありませんログオンを実行するをブロックするこれらのユーザー権利の構成の例を示します。  

>   
> ![最小限の特権管理モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_20.gif)  
  
##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-controllers"></a>ドメイン コント ローラー上の管理者アカウントを制限する Gpo を構成します。  
フォレスト内の各ドメインでドメイン コント ローラーの既定のポリシーまたはドメイン コント ローラーの OU にリンクされているポリシーをアカウントに追加する各ドメインの管理者では、次のユーザー権利を変更する必要があります**コンピューター ポリシー \windows 設定 \ セキュリティ \ Settings\User 権利の割り当て**:  
  
-   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
-   バッチ ジョブとしてログオンを拒否します。  
  
-   サービスとしてログオンを拒否します。  
  
-   リモート デスクトップ サービスを使ったログオンを拒否します。  
  
> [!NOTE]  
> これらの設定は、アカウント、有効な場合、ローカルにログオンできるドメイン コント ローラーには、ローカルの Administrator アカウントをドメイン コント ローラーへの接続に使用できないことを確認します。 このアカウントを有効になっているのみと障害回復シナリオで使用する必要があります、ために、ことには、少なくとも 1 つのドメイン コント ローラーに物理的にアクセスできる、またはドメイン コント ローラーをリモートでアクセスするアクセス許可を持つその他のアカウントを使用できることと予想されます。  
  
##### <a name="configure-auditing-of-built-in-administrator-accounts"></a>ビルトイン Administrator アカウントの監査を構成します。  
各ドメインの Administrator アカウントをセキュリティで保護し、それを無効になっている場合は、アカウントに変更を監視する監査を構成する必要があります。 アカウントが有効になっている、そのパスワードをリセットすると、その他のすべての変更が加えられるアカウントか、または場合、ユーザーまたは組織のインシデント レスポンス チームだけでなく、AD DS の管理を担当するチームにアラートを送信する必要があります。  
  
### <a name="securing-administrators-domain-admins-and-enterprise-admins-groups"></a>Administrators、Domain Admins と Enterprise Admins グループのセキュリティ保護  
  
#### <a name="securing-enterprise-admin-groups"></a>エンタープライズ管理者のグループをセキュリティで保護します。  
フォレスト ルート ドメインに格納されての Enterprise Admins グループにはとが含まれていないドメインのローカル管理者アカウントのような例外の日常的なごとにユーザーには前述のとおり、セキュリティで保護は提供で[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
EA アクセスが必要な場合は、Enterprise Admins グループにアカウントを持つ EA 権限とアクセス許可を必要とするユーザーを一時的に配置する必要があります。 ユーザーは、高い特権を持つアカウントを使用して、それらのアクティビティを監査および不注意による誤用の構成が正しくない可能性を最小限に抑えるには、変更を実行する 1 つのユーザーと変更を観察してから別のユーザーを使用して実行可能であれば必要があります。 アクティビティが完了したら、アカウントが EA グループから削除する必要があります。 これは、手動の手順の経由で実現でき、プロセス、サード パーティ製の privileged identity/アクセス management (PIM/PAM) ソフトウェア、または両方の組み合わせを文書化します。 ガイドラインは Active Directory の権限を持つグループのメンバーシップを制御に使用するアカウントを作成することができますで提供される[魅力的なアカウントの資格情報の盗難](../../../ad-ds/plan/security-best-practices/Attractive-Accounts-for-Credential-Theft.md)詳細については、「と[付録 i: 管理アカウントを作成する Active Directory 内の保護されるアカウントとグループ](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)します。  
  
Enterprise Admins は、既定で、フォレスト内の各ドメインで組み込みの Administrators グループのメンバーです。 各ドメインの管理者グループから Enterprise Admins グループの削除は、不適切な変更、フォレストの障害回復シナリオが発生した場合 EA 権限は可能性がありますするため必要です。 Enterprise Admins グループは、フォレストの管理者グループから削除されている場合に、各ドメインで管理者グループに追加する必要があり、次の追加の制御を実装する必要があります。  
  
-   前述のように、Enterprise Admins グループが含まれていない」の説明に従ってセキュリティで保護する必要がありますフォレスト ルート ドメインの管理者アカウントのような例外の日常的なごとにユーザーには[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
-   メンバー サーバーおよび各ドメインにワークステーションを含む Ou にリンクされた Gpo では、次のユーザー権利を EA グループを追加してください。  
  
    -   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
    -   バッチ ジョブとしてログオンを拒否します。  
  
    -   サービスとしてログオンを拒否します。  
  
    -   ローカルでログオンを拒否します。  
  
    -   リモート デスクトップ サービス経由でログオンを拒否します。  
  
これにより、メンバー サーバーやワークステーションにログオンしているから EA グループのメンバーができなくなります。 ジャンプ サーバーをドメイン コント ローラーと Active Directory の管理に使用する場合は、制限の厳しい Gpo がリンクされていないする OU のジャンプ サーバーがあることを確認します。  
  
-   プロパティまたは EA グループのメンバーシップに変更を行った場合にアラートを送信する監査を構成する必要があります。 これらのアラートを送信する、少なくとも、ユーザーまたは Active Directory の管理やインシデントの応答を担当するチームにします。 プロセスと一時的に、グループの正当なカタログの作成が実行されるときに通知手順も含めて、EA グループを作成するための手順を定義する必要があります。  
  
#### <a name="securing-domain-admins-groups"></a>Domain Admins グループのセキュリティ保護  
Enterprise Admins グループと同様に、Domain Admins グループのメンバーシップがビルドまたは障害回復シナリオでのみ必要する必要があります。 ありません日常的なユーザー アカウント、ドメインのローカル管理者アカウントを除いて、DA グループ内に含まれている」の説明に従って場合[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
DA アクセスが必要な場合は、問題のドメインの DA グループにこのレベルのアクセスを必要とするアカウントを一時的に配置する必要があります。 ユーザーは、高い特権を持つアカウントを使用して、アクティビティの監査し、不注意による誤用の構成が正しくない可能性を最小限に抑えるには、変更を実行する 1 つのユーザーと変更を観察してから別のユーザーを使用して実行可能であれば必要があります。 アクティビティが完了したときに、Domain Admins グループから、アカウントを削除する必要があります。 これにより、手動の手順の経由で実現でき、サード パーティ製 privileged identity/access management (PIM/PAM) ソフトウェアを使用して、プロセス、または両方の組み合わせを文書化されています。 ガイドラインは Active Directory の権限を持つグループのメンバーシップを制御に使用するアカウントを作成することができますで提供される[付録 i: 管理アカウントを作成する Active Directory 内の保護されるアカウントとグループ](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)します。  
  
ドメイン管理者は、既定で、すべてのメンバー サーバーと、それぞれのドメイン内のワークステーション上のローカルの Administrators グループのメンバーです。 サポート性と障害回復のオプションに影響を与えるために、この既定の入れ子を変更しなければなりません。 Domain Admins グループをメンバ サーバーのローカル管理者グループから削除すると場合、は、各メンバー サーバーおよびリンクされた Gpo で制限されたグループ設定を使用したドメイン内のワークステーション上の Administrators グループに追加してください。 次の全般的なコントロールで詳しく説明されている[付録 f: セキュリティで保護する Domain Admins グループの Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)でも実装する必要があります。  
  
フォレスト内の各ドメインの Domain Admins グループ。  
  
1.  すべてのメンバー グループから削除 DA、ドメインのビルトイン Administrator アカウントのような例外が含まれている」の説明に従って提供[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
2.  メンバー サーバーおよび各ドメインにワークステーションを含む Ou にリンクされた Gpo では、次のユーザー権利を DA グループを追加してください。  
  
    -   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
    -   バッチ ジョブとしてログオンを拒否します。  
  
    -   サービスとしてログオンを拒否します。  
  
    -   ローカルでログオンを拒否します。  
  
    -   リモート デスクトップ サービスを使ったログオンを拒否します。  
  
    これにより、DA グループのメンバーでメンバー サーバーやワークステーションにログオンできなくなります。 ジャンプ サーバーをドメイン コント ローラーと Active Directory の管理に使用する場合は、制限の厳しい Gpo がリンクされていないする OU のジャンプ サーバーがあることを確認します。  
  
3.  プロパティまたは DA グループのメンバーシップに変更を行った場合にアラートを送信する監査を構成する必要があります。 これらのアラートを送信する、少なくとも、ユーザーまたは AD DS の管理やインシデントの応答を担当するチームにします。 プロセスと一時的に、グループの正当なカタログの作成が実行されるときに通知手順も含めて、DA グループを作成するための手順を定義する必要があります。  
  
#### <a name="securing-administrators-groups-in-active-directory"></a>Active Directory の Administrators グループのセキュリティ保護  
EA および DA グループと同様に、管理者 (BA) グループのメンバーシップがビルドまたは障害回復シナリオでのみ必要する必要があります。 ありません日常的なユーザー アカウント、ドメインのローカル管理者アカウントを除いて、Administrators グループに含まれている」の説明に従って場合[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
管理者のアクセスが必要な場合は、問題のドメインの管理者グループにこのレベルのアクセスを必要とするアカウントを一時的に配置する必要があります。 ユーザーは、高い特権を持つアカウントを使用して、アクティビティを監査しと、不注意による誤用の構成が正しくない可能性を最小限に抑えるには、変更を実行するユーザーと変更を観察してから別のユーザーを使用して実行可能であれば、します。 アクティビティが完了したら、アカウントは、Administrators グループからすぐに削除する必要があります。 これにより、手動の手順の経由で実現でき、サード パーティ製 privileged identity/access management (PIM/PAM) ソフトウェアを使用して、プロセス、または両方の組み合わせを文書化されています。  
  
管理者は、既定で、ほとんどのそれぞれのドメインで AD DS オブジェクトの所有者です。 このグループのメンバーシップは、所有権またはオブジェクトの所有権を取得する機能が必要なビルドと障害回復シナリオで必要があります。 さらに、DAs と EAs は、数の権限と、既定のメンバーシップの Administrators グループのおかげでアクセス許可を継承します。 既定のグループは入れ子の Active Directory の権限を持つグループを変更しないように、および」の説明に従って、各ドメインの管理者グループを保護する必要があります[付録 g: セキュリティで保護する Administrators グループを Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)、および一般的な次の手順でします。  
  
1.  ドメインのローカル管理者アカウントのような例外、Administrators グループからすべてのメンバーを削除が含まれている」の説明に従って提供[付録 d: セキュリティで保護する組み込み管理者アカウントでは、Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md)します。  
  
2.  ドメインの管理者グループのメンバーは、メンバー サーバーまたはワークステーションにログオンする必要はありません。 ワークステーションとメンバ サーバーの各ドメイン内の Ou にリンクされている 1 つまたは複数の Gpo では、次のユーザー権利を管理者グループを追加してください。  
  
    -   このコンピューターに、ネットワークからアクセス権を拒否します。  
  
    -   バッチ ジョブとしてログオンを拒否します。  
  
    -   サービスとしてログオンを拒否します。  
  
    -   これにより、Administrators グループのメンバーにログオンまたは (特記のない複数のコントロールはまずして違反して)、メンバー サーバーまたはワークステーションに接続するために使用されているから自分の資格情報がするキャッシュ、それによってセキュリティが侵害されます。 権限の少ないシステムにログオンする権限を持つアカウントを使用しない必要があり、これらのコントロールを適用することにより、いくつかの攻撃から保護します。  
  
3.  At 権利 (既にがあるないこれらの権限) 場合のドメイン コント ローラーが次のユーザー フォレスト、Administrators グループの各ドメインで OU を付与する必要があります、これにより、フォレスト全体の障害回復シナリオに必要な機能を実行する管理者グループのメンバー。  
  
    -   ネットワークからこのコンピューターにアクセスします。  
  
    -   ローカル ログオンを許可します。  
  
    -   リモート デスクトップ サービス経由でログオンを許可します。  
  
4.  プロパティまたは Administrators グループのメンバーシップに変更を行った場合にアラートを送信する監査を構成する必要があります。 これらのアラートを送信する、少なくとも、AD DS の管理を担当するチームのメンバーにします。 、セキュリティ チームのメンバーにも通知を送信して、Administrators グループのメンバーシップを変更するための手順を定義する必要があります。 具体的には、これらのプロセスでは、Administrators グループのアラートが送信されると、予想され、アラームが発生しないように変更するときに、セキュリティ チームを通知する手順を含める必要があります。 さらに、Administrators グループの使用が完了し、使用するアカウントは、グループから削除されているときに、セキュリティ チームに通知するプロセスを実装する必要があります。  
  
> [!NOTE]  
> Gpo 内の Administrators グループに制限を実装すると、ドメインの管理者グループだけでなく、コンピューターのローカルの Administrators グループのメンバーに、設定が適用されます。 したがって、Administrators グループに制限を実装するには、注意を使用してください。 ローカル ログオンまたはリモート デスクトップ サービス経由のログオンが Administrators グループのメンバーは、ネットワーク、バッチおよびサービスのログオンを禁止することに注意してが実装可能なすべての場所では制限されません。 これらのログオンの種類をブロックして、ローカルの Administrators グループのメンバーがコンピューターの正当な管理をブロックできます。 次のスクリーン ショットでは、ローカルの組み込みの不正使用をブロックする構成設定が表示およびドメイン管理者アカウントのだけでなくローカルまたはドメインのビルトイン管理者グループの不正使用。 なお、**リモート デスクトップ サービスを使ったログオンを拒否する**でこの設定を含めることもブロックこれらのログオン アカウントは、ローカル コンピューターの Administrators グループのメンバであるために、ユーザー権利で、Administrators グループが含まれません。 コンピューター上のサービスは、このセクションで説明する権限を持つグループのいずれかのコンテキストで実行するように構成は、これらの設定を実装する場合はサービスとアプリケーションが失敗できるようになります。 そのためのと同様にすべてのこのセクションの推奨事項は、必ず十分なテスト適用性の設定を環境内でします。  

>   
> ![最小限の特権管理モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_3.gif)  
  
### <a name="role-based-access-controls-rbac-for-active-directory"></a>Active Directory の役割に基づいたのアクセス制御 (RBAC)  
一般に、役割に基づいたアクセス制御 (RBAC) は、ユーザーをグループ化し、ビジネス ルールに基づいてリソースへのアクセスを提供するためのメカニズムです。 Active Directory は、の場合は、これには、過剰な特権を付与せず日常的な管理タスクを実行する、ロールのメンバを許可するように権利とアクセス許可を委任します。 役割を作成するプロセスは AD DS の RBAC を実装すます。 Active Directory の RBAC のように設計し、既に所有して、サード パーティ製品、またはこれらのアプローチの任意の組み合わせを購入することでソフトウェアを活用することにより、ネイティブ ツールと、インターフェイスによって実装できます。 このセクションでは、Active Directory、RBAC を実装する方法を手順に沿ってを提供しませんが、代わりに、AD DS インストールで RBAC を実装する方法を選択する際に考慮すべき要因について説明します。  
  
#### <a name="native-approaches-to-rbac-for-active-directory"></a>Active Directory の RBAC ネイティブ方法  
RBAC の最も簡単な実装では、AD DS グループとしての役割を実装し、権限と、ロールの指定されたスコープ内にある日常の管理の実行を許可するグループへのアクセス許可を委任できます。  
  
場合によっては、権限とジョブ機能に適切なアクセス許可を付与する Active Directory 内の既存のセキュリティ グループを使用できます。 たとえば、IT 組織内の特定の従業員が DNS ゾーンとレコードの保守と管理を担当する場合は、その機能を委任できます各 DNS 管理者のアカウントを作成して、Active Directory 内の DNS Admins グループに追加するだけで。 高い権限を持つグループとは異なり、DNS Admins グループでは、このグループのメンバーは DNS を管理するように許可するアクセス許可を委任されているに Active Directory 間でほとんどの強力な権限を持ちません。  
  
それ以外の場合、セキュリティ グループを作成し、指定した管理タスクを実行するには、権限とグループのメンバーを許可するように、Active Directory オブジェクト、ファイル システム オブジェクト、およびレジストリ オブジェクトへのアクセス許可を委任する必要があります。 たとえば、ヘルプ デスク演算子がパスワードを忘れた場合のリセットを担当する場合は、接続の問題を持つユーザーの支援とアプリケーションの設定をトラブルシューティングする必要がありますをヘルプ デスク ユーザーを表示またはユーザーの構成設定を変更するユーザーのコンピューターへのリモート接続を許可する権限を持つ Active Directory でユーザー オブジェクトの委任設定を結合します。 各ロールを定義する、識別する必要があります。  
  
1.  ロールのメンバーのタスクは、日常と実行頻度の低いタスクで実行します。  
  
2.  どのシステムとアプリケーションのうち権限とアクセス許可、ロールのメンバを付与する必要があります。  
  
3.  どのユーザーには、ロールのメンバーシップを付与する必要があります。  
  
4.  ロール メンバーシップの管理を実行する方法。  
  
多くの環境で、Active Directory 環境の管理の役割に基づいたアクセス制御を手動で作成することができますが困難な実装および保守します。 IT インフラストラクチャの管理の役割と責任を明確に定義した、場合は、管理しやすいネイティブ RBAC 展開の作成に役立つ追加ツールを活用することがあります。 たとえば、Forefront Identity Manager (FIM) を環境内で使用している場合は、作成と管理者の役割は、継続的な管理が簡単の作成を自動化する FIM を使用できます。 System Center Configuration Manager (SCCM) と System Center Operations Manager (SCOM) を使用する場合は、管理と監視機能を委任するアプリケーションに固有の役割を使用しておよびも一貫性のある構成と、ドメイン内のシステム全体で監査を実施できます。 公開キー基盤 (PKI) を実装している場合は、発行し、環境の管理を担当する IT スタッフのスマート カードを必要とします。 FIM 資格情報の管理 (FIM CM) を組み合わせることもできますし、役割と資格情報の管理、管理者によってのします。  
  
それ以外の場合では、「インボックス」機能を提供するサード パーティの RBAC ソフトウェアを展開することも、組織の方が望ましい場合があります。 Active Directory、Windows、および Windows 以外のディレクトリ、およびオペレーティング システムの rbac 商用、市販の (既成) ソリューションが多くのベンダーによって提供されます。 ネイティブのソリューションおよびサード パーティ製品を選択する場合は、次の要因を考慮してください。  
  
1.  予算: ソフトウェアとが既にお持ちのツールを使用して RBAC の開発に投資、してには、ソリューションの展開に関連するソフトウェアのコストを削減することができます。 ただしでの作成とネイティブ RBAC ソリューションを展開した経験が、スタッフがない場合は、ソリューションを開発するコンサルティング リソースをエンゲージできない必要があります。 予算が制限されている場合に特に慎重に、カスタム開発したソリューションの予想されるコスト、「インボックス」ソリューションの展開にかかるコストを比較検討する必要があります。  
  
2.  IT 環境の構成: ネイティブのカスタム ソリューションがニーズに最適なソリューションを提供して使用する場合は既に Active Directory の Windows 以外のシステムおよびアカウントの管理、または環境は、主に次の Windows システムで構成します。 インフラストラクチャに多くのシステムで Windows が実行されていないと、Active Directory で管理されていないが含まれている場合は、Windows 以外のシステムとは別に、Active Directory 環境から管理するためのオプションを検討する必要があります。  
  
3.  ソリューションの特権モデル: 場合は、製品、サービス アカウントの Active Directory の高い特権グループに配置に依存が過剰な特権を必要としないオプションがない提供されて、Active Directory を本当に縮小がされません、RBAC ソフトウェアに付与された攻撃 surfaceyou のみ変更したディレクトリに最も特権グループの構成。 アプリケーションの製造元は、侵害された場合、悪意のある使用されているアカウントの危険性を最小限に抑えるサービス アカウントのコントロールを提供することができます、しない限り、その他のオプションを検討してくださいする可能性があります。  

  
### <a name="privileged-identity-management"></a>Privileged Identity Management  
Privileged identity management (PIM)、特権アカウントとして management (PAM) または特権資格情報の管理 (PCM) は、設計、構築、呼ばれ、特権モード、インフラストラクチャ内のアカウントを管理する方法の実装します。 一般に、ビルドまたは break を実行するために必要なアクセス許可をアカウントに永続的に接続されている特権を退出するのではなく、関数、解決して PIM は、アカウントが一時的な権限を与えるためのメカニズムを提供します。 PIM の機能を手動で作成または経由で実装されているかどうか、次の機能の 1 つ以上のサード パーティ製ソフトウェアの展開が使用可能な場合があります。  
  

-   資格情報の「資格情報コンテナーを」の特権を持つアカウントのパスワードを「チェック アウト」し、初期パスワードが割り当てられている、「チェックイン」アクティビティが完了したとき、パスワードをもう一度アカウントのリセット時にどのする場所です。  
  
-   特権を持つ資格情報の使用時にバインドされた制限  
  
-   資格情報のうちの 1 回使用  
  
-   監視とレポートのアクティビティの完了または時間に割り当てられるときに実行されたアクティビティと自動削除する権限と特権の付与ワークフローで生成された期限が切れてください。  
  
-   アプリケーション プログラミング インターフェイス (Api) を使用してスクリプトでユーザー名とパスワードなどのハード コードされた資格情報の交換を必要に応じて資格情報コンテナーから取得する資格情報を許可します。  
  
-   サービス アカウントの資格情報の自動管理  
  
### <a name="creating-unprivileged-accounts-to-manage-privileged-accounts"></a>特権アカウントを管理する特権アカウントの作成  
特権アカウントを管理する課題の 1 つは、既定では、特権と保護されたアカウントを管理できるアカウントとグループが特権モードおよびアカウントを保護します。 Active Directory のインストールに RBAC、PIM の適切なソリューションを実装する場合の解決策には、一時的にのみとタイミングに必要なグループを設定するディレクトリで、最も特権を持つグループのメンバーシップを効果的に depopulate できるようにする方法が含まれます。  
  
ただし、ネイティブの RBAC、PIM を実装する場合、必要になったとき、Active Directory の特権を持っていないをグループ化を設定して、特権を depopulating の唯一の関数とアカウントの作成を検討する必要があります。 [付録 i: Active Directory 内の保護されるアカウントとグループ アカウントを作成する管理](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md)この目的のアカウントを作成するのに使用できる手順を紹介します。  
  
### <a name="implementing-robust-authentication-controls"></a>堅牢な認証制御を実装します。  
*法律は 6 番します。 実際に誰かが、パスワード推測を試みているアウトします。* - [10 Immutable Laws of Security Administration](https://technet.microsoft.com/library/cc722488.aspx)  
  
Pass-the-hash およびその他の資格情報盗難攻撃は、Windows オペレーティング システムに固有ではありませんを使用しても新しいします。 最初に、pass-the-hash 攻撃が 1997年で作成されました。 従来、ただし、これらの攻撃カスタマイズしたツールが必要、された、成功するで hit-or-miss、攻撃者が比較的高いスキルのために必要な。 ネイティブの資格情報を抽出する自由に使用可能な使いやすいツールの概要の結果、数と資格情報盗難攻撃の成功を最近急激に増加します。 ただし、資格情報盗難攻撃ではない資格情報の対象とし、侵害された場合にのみ機構です。  
  
資格情報盗難攻撃から保護するためのコントロールを実装する必要がありますが、攻撃者が対象とする可能性が最も高い環境内でアカウントを識別し、これらのアカウントの強力な認証制御を実装してもください。 最も特権アカウントは、ユーザー名とパスワードなどの 1 つの要素認証を使用している場合 (両方は、"ユーザーが知っている、"1 つの認証要素である)、これらのアカウントが弱く保護されています。 攻撃者が必要なのユーザー名の知識と、アカウントに関連付けられているパスワードを知ってされ、-、pass-the-hash 攻撃は攻撃者の使用が 1 つの要素の資格情報をそのまま使用しているすべてのシステムにユーザーとして認証できるではありません。  
  
多要素認証の実装は保護されません - pass-the-hash 攻撃、保護されたシステムとの組み合わせで多要素認証を実装するからです。 保護されているシステムの実装の詳細についてで提供される[セキュリティで保護された管理ホストを実装する](../../../ad-ds/plan/security-best-practices/Implementing-Secure-Administrative-Hosts.md)、および認証オプションは、次のセクションで説明します。  
  
#### <a name="general-authentication-controls"></a>一般的な認証コントロール  
スマート カードなどの多要素認証を実装していない場合は、これを行うことを検討してください。 スマート カードは、アクセスや、ユーザーが適切な PIN、パスコード、またはスマート カードに生体認証識別子を提示しない限り使用からユーザーの秘密キーの防止、公開/秘密キー ペアの秘密キーのハードウェア ベースの保護を実装します。 ユーザーの PIN やパスコードが侵害されたコンピューターで、PIN やパスコード、再利用する攻撃者のキーストローク ロガーによって傍受されている場合でも、カードも必要があります物理的に存在します。  
  
ユーザーへの対抗のためを実装するが難しい実証されて長くて複雑なパスワードの場合は、スマート カードは、これによってユーザー可能性がありますを実装比較的単純な Pin やパスコード ブルート フォース攻撃やレインボー テーブル攻撃の脅威にさらさずに資格情報のないメカニズムを提供します。 スマート カードの Pin が保存されていない Active Directory またはローカルの SAM データベースが、資格情報のハッシュを認証にスマート カードの使用がコンピューターで保護されている LSASS メモリに保存される可能性があります。  
  
#### <a name="additional-controls-for-vip-accounts"></a>VIP アカウントの追加の制御  
スマート カードまたはその他の証明書ベースの認証メカニズムを実装するもう 1 つの利点は、VIP ユーザーがアクセスできる機密データを保護する認証メカニズム保証を活用する機能です。 認証メカニズム保証は、の機能レベルが Windows Server 2012 または Windows Server 2008 R2 には設定されているドメインで使用できます。 有効な場合、認証メカニズム保証は、証明書ベースのログオン メソッドを使用してログオン時にユーザーの資格情報が認証された後、ユーザーの Kerberos トークンをグローバル グループの指定された管理者のメンバーシップを追加します。  
  
これにより、リソースを管理者が、ファイル、フォルダー、および使用される証明書の種類だけでなく、証明書ベースのログオン方法を使用して、ユーザーがログインするかどうかに基づいて、プリンターなどのリソースへのアクセスを制御します。 たとえば、ユーザーがスマート カードを使用してログオンするときに、ネットワーク上のリソースにユーザーがアクセスとして指定できますさまざまな、どのようなアクセスからは、ユーザーがスマート カードを使用しない場合 (つまり、ユーザーのログオン時ユーザー名とパスワードを入力して)。 認証メカニズム保証に関する詳細については、次を参照してください。、 [Windows Server 2008 R2 ステップ バイ ステップ ガイドの AD DS 関連の認証メカニズム保証](https://technet.microsoft.com/library/dd378897.aspx)します。  
  
#### <a name="configuring-privileged-account-authentication"></a>特権アカウントの認証を構成します。  
Active Directory 内のすべての管理アカウントを有効にする、**対話型ログオンにスマート カードを要求**属性、および (少なくとも) への変更の監査の属性のいずれか、**アカウント**(たとえば、cn、name、sAMAccountName、userPrincipalName、および userAccountControl) のアカウント管理のユーザー オブジェクト] タブします。  
  
設定が、**対話型ログオンにスマート カードを要求**アカウントのアカウントのパスワードを 120 文字のランダムな値にリセットし、属性、対話型ログオン用のスマート カードが上書きされる可能性が、アカウントのパスワードを変更することを許可するアクセス許可を持つユーザーによってとユーザー名とパスワードだけで非対話型ログオンを確立するために使用できます、アカウントが必要です。  
  
他の場合は、構成に依存するアカウントがある Active Directory 証明書サービス (AD CS) またはサード パーティ製の PKI、ユーザー プリンシパル名 (UPN) で Active Directory と証明書の設定の属性を管理または VIP アカウントできます対応している特定の種類の攻撃では、前述のようにします。  
  
##### <a name="upn-hijacking-for-certificate-spoofing"></a>証明書のスプーフィングの UPN ハイジャック  
公開キー基盤 (Pki) に対する攻撃する方法については、このドキュメントの範囲外ですが、2008年以降、パブリックおよびプライベートの Pki に対する攻撃が急激に増加しました。 パブリック Pki の侵害は広く公表されては、組織の内部 PKI に対する攻撃はおそらくよりも多い。 このような 1 つの攻撃を検出するが難しいことができる方法では、その他のアカウントの資格情報を偽装する攻撃者を許可するには、Active Directory と証明書を活用します。  
  
ドメインに参加しているシステムへの認証証明書が表示されたら、サブジェクトまたは証明書のサブジェクトの別名 (SAN) 属性の内容は、証明書を Active Directory 内のユーザー オブジェクトにマップするされます。 、証明書とそれを構築する方法の種類に応じて、証明書のサブジェクト属性には通常が含まれていますユーザーの共通名 (CN)、次のスクリーン ショットに示すようにします。  
  
![最小限の特権管理モデル](media/Implementing-Least-Privilege-Administrative-Models/SAD_4.gif)  
  
既定では、Active Directory は、アカウントの名前を連結することにより、ユーザーの CN を構築 +""+ 姓、名。 ただし、Active Directory 内のユーザー オブジェクトの CN コンポーネントが必要なまたは一意であることが保証されませんし、アカウントの識別名 (DN)、以前のスクリーン ショットの下のウィンドウに示すように、ディレクトリ内のオブジェクトへの完全パスであるを変更するディレクトリ内の別の場所にユーザー アカウントを移動します。  
  
証明書のサブジェクト名は、保障されません静的または一意であるために、サブジェクトの別名の内容は Active Directory でユーザー オブジェクトを検索するよく使用されます。 発行された証明書をユーザーにエンタープライズ証明機関 (Active Directory の統合の Ca) の SAN 属性通常、ユーザーの UPN またはメール アドレスが含まれます。 Upn は、AD DS フォレスト内で一意であることが保証、ため UPN でユーザー オブジェクトの特定が証明書の認証プロセスでの有無、認証の一部として実行よくされます。  
  
不正な証明書を取得する攻撃者によって認証証明書の SAN 属性に Upn の使用を活用できます。 攻撃者には、ユーザー オブジェクトの Upn を読み書きする機能のあるアカウントが侵害された場合は、攻撃が次のように実装されています。  
  
(VIP ユーザー) などのユーザー オブジェクトの UPN 属性は一時的に別の値に変更されています。 SAM アカウント名の属性と CN 変更することも、この時点で通常ではありませんの理由から前述のように必要なです。  
  
ターゲットのアカウントの UPN 属性が変更されると、古い、有効なユーザー アカウントまたは新規に作成したユーザー アカウントの UPN 属性が元々 ターゲット アカウントに割り当てられていた値に変更されます。 古い、有効なユーザー アカウントは、長時間にわたって、ログオンしていないが、無効になっていないアカウントです。 "を非表示に強化されます"次の理由で予定がある攻撃者によってを対象としています。  
  
1.  アカウントが有効になって、最近使用されていないため、アカウントを使用して方法はありませんアラートを起動する可能性があります、無効なユーザー アカウントを有効にする可能性があります。  
  
2.  既存のアカウントの使用を管理スタッフによる気付きを新しいユーザー アカウントの作成は必要ありません。  
  
3.  まだ有効になっている古いユーザー アカウントは、さまざまなセキュリティ グループのメンバーは、通常と、アクセスを簡素化して、既存のユーザー数を「ブレンド」は、ネットワーク上のリソースへのアクセスが付与されています。  
  
ターゲットの UPN が構成されたようになりましたユーザー アカウントを使用して、Active Directory Certificate Services から 1 つまたは複数の証明書を要求します。  
  
攻撃者のアカウントの証明書が取得され、元の値に「新しい」アカウントおよびターゲット アカウントの Upn が返されます。  
  
攻撃者をユーザーが VIP ユーザー アカウントを持つが一時的に変更された場合、リソースとアプリケーションへの認証に提示する 1 つまたは複数の証明書。 特権と特にへの変更、属性のいずれかの変更の AD DS に VIP アカウントのモニターにする必要があります理由を説明するこの攻撃メカニズムが提供されている方法で証明書と PKI できますで対象とする攻撃者のすべての詳細については、このドキュメントの範囲外ですが、**アカウント**(たとえば、アカウントのタブ、cn、name、sAMAccountName、userPrincipalName、および userAccountControl)。 アカウントを監視するには、だけでなく、できるだけ管理ユーザーのセットを小さくするアカウントに変更できるユーザーを制限する必要があります。 同様に、管理ユーザーのアカウントを保護し、未承認の変更を監視する必要があります。  
  


