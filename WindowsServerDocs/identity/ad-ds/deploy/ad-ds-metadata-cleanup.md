---
title: AD DS サーバーのメタデータをクリーンアップします。
description: 組み込みのツールを使用して、削除されたドメイン コント ローラーからのメタデータをクリーンアップします。
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 11/14/2018
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: fbb6e720c9289c608d71d3c36695ba623a9df5f6
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59818083"
---
# <a name="clean-up-active-directory-domain-controller-server-metadata"></a>Active Directory ドメイン コント ローラー サーバーのメタデータをクリーンアップします。

適用先:Windows Server

メタデータのクリーンアップは、Active Directory Domain Services (AD DS) の強制削除後に必要な手順です。 強制的に削除したドメイン コント ローラーのドメイン内のドメイン コント ローラーには、メタデータのクリーンアップを実行します。 メタデータのクリーンアップでは、ドメイン コント ローラーで、レプリケーション システムを識別する AD DS からデータを削除します。 メタデータのクリーンアップもファイル レプリケーション サービス (FRS) と分散ファイル システム (DFS) レプリケーション接続を削除し、操作マスター (とも呼ばれますフレキシブル シングル マスター操作または FSMO) の役割を強制または転送を試みますが、提供終了になったドメインコント ローラーを保持します。

サーバーのメタデータをクリーンアップする次の 3 つのオプションがあります。

- GUI ツールを使用してサーバー メタデータをクリーンアップします。
- コマンドラインを使用してサーバー メタデータをクリーンアップします。
- スクリプトを使用してサーバー メタデータをクリーンアップします。

> [!NOTE]
> これらのメソッドのいずれかを使用してメタデータのクリーンアップを実行するときに、「アクセスが拒否されました」エラーが発生した場合は、コンピューター オブジェクトとドメイン コント ローラーの NTDS 設定オブジェクトが誤って削除される保護されていないことを確認します。 コンピューター オブジェクト、または NTDS 設定オブジェクトを右クリックを確認する をクリックして**プロパティ**、 をクリックして**オブジェクト**、オフにし、**オブジェクトを誤って削除されないように保護**チェック ボックスです。 Active Directory ユーザーとコンピューター、**オブジェクト** をクリックすると、オブジェクトのタブが表示されます**ビュー**  をクリックし、**高度な機能**します。

## <a name="clean-up-server-metadata-using-gui-tools"></a>GUI ツールを使用してサーバー メタデータをクリーンアップします。

リモート サーバー管理ツール (RSAT) または Active Directory ユーザーとコンピューター コンソール (Dsa.msc) をドメイン コント ローラー組織単位 (OU) からドメイン コント ローラーのコンピューター アカウントを削除する Windows Server に含まれているを使用すると、サーバーのメタデータのクリーンアップが自動的に実行されます。 Windows Server 2008 では、前に、別のメタデータのクリーンアップ手順を実行する必要があります。

Active Directory サイトとサービス コンソールのドメイン コント ローラーのコンピューター アカウントを削除するには、(Dssite.msc) もメタデータのクリーンアップを自動的に完了すると使用することもできます。 ただし、Active Directory サイトとサービス メタデータを削除に自動的に最初に dssite.msc」と入力内のコンピューター アカウントの下の NTDS 設定オブジェクトを削除する場合にのみです。

Windows Server 2008 または Dsa.msc または dssite.msc」と入力の新しい RSAT バージョンを使用している限り、自動的に以前のバージョンの Windows オペレーティング システムを実行するドメイン コント ローラーのメタデータをクリーンアップすることができます。

メンバーシップ**Domain Admins**、またはそれと同等がこれらの手順を完了するために必要な最低限です。

## <a name="clean-up-server-metadata-using-activedirectory-users-and-computers"></a>Active Directory ユーザーとコンピューターを使用してサーバー メタデータをクリーンアップします。

1. **[Active Directory ユーザーとコンピューター]** を開きます。
2. この手順の準備でのレプリケーション パートナーを識別してクリーンアップするメタデータを持つ削除されたドメイン コント ローラーのレプリケーション パートナーに接続されていない場合は右クリック**Active Directory ユーザーとコンピューター**ノード、およびクリック**ドメイン コント ローラーの変更**します。 クリックして、メタデータを削除するドメイン コント ローラーの名前をクリックして**OK**します。
3. 強制的に削除し、ドメイン コント ローラーのドメインを展開**ドメイン コント ローラー**します。
4. 詳細ペインで、クリックして、クリーンアップするメタデータを持つドメイン コント ローラーのコンピューター オブジェクトを右クリックして**削除**します。
5. **Active Directory Domain Services**  ダイアログ ボックスで、削除するドメイン コント ローラーの名前が表示され、クリックを確認します。**はい**コンピューター オブジェクトの削除を確定します。
6. **を削除するドメイン コント ローラー**ダイアログ ボックスで、**このドメイン コント ローラーは完全にオフラインであり、Active Directory ドメイン サービス インストール ウィザード (DCPROMO)を使用して不要になった降格できます**、 をクリックし、**削除**します。
7. かどうか、ドメイン コント ローラーは、グローバル カタログ サーバーで、**ドメイン コント ローラーの削除**ダイアログ ボックスで、をクリックして**はい**して削除を続行します。
8. マスターの役割、ドメイン コント ローラーによって 1 つまたは複数の操作が現在保持する場合は、クリックして**OK**ロールまたはロールに表示されているドメイン コント ローラーに移行します。 このドメイン コント ローラーを変更することはできません。 役割を別のドメイン コント ローラーに移動する場合は、サーバー メタデータのクリーンアップ手順を完了したらの役割を移動する必要があります。

## <a name="clean-up-server-metadata-using-activedirectory-sites-and-services"></a>Active Directory サイトとサービスを使用してサーバー メタデータをクリーンアップします。

1. Active Directory サイトとサービスを開きます。
2. この手順の準備でのレプリケーション パートナーを識別してクリーンアップするメタデータを持つ削除されたドメイン コント ローラーのレプリケーション パートナーに接続されていない場合は右クリック**Active Directory サイトとサービス**、 をクリックし、**ドメイン コント ローラーの変更**します。 クリックして、メタデータを削除するドメイン コント ローラーの名前をクリックして**OK**します。
3. 強制的に削除されたドメイン コント ローラーのサイトを展開し、**サーバー**、ドメイン コント ローラーの名前を展開、NTDS 設定オブジェクトを右クリックしておよびクリックして**削除**します。
4. **Active Directory サイトとサービス**ダイアログ ボックスで、をクリックして**はい**NTDS 設定の削除を確定します。
5. **を削除するドメイン コント ローラー**ダイアログ ボックスで、**このドメイン コント ローラーは完全にオフラインであり、Active Directory ドメイン サービス インストール ウィザード (DCPROMO)を使用して不要になった降格できます**、 をクリックし、**削除**します。
6. かどうか、ドメイン コント ローラーは、グローバル カタログ サーバーで、**ドメイン コント ローラーの削除**ダイアログ ボックスで、をクリックして**はい**して削除を続行します。
7. マスターの役割、ドメイン コント ローラーによって 1 つまたは複数の操作が現在保持する場合は、クリックして**OK**ロールまたはロールに表示されているドメイン コント ローラーに移行します。
8. ドメイン コント ローラーを強制的に削除されましたを右クリックし、[削除] をクリックします。
9. **Active Directory Domain Services**ダイアログ ボックスで、をクリックして**はい**ドメイン コント ローラーの削除を確定します。

## <a name="clean-up-server-metadata-using-the-command-line"></a>コマンドラインを使用してサーバー メタデータをクリーンアップします。

代わりに、Ntdsutil.exe、すべてのドメイン コント ローラーと Active Directory ライトウェイト ディレクトリ サービス (AD LDS) インストールされているサーバーに自動的にインストールされているコマンド ライン ツールを使用してメタデータをクリーンアップすることができます。 Ntdsutil.exe も RSAT がインストールされているコンピューターで使用できます。

## <a name="to-clean-up-server-metadata-by-using-ntdsutil"></a>Ntdsutil を使用して、サーバーのメタデータをクリーンアップするには

1. 管理者としてコマンド プロンプトを開きます。**開始** メニューを右クリックして**コマンド プロンプト**、順にクリックします**管理者として実行**します。 場合、**ユーザー アカウント制御** ダイアログ ボックスが表示されたら、エンタープライズ管理者の場合は、必要な資格情報を提供し、**続行**します。
2. コマンド プロンプトで、次のコマンドを入力して Enter キーを押します。

   `ntdsutil`

3. `ntdsutil:` プロンプトで次のコマンドを入力し、Enter キーを押します。

   `metadata cleanup`

4. `metadata cleanup:` プロンプトで次のコマンドを入力し、Enter キーを押します。

   `remove selected server <ServerName>`

5. **サーバー削除の構成] ダイアログ ボックス**情報と、警告を確認し、[クリックして**はい**サーバー オブジェクトおよびメタデータを削除します。

   この時点では、Ntdsutil は、ドメイン コント ローラーが正常に削除されたことを確認します。 オブジェクトが見つからないことを示すエラー メッセージを受信する場合、ドメイン コント ローラーが以前削除されている可能性があります。

6. `metadata cleanup:`と`ntdsutil:`プロンプトに「 `quit`、し、ENTER キーを押します。

7. ドメイン コント ローラーの削除を確認します。

   Active Directory ユーザーとコンピューターを開きます。 削除されたドメイン コント ローラーのドメインで次のようにクリックします。**ドメイン コント ローラー**します。 詳細ペインで、削除したドメイン コント ローラーのオブジェクトは表示されません。

   Active Directory サイトとサービスを開きます。 移動し、**サーバー**コンテナーを削除した、ドメイン コント ローラーのサーバー オブジェクトに、NTDS 設定オブジェクトが含まれていないことを確認します。 サーバー オブジェクトの下の子オブジェクトが表示されない場合は、サーバー オブジェクトを削除することができます。 子オブジェクトが表示されている場合は、別のアプリケーションが、オブジェクトを使用しているため、サーバー オブジェクトを削除しないでください。

## <a name="see-also"></a>関連項目

* [ドメイン コント ローラーの降格](Demoting-Domain-Controllers-and-Domains--Level-200-.md)
* [Ntdsutil コマンド リファレンス](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753343(v=ws.10))
