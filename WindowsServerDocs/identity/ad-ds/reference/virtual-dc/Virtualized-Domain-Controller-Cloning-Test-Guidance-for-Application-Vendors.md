---
ms.assetid: fde99b44-cb9f-49bf-b888-edaeabe6b88d
title: "仮想化ドメイン コント ローラーの複製のアプリケーション ベンダー向けのテスト ガイダンス"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 72c4e818f82d3252c45776b26fb59e095893f2c7
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2017
---
# <a name="virtualized-domain-controller-cloning-test-guidance-for-application-vendors"></a>仮想化ドメイン コント ローラーの複製のアプリケーション ベンダー向けのテスト ガイダンス

>適用対象: Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

このトピックでは、アプリケーション ベンダーの検討ように、アプリケーションは、仮想化ドメイン コント ローラー (DC) 複製プロセスが完了した後に期待どおりに動作を継続する必要がありますについて説明します。 その対象となるアプリケーション ベンダーと追加のテストが保証されているシナリオは、複製プロセスの機能を説明します。 アプリケーション ベンダーが、複製された仮想化ドメイン コント ローラーで、アプリケーションが動作する検証は、コミュニティ コンテンツ場所のユーザーの詳細については、検証、組織の web サイトへのリンクと共に、このトピックの下部で、アプリケーションの名前を一覧表示することをお勧めします。  
  
## <a name="overview-of-virtualized-dc-cloning"></a>仮想化 DC の複製の概要  
仮想化ドメイン コント ローラーを複製プロセスがで詳しく説明されている[Introduction to Active Directory ドメイン サービス (AD DS) Virtualization (Level 100)](https://technet.microsoft.com/library/hh831734.aspx)と[仮想化ドメイン コント ローラーのテクニカル リファレンス (レベル 300)](https://technet.microsoft.com/library/jj574214.aspx)します。 アプリケーション ベンダーの観点から、アプリケーションに複製の影響を評価するときに考慮する事項があります。  
  
-   元のコンピューターは破棄されません。 クライアントとの対話、ネットワークのままになります。 名前の変更を元のコンピューターの DNS レコードを削除しとは異なり、ソース ドメイン コント ローラーの元のレコードが残ります。  
  
-   複製のプロセス中に、新しいコンピューターが最初に実行されて短時間、古いコンピューターの id で、複製プロセスが開始され、必要な変更されるまで。 ホストに関するレコードを作成するアプリケーションは、複製プロセス中にに関する、元のホスト レコードは複製されたコンピューターによって上書きしないことを確認してください。  
  
-   複製は、その他のサーバーの役割を複製する一般的な用途拡張子ではなく、唯一の仮想化ドメイン コント ローラーの特定の展開機能です。 一部のサーバーの役割では、複製はサポートされません具体的には。  
  
    -   動的ホスト構成プロトコル (DHCP)  
  
    -   Active Directory 証明書サービス (AD CS)  
  
    -   Active Directory ライトウェイト ディレクトリ サービス (AD LDS)  
  
-   複製プロセスの一環として、VM を元の DC を表す全体がコピーされるので、その VM でのアプリケーションの状態もコピーします。 アプリケーションがこの複製された DC で、ローカル ホストの状態の変更に対応する検証またはの介入が必要な場合、サービスの再起動などです。  
  
-   複製の一環として、新しい DC を取得する新しいマシン id および条項自体レプリカ DC としてトポロジでします。 アプリケーションなど、名前、アカウント、SID、マシン id に依存しているかどうかを検証します。 自動的に適応の複製でマシン id の変更ですか。 そのアプリケーションがデータをキャッシュする場合は、キャッシュがマシン id のデータに依存しないことを確認します。  
  
## <a name="what-is-interesting-for-application-vendors"></a>アプリケーション ベンダー向け興味深いとは?  
  
### <a name="customdccloneallowlistxml"></a>CustomDCCloneAllowList.xml  
アプリケーションまで、アプリケーションまたはサービスを実行するドメイン コント ローラーを複製することはできませんまたはサービスは、いずれかです。  
  
-   Get-addccloningexcludedapplicationlist Windows PowerShell コマンドレットを使用して、CustomDCCloneAllowList.xml ファイルに追加  
  
- または -  
  
-   ドメイン コント ローラーから削除  
  
初めて、ユーザーが、Get-addccloningexcludedapplicationlist コマンドレットを実行する、サービスと、ドメイン コント ローラーで実行しているが、サービスと複製のサポートされているアプリケーションの既定の一覧に含まれていないアプリケーションの一覧を返します。 既定では、サービスやアプリケーションは表示されません。 サービスやアプリケーションと安全に実行できるサービスの一覧にアプリケーションを追加するに複製されると、ユーザーの実行を CustomDCCloneAllowList.xml に追加するために - GenerateXML オプションを使用してファイルのもう一度 Get-addccloningexcludedapplicationlist コマンドレット。 詳細については、次を参照してください。[手順 2: 実行 Get-addccloningexcludedapplicationlist コマンドレット](https://technet.microsoft.com/library/hh831734.aspx#bkmk6_run_get_addccloningexcludedapplicationlist_cmdlet)します。  
  
### <a name="distributed-system-interactions"></a>分散システムの相互作用  
通常、ローカル コンピューターに分離サービス成功] または [複製で参加している場合は失敗します。 短時間に同時に、ネットワーク上でホスト コンピューターの 2 つのインスタンスを持つ心配の分散サービスが必要があります。 これは、新しいベンダー id のとして、複製が登録されているパートナー システムからの情報を取得しようとして、サービス インスタンスとしてマニフェスト可能性があります。 または、サービスの両方のインスタンスは、それぞれ異なる結果に同時に、AD DS データベースに情報をプッシュします。 たとえばはありません決定的するコンピューターは、Windows テスト テクノロジ (WTT) サービスが 2 台のコンピューターがドメイン コント ローラーを使用してネットワーク上にある場合に伝達されます。  
  
分散の DNS サーバー サービスの新しい IP アドレスで複製ドメイン コント ローラーを起動したときに、ソース ドメイン コント ローラーの DNS レコードを上書きするを複製プロセスは慎重に回避します。  
  
複製の終了までのすべての古い id を削除するコンピューターにはしないでください。 新しいコンテキスト内、新しいドメイン コント ローラーを昇格すると後、は、コンピューターの追加の状態をクリーンアップするプロバイダーを実行する Sysprep を選択します。 たとえばはこの時点で、コンピューターの古い証明書が削除され、コンピューターがアクセスできる暗号の機密情報を変更します。  
  
複製のタイミングが変化する最大の要因は、PDC からレプリケートするオブジェクトの数をです。 古いメディアでは、複製の完了に必要な時間が向上します。  
  
不明なため、サービスやアプリケーション、それが実行されたままです。 複製プロセスには、Windows 以外のサービスの状態は変わりません。  
  
さらに、新しいコンピューターには、元のコンピューターよりも、別の IP アドレスがあります。 これらの動作が原因で、サービスまたはアプリケーションによっては、この環境でのサービスまたはアプリケーションの動作方法に影響することがあります。  
  
## <a name="additional-scenarios-suggested-for-testing"></a>その他のシナリオをテストするための推奨  
  
### <a name="cloning-failure"></a>複製に失敗しました。  
サービス ベンダーは、複製に失敗したときに、コンピューターの起動時にディレクトリ サービス修復モード (DSRM)、セーフ モードのフォームために、このシナリオをテストする必要があります。 この時点で、コンピューターが完了していない複製します。 一部の状態が変更された可能性し、一部の状態が元のドメイン コント ローラーから残ることがあります。 アプリにどのような影響を理解するには、このシナリオをテストします。  
  
複製の失敗を強制的に実行するに複製対象となる許可を与えることがなく、ドメイン コント ローラーを複製してみます。 この場合、コンピューターはのみを変更、IP アドレスの大部分の元のドメイン コント ローラーからの状態を保つことができます。 クローンを作成するドメイン コント ローラーのアクセス許可を付与の詳細については、次を参照してください。[手順 1: ソース仮想化ドメイン コント ローラーに複製対象となる許可を与える](https://technet.microsoft.com/library/hh831734.aspx#bkmk4_grant_source)します。  
  
### <a name="pdc-emulator-cloning"></a>PDC エミュレーターの複製  
サービスおよびアプリケーションのベンダーは、PDC エミュレーターが複製されるときに、追加の再起動があるために、このシナリオをテストする必要があります。 さらに、複製の大部分は、複製プロセス中に、PDC エミュレーターと対話する新しい複製を許可するように、一時的な id で実行されます。  
  
### <a name="writable-versus-read-only-domain-controllers"></a>読み取り専用ドメイン コント ローラーと書き込み可能  
サービスおよびアプリケーションのベンダーが、同じ種類のドメイン コント ローラーを使用して複製をテストする必要があります (つまり、書き込み可能なや読み取り専用ドメイン コント ローラーで) サービスは、上で実行する予定です。  
  


