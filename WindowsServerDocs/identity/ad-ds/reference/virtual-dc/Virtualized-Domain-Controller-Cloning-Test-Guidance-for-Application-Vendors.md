---
ms.assetid: fde99b44-cb9f-49bf-b888-edaeabe6b88d
title: アプリケーション ベンダー向けの仮想化ドメイン コントローラー複製のテスト ガイダンス
description: ''
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 0b2303bc837cdaf9f6e7ebd4b3ccbf6c66aa7ad2
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59879343"
---
# <a name="virtualized-domain-controller-cloning-test-guidance-for-application-vendors"></a>アプリケーション ベンダー向けの仮想化ドメイン コントローラー複製のテスト ガイダンス

>適用先:Windows Server 2016 では、Windows Server 2012 R2、Windows Server 2012

このトピックでは、アプリケーション ベンダーの検討に役立つ、アプリケーションは仮想化ドメイン コント ローラー (DC) 複製プロセスの完了後に期待どおりに動作を継続することを確認する必要がありますについて説明します。 その対象アプリケーションのベンダーと追加のテストが保証されているシナリオは、複製プロセスのこれらの側面を説明します。 複製された仮想化ドメイン コント ローラーで、アプリケーションが機能するが検証するアプリケーションのベンダーは、コミュニティ コンテンツへのリンクと共に、このトピックの下部で、アプリケーションの名前を一覧表示することが推奨されます、組織の web サイトの詳細については、検証はユーザーがどこで学習します。  
  
## <a name="overview-of-virtualized-dc-cloning"></a>仮想化 DC の複製の概要  
仮想化ドメイン コント ローラーのプロセスを複製がで詳しく説明されている[Active Directory Domain Services (AD DS) Virtualization (Level 100) の概要](https://technet.microsoft.com/library/hh831734.aspx)と[仮想化ドメイン コント ローラー技術リファレンス (レベル 300)](https://technet.microsoft.com/library/jj574214.aspx)します。 アプリケーション ベンダーの観点から、アプリケーションを複製の影響を評価するときに考慮する事項のうち。  
  
-   元のコンピューターは破棄されません。 クライアントとの対話、ネットワークに残ります。 名前の変更を元のコンピューターの DNS レコードを削除しとは異なり、ソース ドメイン コント ローラーの元のレコードが残ります。  
  
-   複製のプロセス中に、複製プロセスが開始され、必要な変更になるまでに、古いコンピューターの id で、簡単な期間、新しいコンピューターが実行している最初にします。 ホストについてのレコードを作成するアプリケーションでは、複製されたコンピューターは、複製プロセス中に、元のホストについてのレコードを上書きしないことを確認してください。  
  
-   複製は、特定の展開は他のサーバー ロールを複製する汎用拡張子ではなく、唯一の仮想化ドメイン コント ローラーの機能です。 サーバーの役割は、複製はサポートされていません具体的には。  
  
    -   動的ホスト構成プロトコル (DHCP)  
  
    -   Active Directory 証明書サービス (AD CS)  
  
    -   Active Directory ライトウェイト ディレクトリ サービス (AD LDS)  
  
-   複製プロセスの一環として、元の DC を表す VM 全体がコピーされるので、VM 上で、アプリケーションの状態でもコピーされます。 アプリケーションが複製された DC 上のローカル ホストの状態でこの変更に対応する検証の操作は、サービスの再起動など、必要な場合またはします。  
  
-   クローン作成の一環として、新しい DC を新しいコンピューター id とプロビジョニング自体レプリカ DC としてトポロジでは、 アプリケーション名、アカウント、SID、具合など、コンピューター id に依存しているかどうかを検証します。 自動的に適応のクローンのマシン id の変更か。 そのアプリケーションがデータをキャッシュする場合は、キャッシュはマシン id のデータに依存しないことを確認します。  
  
## <a name="what-is-interesting-for-application-vendors"></a>アプリケーション ベンダーの興味深い新機能ですか。  
  
### <a name="customdccloneallowlistxml"></a>CustomDCCloneAllowList.xml  
アプリケーションまで、アプリケーションまたはサービスを実行するドメイン コント ローラーを複製することはできませんまたはサービスは、いずれかです。  
  
-   Get-addccloningexcludedapplicationlist Windows PowerShell コマンドレットを使用して、CustomDCCloneAllowList.xml ファイルに追加  
  
- または -  
  
-   ドメイン コント ローラーから削除  
  
初めてユーザーが、Get-addccloningexcludedapplicationlist コマンドレットを実行するドメイン コント ローラーで実行しているが、サービスとの複製がサポートされているアプリケーションの既定の一覧にないサービスとアプリケーションの一覧を返します。 既定では、サービスやアプリケーションは表示されません。 サービスまたはアプリケーションと安全には、サービスの一覧にアプリケーションを追加するには、複製すると、ユーザーの実行が、CustomDCCloneAllowList.xml に追加するには - GenerateXML オプションを使用してファイルの再 Get-addccloningexcludedapplicationlist コマンドレット。 詳細については、次を参照してください。[手順 2。Get-addccloningexcludedapplicationlist コマンドレットを実行](https://technet.microsoft.com/library/hh831734.aspx#bkmk6_run_get_addccloningexcludedapplicationlist_cmdlet)します。  
  
### <a name="distributed-system-interactions"></a>分散システムの相互作用  
通常、サービスがローカル コンピューターに分離成功または失敗の複製に参加しているときにします。 分散型サービスは、短時間の同時に、ネットワーク上のホスト コンピューターの 2 つのインスタンスを持つについて考慮する必要です。 これは、id の新しい仕入先として、複製が登録されているパートナーのシステムから情報を取得しようとしています。 サービス インスタンスとしてマニフェスト可能性があります。 または、サービスの両方のインスタンスは異なる結果を同時に、AD DS データベースに情報をプッシュすることがあります。 たとえば、ない確定的なのどのコンピューターは Windows テスト テクノロジ (WTT) サービスがある 2 台のコンピューターがドメイン コント ローラーを使用してネットワーク上にある場合、と共に伝達されます。  
  
分散型の DNS サーバー サービスの新しい IP アドレスで複製ドメイン コント ローラーの開始時にソース ドメイン コント ローラーの DNS レコードの上書きを複製のプロセスは慎重に回避します。  
  
複製の末尾まですべての古い id を削除するコンピューターにはしないでください。 新しいコンテキスト内で新しいドメイン コント ローラーが昇格されると、Sysprep のプロバイダーは、コンピューターの追加の状態をクリーンアップする実行を選択します。 たとえばはこの時点で、コンピューターの古い証明書が削除され、コンピューターにアクセスできる暗号化シークレットを変更します。  
  
複製のタイミングが変化する最大の要因は、オブジェクトの数が、PDC から複製するには。 古いメディアには、完全な複製に必要な時間が増加します。  
  
サービスまたはアプリケーションが不明であるためが実行されたままです。 複製のプロセスには、Windows 以外のサービスの状態は変わりません。  
  
また、新しいコンピューターには、元のコンピューターの別の IP アドレスがあります。 これらの動作をサービスやアプリケーションによってはこの環境でのサービスまたはアプリケーションの動作の副作用があります。  
  
## <a name="additional-scenarios-suggested-for-testing"></a>テストに関して推奨される追加のシナリオ  
  
### <a name="cloning-failure"></a>複製に失敗しました。  
サービス ベンダーは、複製に失敗したときに、コンピューターの起動時にディレクトリ サービス修復モード (DSRM)、一種のセーフ モードであるために、このシナリオをテストする必要があります。 この時点で、コンピューターでは、複製が未完了です。 いくつかの状態が変更された可能性がありますが、元のドメイン コント ローラーから一部の状態が残る可能性があります。 アプリケーションにどのような影響を理解するには、このシナリオをテストします。  
  
複製の障害を誘発するには、複製を作成する権限を与えることがなく、ドメイン コント ローラーのクローンを試みます。 この場合、コンピューターがのみ、IP アドレスを変更でき、元のドメイン コント ローラーからの状態の大半を保つことができます。 複製を作成するドメイン コント ローラーのアクセス許可を付与する方法の詳細については、次を参照してください。[手順 1。ソース仮想ドメイン コント ローラーの複製を作成するアクセス許可を与える](https://technet.microsoft.com/library/hh831734.aspx#bkmk4_grant_source)します。  
  
### <a name="pdc-emulator-cloning"></a>PDC エミュレーターの複製  
サービスとアプリケーションのベンダーは、PDC エミュレーターが複製されたときに、追加の再起動があるために、このシナリオをテストする必要があります。 さらに、複製の大部分は、複製のプロセス中に、PDC エミュレーターと対話する新しい複製を許可する一時的な id で実行されてです。  
  
### <a name="writable-versus-read-only-domain-controllers"></a>読み取り専用ドメイン コント ローラーと Writable  
サービスとアプリケーションのベンダーは、複製ドメイン コント ローラーの同じ型を使用してテストする必要があります (つまり、書き込み可能または読み取り専用ドメイン コント ローラーで) サービスは、上で実行する予定です。  
  


