---
ms.assetid: 8ce6e7c4-cf8e-4b55-980c-048fea28d50f
title: "SQL Server を使用してフェデレーション サーバー ファーム"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: e23154b20dfcd642178a5ac0de17f1b6a490f91f
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2017
---
# <a name="ad-fs-requirements"></a>AD FS の要件

>Windows Server 2012 R2 の適用対象:

AD FS を展開するときに従う必要のあるさまざまな要件を次に示します。  
  
-   [証明書の要件](AD-FS-Requirements.md#BKMK_1)  
  
-   [ハードウェア要件](AD-FS-Requirements.md#BKMK_2)  
  
-   [ソフトウェアの要件](AD-FS-Requirements.md#BKMK_3)  
  
-   [AD DS の要件](AD-FS-Requirements.md#BKMK_4)  
  
-   [構成データベースの要件](AD-FS-Requirements.md#BKMK_5)  
  
-   [ブラウザーの要件](AD-FS-Requirements.md#BKMK_6)  
  
-   [エクストラネットの要件](AD-FS-Requirements.md#BKMK_extranet)  
  
-   [ネットワークの要件](AD-FS-Requirements.md#BKMK_7)  
  
-   [属性ストアの要件](AD-FS-Requirements.md#BKMK_8)  
  
-   [アプリケーションの要件](AD-FS-Requirements.md#BKMK_9)  
  
-   [認証要件](AD-FS-Requirements.md#BKMK_10)  
  
-   [ワークプ レース ジョインの要件](AD-FS-Requirements.md#BKMK_11)  
  
-   [暗号化の要件](AD-FS-Requirements.md#BKMK_12)  
  
-   [アクセス許可の要件](AD-FS-Requirements.md#BKMK_13)  
  
## <a name="BKMK_1"></a>証明書の要件  
証明書では、フェデレーション サーバー、Web アプリケーション プロキシ、claims\ に対応するアプリケーション、および Web クライアント間の通信をセキュリティで保護するで最も重要な役割を果たします。 証明書の要件は、かどうかを設定する、フェデレーション サーバーまたはプロキシ コンピューターの場合、このセクションで説明したによって異なります。  
  
**フェデレーション サーバーの証明書**  
  
|||  
|-|-|  
|**証明書の種類**|**要件、サポート & の注意事項**|  
|**セキュリティで保護されたソケット レイヤー \(SSL\) 証明書:**これは、フェデレーション サーバーとクライアント間の通信を保護するためには、標準的な SSL 証明書。|-この証明書である必要があります、公的 trusted\ * X509 v3 証明書。<br />に任意の AD FS エンドポイントにアクセスするは、すべてのクライアントは、この証明書を信頼する必要があります。 パブリック \(third\-party\) 証明機関によって発行された証明書を使用することは推奨が強く \(CA\) します。 テスト ラボ環境でフェデレーション サーバーでは、自己署名 SSL 証明書を正常に使用できます。 ただし、実稼働環境のためは、パブリック CA から証明書を入手することを勧めします。<br />-SSL 証明書を Windows Server 2012 R2 でサポートされている任意のキー サイズをサポートしています。<br />-サポート証明書はなく CNG のキーを使用しません。<br />-職場 Join\/デバイス登録サービスと共に使用する場合、AD FS サービスの SSL 証明書のサブジェクト代替名では、組織では、たとえば、enterpriseregistration.contoso.com のユーザー プリンシパル名 \(UPN\) サフィックスに続く値 enterpriseregistration を含める必要があります。<br />ワイルド カードの証明書がサポートされます。 AD FS サービスのサービス名を提供するように求められますが、AD FS ファームを作成するときに \ (たとえば、 **adfs.contoso.com**します。<br />Web アプリケーション プロキシに同じ SSL 証明書を使用する-を強くお勧めします。 ただしこれは**必要**に Web アプリケーション プロキシ経由と \(default setting\) で拡張保護の認証が有効にした場合、Windows 統合認証エンドポイントをサポートしている場合、同じになります。<br />-この証明書のサブジェクト名を展開する AD FS の各インスタンスのフェデレーション サービス名を表すために使用します。 このため、自分の会社またはパートナーに組織の名前を最も良く表すもので新しい CA\ 発行する証明書のサブジェクト名の選択を検討します。<br />    証明書の id がフェデレーション サービス名と一致する必要があります \ (たとえば、fs.contoso.com\)。Id は種類 dNSName のいずれか、サブジェクト代替名拡張子または、サブジェクト名が共通名として指定されたサブジェクト代替名エントリがない場合。 サブジェクトの別名の複数のエントリは、フェデレーション サービス名と一致する 1 つの提供、証明書に存在することができます。<br />-   **重要:**ことを AD FS ファームのすべてのノードだけでなく、AD FS ファーム内のすべての Web アプリケーション プロキシの間で同じ SSL 証明書を使用することを強くお勧めします。|  
|**サービス通信証明書:**この証明書がフェデレーション サーバー間の通信を保護するための WCF メッセージ セキュリティを使用します。|-既定では、SSL 証明書がサービス通信証明書として使用されます。  サービス通信証明書として別の証明書を構成するオプションもあります。<br />-   **重要:** SSL 証明書の有効期限が切れたときに、サービス通信証明書と、SSL 証明書を使用している場合、サービス通信証明書と更新された SSL 証明書を構成することを確認します。 自動的には実行されません。<br />-この証明書は、WCF メッセージ セキュリティを使用して AD FS のクライアントによって信頼されている必要があります。<br />にパブリック \(third\-party\) 証明機関によって発行されたサーバー認証証明書を使用することお勧め \(CA\) します。<br />-サービス通信証明書は CNG のキーを使用する証明書をすることはできません。<br />-この証明書は、AD FS 管理コンソールを使用して管理できます。|  
|**Token\ 署名証明書:**これは、標準の X509 証明書を安全にフェデレーション サーバーが発行するすべてのトークンの署名に使用します。|-既定では、AD FS は、自己署名証明書を 2048 ビットのキーを作成します。<br />CA の発行された証明書もサポートしの AD FS 管理スナップインを使用して変更することができます。<br />CA の証明書を発行は、保存されている & CSP 暗号化プロバイダーを使用してアクセスする必要があります。<br />-トークン署名証明書は CNG のキーを使用する証明書をすることはできません。<br />AD FS では、トークン署名の外部で登録されている証明書は必要ありません。<br />    AD FS に自動的に更新これらの自己署名証明書、有効期限前に最初、使用するパートナーを許可するように、セカンダリ証明書と新しい証明書を構成し、証明書の自動ロール オーバーと呼ばれるプロセスでプライマリを反転します。トークンの署名証明書を自動的に生成された、既定値を使用することをお勧めします。<br />    組織のポリシーを構成するさまざまな証明書をトークンの署名が必要な場合は、インストール時に Powershell を使用する証明書を指定できます \ (Install\ AdfsFarm cmdlet\ の – SigningCertificateThumbprint パラメーターを使用)。  インストール後、表示および AD FS 管理コンソールまたは Powershell コマンドレットになって AdfsCertificate と Get\ AdfsCertificate を使用して、トークン署名証明書を管理できます。<br />    外部で登録されている証明書が使用すると、トークンの署名証明書の自動更新またはロール オーバー AD FS は実行しません。  このプロセスは、管理者によって実行する必要があります。<br />    証明書のロール オーバーは、1 つの証明書が期限切れ間近の場合、AD FS でセカンダリのトークン署名証明書を構成することができます。 既定では、すべてのトークン署名証明書は、フェデレーション メタデータで公開されますが、プライマリ token\ 署名証明書のみが実際にトークンに署名する AD FS によって使用します。|  
|**Token\-decryption\/暗号化解除証明書:**これは、標準の X509 certificate つまり decrypt\/暗号化されたトークンを使用します。 また、フェデレーション メタデータで発行されます。|-既定では、AD FS は、自己署名証明書を 2048 ビットのキーを作成します。<br />CA の発行された証明書もサポートしの AD FS 管理スナップインを使用して変更することができます。<br />CA の証明書を発行は、保存されている & CSP 暗号化プロバイダーを使用してアクセスする必要があります。<br />-Token\-decryption\/暗号化解除証明書は CNG のキーを使用する証明書をすることはできません。<br />-既定では、AD FS は、生成し、トークン暗号化解除に、独自の内部で生成し、自己署名証明書を使用します。  AD FS では、この目的の外部で登録されている証明書は必要ありません。<br />    さらに、AD FS では自動的にこれらの自己署名証明書を更新して、有効期限前にします。<br />    **既定では、トークン暗号化解除を自動的に生成された証明書を使用することをお勧めします。**<br />    組織は、トークン暗号化解除を構成するさまざまな証明書を必要とするポリシーがある場合、は、インストール時に Powershell を使用して、証明書を指定できます \ (Install\ AdfsFarm cmdlet\ の – DecryptionCertificateThumbprint パラメーターを使用)。  インストール後、表示および AD FS 管理コンソールまたは Powershell コマンドレットになって AdfsCertificate と Get\ AdfsCertificate を使用してトークン暗号化解除証明書を管理できます。<br />    **トークン暗号化解除の外部で登録されている証明書を使用する場合、AD FS は証明書の自動更新を実行しません。このプロセスは、管理者が実行しなければならない**します。<br />-AD FS サービス アカウント、ローカル コンピューターの個人用ストアに token\ 署名証明書の秘密キーへのアクセスが必要です。 これは、処理のセットアップでします。 また、後に、token\ 署名証明書を変更した場合、このアクセスを確保するのにの AD FS 管理スナップインを使用することができます。|  
  
> [!CAUTION]  
> Token\ 署名証明書と token\ decrypting\/暗号化に使用される証明書は、フェデレーション サービスの安定性にとって重要です。 これらの証明書がバックアップし、ご利用いただけません個別に回復イベント中に、ユーザー独自の token\ 署名 & token\ decrypting\/暗号化証明書を管理する必要がありますを確認します。  
  
> [!NOTE]  
> AD FS で SHA\ 1 または SHA\ 256 \(more secure\) にデジタル署名に使用されるセキュア ハッシュ アルゴリズム \(SHA\) レベルを変更することができます。 AD FS は MD5 など、他のハッシュ方式と一緒に証明書の使用をサポートしていません \ (Makecert.exe コマンドラインされます \ で使用される既定ハッシュ アルゴリズム)。 セキュリティのベスト プラクティスとして SHA\ 256 を使用することをお勧め \ (default\ によって設定されます) のすべての署名します。 シナリオでは、AD FS の Microsoft 以外の製品またはレガシ バージョンなど、SHA\ 256 を使用して通信がサポートされない製品と相互作用が必要でのみ使用には、SHA\ 1 を使用することをお勧めします。  
  
> [!NOTE]  
> CA から証明書を受信した後は、すべての証明書がローカル コンピューターの個人用証明書ストアにインポートすることを確認します。 証明書 MMC スナップインを使用して個人用ストアに証明書をインポートすることができます。  
  
## <a name="BKMK_2"></a>ハードウェア要件  
Windows Server 2012 R2 の AD FS フェデレーション サーバーに、次の最小および推奨ハードウェア要件が適用されます。  
  
||||  
|-|-|-|  
|**ハードウェアの要件**|**最小要件**|**推奨要件**|  
|CPU の速度|1.4 GHz 64 ビット プロセッサ|Quad\ コア 2 GHz|  
|RAM|512 MB|4 GB|  
|ディスク領域|32 GB|100 GB|  
  
## <a name="BKMK_3"></a>ソフトウェアの要件  
次の AD FS の要件は、Windows Server® 2012 R2 オペレーティング システムに組み込まれているサーバーの機能のことです。  
  
-   エクストラネット アクセスは、Web アプリケーション プロキシ役割サービスを展開する必要があります \ - Windows Server® 2012 R2 のリモート アクセス サーバーの役割の一部です。 フェデレーション サーバー プロキシの以前のバージョンでは、Windows Server® 2012 R2 で AD FS でサポートされていません。  
  
-   同じコンピューターに、フェデレーション サーバーと Web アプリケーション プロキシ役割サービスをインストールすることはできません。  
  
## <a name="BKMK_4"></a>AD DS の要件  
**ドメイン コントローラーの要件**  
  
ユーザーのすべてのドメインと AD FS サーバーが参加しているドメインのドメイン コント ローラーは、Windows Server 2008 以降を実行されている必要があります。  
  
> [!NOTE]  
> Windows Server 2003 ドメイン コントローラを備えた環境のすべてのサポートは、延長サポート終了日 Windows Server 2003 の後に終了します。 お客様はそのドメイン コント ローラーをできるだけ早くアップグレードを強く推奨します。 参照してください[このページ](https://support.microsoft.com/lifecycle/search/default.aspx?sort=PN&alpha=Windows+Server+2003&Filter=FilterNO)マイクロソフト サポート ライフ サイクルの詳細についてはします。 検出された問題のことは Windows Server 2003 ドメイン コント ローラー環境を特定、修正プログラムに発行されることだけのセキュリティの問題および延長サポートの Windows Server 2003 の有効期限が切れる前に、修正プログラムが実行できるかどうかです。  
  
**ドメイン functional\ レベルの要件**  
  
すべてのユーザー アカウントのドメインと AD FS サーバーが参加しているドメインは、Windows Server 2003 以上のドメイン機能レベルで動作する必要があります。  
  
AD FS の機能のほとんどには、正常に機能する AD DS functional\ レベルの変更は不要です。 ただし、Windows Server 2008 ドメインの機能レベル、またはそれ以上はクライアント証明書の認証証明書が明示的に AD DS 内のユーザーのアカウントにマッピングされている場合、正常に機能するために必要です。  
  
**スキーマの要件**  
  
-   AD FS は、スキーマの変更や AD DS に functional\ レベルの変更は必要ありません。  
  
-   ワークプ レース ジョインの機能を使用するには、Windows Server 2012 R2 に参加している AD FS サーバーのフォレストのスキーマを設定する必要があります。  
  
**サービス アカウントに関する要件**  
  
-   任意の標準のサービス アカウントは、AD FS 用のサービス アカウントとして使用できます。 グループの管理されたサービス アカウントもサポートされます。 これには、少なくとも 1 つのドメイン コント ローラーが必要です \ (2 つを展開することをお勧めまたは more\) Windows Server 2012 またはそれ以上実行します。  
  
-   Kerberos 認証クライアントの \servername に参加していると、AD FS の間の関数を ' HOST\/< adfs\_service\_name >"サービス アカウントの SPN として登録する必要があります。 既定では、AD FS は構成この操作を実行するための十分なアクセス許可がある場合は、新しい AD FS ファームを作成するときにします。  
  
-   AD FS サービス アカウントは、AD FS サービスへのユーザーの認証を含むすべてのユーザー ドメインで信頼されている必要があります。  
  
**ドメインの要件**  
  
-   すべての AD FS サーバーは、AD DS ドメインに参加する必要があります。  
  
-   1 つのドメインには、ファーム内のすべての AD FS サーバーを展開する必要があります。  
  
-   ドメインに参加している AD FS サーバーでは、AD FS サービスへの認証ユーザーが含まれるすべてのユーザー アカウントのドメインを信頼しなければなりません。  
  
**マルチ フォレストの要件**  
  
-   ドメインに参加している AD FS サーバーには、すべてのユーザー アカウントのドメインまたは AD FS サービスへの認証のユーザーを含むフォレストを信頼しなければなりません。  
  
-   AD FS サービス アカウントは、AD FS サービスへのユーザーの認証を含むすべてのユーザー ドメインで信頼されている必要があります。  
  
## <a name="BKMK_5"></a>構成データベースの要件  
要件は、次の構成ストアの種類に基づいて適用される制限には.  
  
**WID**  
  
-   WID ファームは 30 台のフェデレーション サーバーの制限が 100 台以下証明書利用者信頼がある場合。  
  
-   WID の構成データベースには、SAML 2.0 では、アーティファクト解決プロファイルがサポートされていません。  トークン リプレイ検出は、WID 構成データベースでサポートされていません。 のみ、この機能は AD FS のフェデレーション プロバイダーとして機能して外部要求プロバイダーからのセキュリティ トークンを消費しているシナリオでのみ使用します。  
  
-   フェールオーバーの中央に個別のデータでの AD FS サーバーを展開するか、サーバーの数が 30 を超えない限り、地理的な負荷分散がサポートされています。  
  
次の表に、WID ファームの概要について説明します。  実装を計画するのにには、それを使用します。  
  
||||  
|-|-|-|  
||1 \-100 RP 信頼|100 を超える RP 信頼|  
|1 \-30 AD FS ノード|WID のサポート|WID を使用してサポートされていません \-必要な SQL|  
|複数の 30 AD FS ノード|WID を使用してサポートされていません \-必要な SQL|WID を使用してサポートされていません \-必要な SQL|  
  
**SQL Server**  
  
Windows Server 2012 R2 で AD FS での SQL Server 2008 以降を使用することができます。  
  
## <a name="BKMK_6"></a>ブラウザーの要件  
ブラウザーまたはブラウザー コントロールを使用して AD FS の認証が実行されると、お使いのブラウザーは、次の要件に従う必要があります。  
  
-   JavaScript を有効にする必要があります。  
  
-   Cookie をオンにする必要があります。  
  
-   Server Name Indication \(SNI\) がサポートされている必要があります。  
  
-   ユーザー証明書とデバイス証明書の認証 \ (ワークプ レース ジョイン functionality\)、ブラウザーは SSL クライアント証明書の認証をサポートする必要があります  
  
いくつかの主要ブラウザーとプラットフォームには、レンダリングおよび機能の詳細については、以下の検証してきました。 ブラウザーと次の表で説明されていないデバイスが上記の要件を満たしている場合にもサポートされます。  
  
|||  
|-|-|  
|**ブラウザー**|**プラットフォーム**|  
|IE 10.0|Windows 7、Windows 8.1、Windows Server 2008 R2、Windows Server 2012、Windows Server 2012 R2|  
|IE 11.0|Windows7、Windows 8.1、Windows Server 2008 R2、Windows Server 2012、Windows Server 2012 R2|  
|Windows Web 認証ブローカー|Windows 8.1|  
|Firefox \[v21\]|Windows 7、Windows 8.1|  
|Safari \[v7\]|iOS 6、Mac \ X 10.7|  
|Chrome \[v27\]|Windows 7、Windows 8.1、Windows Server 2012、Windows Server 2012 R2、Mac \ X 10.7|  
  
> [!IMPORTANT]  
> 既知の問題 \-Firefox: デバイスの証明書を使用してデバイスを識別するワークプ レース ジョインの機能は Windows プラットフォームでは機能しません。 Firefox は、Windows クライアントでユーザー証明書ストアにプロビジョニング証明書を使用して実行する SSL クライアント証明書認証を現在サポートしていません。  
  
**Cookie**  
  
AD FS では、クライアント コンピューター サインインを提供する、sign\ アウト、単一の sign\ \(SSO\)、およびその他の機能に保存する必要がありますいるでベースや永続的な cookie を作成します。 したがって、クライアントのブラウザーは cookie を受け入れるように構成する必要があります。 認証に使用される cookie は発信元のサーバーに書き込まれる Secure Hypertext Transfer Protocol \(HTTPS\) セッションの cookie では常にです。 クライアントのブラウザーが、これらの cookie を許可するように構成されていない、AD FS が正しく機能することはできません。 永続的な cookie を使用して、ユーザーによる要求プロバイダーの選択を保持します。 AD FS サインイン ページの構成ファイルで構成設定を使用して、それらを無効にすることができます。 TLS\ と SSL のサポートは、セキュリティ上の理由から必要があります。  
  
## <a name="BKMK_extranet"></a>エクストラネットの要件  
AD FS サービスへのエクストラネット アクセスを提供するには、必要がありますとして展開する Web アプリケーション プロキシ役割サービス、エクストラネットに直接つながっている役割プロキシ認証要求をする AD FS サービスのセキュリティで保護された方法でします。 これにより、AD FS サービスのエンドポイントの分離、およびすべてのセキュリティ キーの分離 \ (トークン署名 certificates\) などの要求はインターネットから送信されるからです。 さらに、アカウントのソフトのエクストラネット ロックアウトなどの機能では、Web アプリケーション プロキシの使用が必要です。 Web アプリケーション プロキシの詳細については、次を参照してください。 [Web アプリケーション プロキシ](https://technet.microsoft.com/library/dn584107.aspx)します。  
  
この third\ 製プロキシがで定義されているプロトコルをサポートする必要があります、third\ パーティー プロキシへのエクストラネット アクセスを使用する場合は、 [http:///\/download.microsoft.com\/download\/9\/5\/E\/95EF66AF\-9026\-4BB0\-A41D\-A4F81802D92C\/%5bMS\-ADFSPIP%5d.pdf](https://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5bMS-ADFSPIP%5d.pdf)します。  
  
## <a name="BKMK_7"></a>ネットワークの要件  
次のネットワーク サービスを適切に構成すると、組織内の AD FS の展開の成功が重要です。  
  
**企業のファイアウォールを構成します。**  
  
Web アプリケーション プロキシとフェデレーション サーバー ファーム間にあるファイアウォールと、クライアントと Web アプリケーション プロキシの間のファイアウォールの両方に TCP ポート 443 を有効になっている必要があります受信します。  
  
さらに、クライアント ユーザー証明書の認証場合 \ (X509 を使用して認証をし用 clientTLS ユーザー certificates\) は、必要に応じて、Windows Server 2012 R2 の AD FS が必要です TCP ポート 49443 を有効にするクライアントと Web アプリケーション プロキシの間のファイアウォールの受信します。 これは不要で Web アプリケーション プロキシと、フェデレーション \software\microsoft\sms\components\sms_site_component_manager\component servers \ 間のファイアウォール) です。  
  
**DNS を構成します。**  
  
-   イントラネット アクセスでは、すべてのクライアントが企業内部ネットワーク \(intranet\) 内での AD FS サービスにアクセスする必要がありますを AD FS サービス名を解決できない \ (SSL certificate\ により提供される名前) または AD FS サーバーの AD FS サーバーのロード バランサーにします。  
  
-   エクストラネットのアクセスには、企業ネットワーク \(extranet\/internet\) の外部から AD FS サービスにアクセスするすべてのクライアントで AD FS サービス名を解決するのにはできる必要があります \ (SSL certificate\ により提供される名前)、Web アプリケーション プロキシ サーバーまたは Web アプリケーション プロキシ サーバーをロード バランサーにします。  
  
-   正常に機能するエクストラネット アクセスには、境界ネットワーク内の各 Web アプリケーション プロキシ サーバーで AD FS サービス名を解決するのにはできる必要があります \ (SSL certificate\ により提供される名前) または AD FS サーバーの AD FS サーバーのロード バランサーにします。 これは、代替 DNS サーバーを使用して、境界ネットワークのネットワークまたは HOSTS ファイルを使用して、ローカル サーバーの解像度を変更することで実現できます。  
  
-   Web アプリケーション プロキシ経由で公開されているエンドポイントのサブセットのネットワークの外部ネットワークの内部使用し、統合 Windows 認証は、ロード バランサーを指す A レコード \(not CNAME\) を使用する必要があります。  
  
会社の DNS にフェデレーション サービスとデバイス登録サービスを構成する方法の詳細については、次を参照してください。[フェデレーション サービスと DRS 用企業 DNS を構成する](https://technet.microsoft.com/library/dn486786.aspx)します。  
  
Web アプリケーション プロキシの企業 DNS を構成する方法の詳細については、"DNS を構成する"」のセクションを参照してください。[手順 1: Web アプリケーション プロキシ インフラストラクチャを構成する](https://technet.microsoft.com/library/dn383644.aspx)します。  
  
NLB を使用する FQDN をクラスターまたはクラスター IP アドレスを構成する方法についてでクラスター パラメーターを指定するを参照してください[http:///\/go.microsoft.com\/fwlink\/ ですか?LinkId\ = 75282](https://go.microsoft.com/fwlink/?LinkId=75282)します。  
  
## <a name="BKMK_8"></a>属性ストアの要件  
AD FS には、ユーザーを認証し、それらのユーザーのセキュリティ クレームを抽出するためには、少なくとも 1 つの属性ストアが必要です。 AD FS をサポートしているストアは、属性の一覧を参照してください[、属性ストアの役割](../../ad-fs/technical-reference/The-Role-of-Attribute-Stores.md)します。  
  
> [!NOTE]  
> AD FS は、既定では、"Active Directory"属性ストアを自動的に作成します。 属性ストアの要件は、組織が、アカウント パートナーとして機能するかどうかに依存して \ (フェデレーション users\ をホストしている) またはリソース パートナー \ (フェデレーションできるアプリケーションをホストしている)。  
  
**LDAP 属性ストア**  
  
その他のライトウェイト ディレクトリ アクセス プロトコルで作業する場合 \ (LDAP\) \-based の属性ストア、Windows 統合認証をサポートしている LDAP サーバーに接続する必要があります。 RFC 2255 での手順に従って、LDAP 接続文字列を LDAP URL の形式で記述もする必要があります。  
  
また、AD FS サービスのサービス アカウントに、LDAP 属性ストア内のユーザー情報を取得する権限があるために必要なです。  
  
**SQL Server 属性ストア**  
  
AD FS が正常に動作する Windows Server 2012 R2 で、SQL Server 属性ストアをホストするコンピューター必要があります実行されているいずれかの Microsoft SQL Server 2008 以上。 SQL\ ベースの属性ストアを使用する場合は、接続文字列も構成する必要があります。  
  
**カスタム属性ストア**  
  
高度なシナリオを有効にするカスタム属性ストアを開発することができます。  
  
-   AD FS に組み込まれているポリシー言語は、次のシナリオのいずれか強化できるように、カスタム属性ストアを参照できます。  
  
    -   ローカルで認証されるユーザーの信頼性情報を作成します。  
  
    -   外部で認証されたユーザーの信頼性情報を補足します。  
  
    -   トークンを取得するユーザーを承認します。  
  
    -   ユーザーの行動に基づいてトークンを取得するサービスを承認します。  
  
    -   [証明書利用者に AD FS によって発行されるセキュリティ トークンの追加データを発行します。  
  
-   .NET 4.0 の上に、またはそれ以上、すべてのカスタム属性ストアを構築する必要があります。  
  
カスタム属性ストアを使用する場合は、接続文字列を構成する必要がありますもします。 その場合は、カスタム属性ストアに接続できるようにする、任意のカスタム コードを入力することができます。 このような状況で、接続文字列は、カスタム属性ストアの開発者によって実装されているように解釈される名前 \/値のペアのセットです。開発とカスタム属性ストアの使用に関する詳細については、次を参照してください。[属性ストアの概要](https://go.microsoft.com/fwlink/?LinkId=190782)します。  
  
## <a name="BKMK_9"></a>アプリケーションの要件  
AD FS には、次のプロトコルを使用する claims\ に対応するアプリケーションがサポートしています。  
  
-   WS\ フェデレーション  
  
-   WS\ 信頼  
  
-   SAML 2.0 プロトコルが IDPLite、SPLite & eGov1.5 プロファイルを使用します。  
  
-   OAuth 2.0 承認 Grant プロファイル  
  
AD FS では、Web アプリケーション プロキシでサポートされている以外 claims\ 対応アプリケーションの認証と承認もサポートします。  
  
## <a name="BKMK_10"></a>認証要件  
**AD DS 認証 \(Primary Authentication\)**  
  
イントラネット アクセスでは、AD DS 用の次の標準の認証メカニズムがサポートされています。  
  
-   Kerberos と NTLM のネゴシエートを使用した Windows 統合認証  
  
-   Username\/パスワードを使用してフォーム認証  
  
-   AD DS でユーザー アカウントにマップする証明書を使用して証明書の認証  
  
エクストラネット アクセスについては、次の認証メカニズムがサポートされます。  
  
-   Username\/パスワードを使用してフォーム認証  
  
-   AD DS 内のユーザー アカウントにマップされている証明書を使用して証明書の認証  
  
-   Windows 統合認証が Windows 統合認証を受け付ける WS\ 信頼エンドポイントのネゴシエート \(NTLM only\) を使用します。  
  
証明書の認証。  
  
-   Pin が保護されていることができるスマート カードを拡張します。  
  
-   Pin の入力をユーザーの GUI では、AD FS によってが指定されていないと、クライアント TLS を使用するときに表示されるクライアント オペレーティング システムの一部である必要があります。  
  
-   リーダーと暗号化サービス プロバイダー \(CSP\) スマート カードは、ブラウザーが配置されているコンピューターで動作する必要があります。  
  
-   スマート カード証明書は必要がありますまで、すべての AD FS サーバーと Web アプリケーション プロキシ サーバーの信頼されたルート チェーンでつながっています。  
  
-   証明書は、によって、次のいずれかを AD DS でユーザー アカウントにマップする必要があります。  
  
    -   証明書のサブジェクト名は、AD DS 内のユーザー アカウントの LDAP 識別名に対応します。  
  
    -   証明書のサブジェクト別名拡張機能がユーザーのプリンシパル \(UPN\) AD DS 内のユーザー アカウントの名前を付けます。  
  
シームレスな統合 Windows 認証に Kerberos を使用して、イントラネット内  
  
-   サービス名が信頼済みサイト、またはローカルのイントラネット サイトの一部である必要です。  
  
-   また、HOST\]、[< adfs\_service\_name > SPN は、AD FS ファームがで実行されているサービス アカウントに設定する必要があります。  
  
**マルチ要素認証**  
  
AD FS は、追加の認証をサポートしている \ (AD DS\ でサポートされているプライマリ認証) を超えるプロバイダーを使用してモデル化により vendors\/ユーザーは、管理者が登録およびログイン時に使用できる、独自のマルチ要素認証アダプターを構築できます。  
  
すべての MFA アダプターは、.NET 4.5 の上位に構築する必要があります。  
  
MFA の詳細については、次を参照してください。[による追加の多要素認証による個人情報アプリケーションのリスク管理](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md)します。  
  
**デバイスの認証**  
  
AD FS では、自分のデバイスへの参加エンドユーザー ワークプ レース] の act の中にデバイス登録サービスによってプロビジョニング証明書を使用してデバイス認証をサポートします。  
  
## <a name="BKMK_11"></a>ワークプ レース ジョインの要件  
エンドユーザーは、AD FS を使用して、組織に自分のデバイスをワークプ レース ジョインにことができます。 これは、AD FS でデバイス登録サービスをサポートします。 その結果、エンドユーザーは、AD FS でサポートされているアプリケーションに SSO するという利点を取得します。 さらに、管理者は、組織に参加している社内されているデバイスにのみアプリケーションにアクセスを制限してリスクを管理できます。 このシナリオを有効にするのには、次の要件を次に示します。  
  
-   AD FS は、Windows 8.1 および iOS \ + デバイスのワークプ レース ジョインをサポートしています  
  
-   ワークプ レース ジョインの機能を使用するには、Windows Server 2012 R2 に参加している AD FS サーバーのフォレストのスキーマにあります。  
  
-   AD FS サービスの SSL 証明書のサブジェクト代替名には、組織、enterpriseregistration.corp.contoso.com などのユーザー プリンシパル名 \(UPN\) サフィックスに続く値 enterpriseregistration を含める必要があります。  
  
## <a name="BKMK_12"></a>暗号化の要件  
次の表は、AD FS トークンの署名、トークン encryption\/暗号化解除機能の追加の暗号化のサポート情報を示します。  
  
||||  
|-|-|-|  
|**アルゴリズム**|**キーの長さ**|**Protocols\/applications \/コメント**|  
|TripleDES – 既定 192 \ (サポートされている 192 – 256\) \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#tripledes\-cbc](http://www.w3.org/2001/04/xmlenc)|>\= 192|セキュリティ トークンを暗号化するためのサポートされているアルゴリズムです。|  
|AES128 \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes128\-cbc|128|セキュリティ トークンを暗号化するためのサポートされているアルゴリズムです。|  
|AES192 \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes192\-cbc|192|セキュリティ トークンを暗号化するためのサポートされているアルゴリズムです。|  
|AES256 \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes256\-cbc](http://www.w3.org/2001/04/xmlenc)|256|**既定の**します。 セキュリティ トークンを暗号化するためのサポートされているアルゴリズムです。|  
|TripleDESKeyWrap \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-tripledes|.NET 4.0\+ でサポートされるすべてのキー サイズ|セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートします。|  
|AES128KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes128](http://www.w3.org/2001/04/xmlenc)|128|セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートしました。|  
|AES192KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes192](http://www.w3.org/2001/04/xmlenc)|192|セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートしました。|  
|AES256KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes256](http://www.w3.org/2001/04/xmlenc)|256|セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートしました。|  
|RsaV15KeyWrap \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#rsa\-1\_5|1024|セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートしました。|  
|RsaOaepKeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#rsa\-oaep\-mgf1p](http://www.w3.org/2001/04/xmlenc)|1024|既定値です。 セキュリティ トークンを暗号化する対称キーを暗号化するためのアルゴリズムをサポートしました。|  
|SHA1\ http:///\/www.w3.org \/PICS\/DSig\/SHA1\_1\_0.html|N\/A|アーティファクト SourceId 世代で AD FS サーバーによって使用: このシナリオでは、STS は SHA1 \ (ごとに SAML 2.0 standard\ の推奨事項) アーティファクト sourceiD の短い 160 ビット値を作成します。<br /><br />Ad FS web エージェントによっても使用 \ (WS2003 timeframe\ からレガシ コンポーネント)「最終更新日」の時間内の変更を識別する値の STS から情報を更新するタイミングを認識するようです。|  
|SHA1withRSA\-<br /><br />http:///\/ www.w3.org \/PICS\/DSig\/RSA\-SHA1\_1\_0.html|N\/A|使用される場合は AD FS サーバー SAML AuthenticationRequest の署名を検証するときに、アーティファクト解決要求または応答の署名、token\ 署名証明書を作成します。<br /><br />このような場合は、SHA256 が既定値、および SHA1 のみ使用される場合パートナー \(relying party\) SHA256 をサポートすることはできませんし、SHA1 の使用する必要があります。|  
  
## <a name="BKMK_13"></a>アクセス許可の要件  
インストールと AD FS の初期構成を実行する管理者には、ローカル ドメインのドメイン管理者のアクセス許可が必要です \ (つまりに、フェデレーション サーバーが参加しているドメインです \)。  
  
## <a name="see-also"></a>参照してください。  
[Windows Server 2012 R2 で AD FS 設計ガイドします。](AD-FS-Design-Guide-in-Windows-Server-2012-R2.md)  
  

