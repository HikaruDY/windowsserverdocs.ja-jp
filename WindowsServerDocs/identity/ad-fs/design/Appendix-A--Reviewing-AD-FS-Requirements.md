---
ms.assetid: 39ecc468-77c5-4938-827e-48ce498a25ad
title: 付録 A - AD FS の要件の確認
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 5e90df713f08dd387a2438b34839d16efe6e470f
ms.sourcegitcommit: 0b5fd4dc4148b92480db04e4dc22e139dcff8582
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/24/2019
ms.locfileid: "66191692"
---
# <a name="appendix-a-reviewing-ad-fs-requirements"></a>付録 A:AD FS 要件の確認

Active Directory フェデレーション サービス (AD FS) 配置内で組織パートナーが正常に共同作業できる、ようにする必要があります最初に確認する、企業ネットワーク インフラストラクチャが構成されているアカウントの AD FS の要件をサポートする名前を付ける解像度、および証明書。 AD FS では、次の種類の要件があります。  
  
> [!TIP]  
> その他の AD FS リソース リンクについては、Microsoft TechNet Wiki の「 [AD FS コンテンツ マップ](https://social.technet.microsoft.com/wiki/contents/articles/2735.aspx) 」をご覧ください。 このページは、AD FS コミュニティのメンバーによって管理されており、AD FS 製品チームによって定期的にチェックされています。  
  
## <a name="hardware-requirements"></a>ハードウェア要件  
次の最小および推奨ハードウェア要件は、フェデレーション サーバーとフェデレーション サーバー プロキシ コンピューターに適用されます。  
  
|ハードウェア要件|最小要件|推奨要件|  
|------------------------|-----------------------|---------------------------|  
|CPU 速度|シングルコア、1 GHz|クアッドコア、2 GHz|  
|RAM|1 GB|4 GB|  
|ディスク領域|50 MB|100 MB|  
  
## <a name="software-requirements"></a>ソフトウェア要件  
AD FS、Windows Server® 2012 オペレーティング システムに組み込まれているサーバー機能に依存します。  
  
> [!NOTE]  
> "フェデレーション サービス" と "フェデレーション サービス プロキシ" の 2 つの役割サービスを同じコンピューター上に共存させることはできません。  
  
## <a name="certificate-requirements"></a>証明書の要件  
証明書は、フェデレーション サーバー、フェデレーション サーバー プロキシ、要求に対応するアプリケーション、および Web クライアントの間の通信のセキュリティを確保するうえで最も重要な役割を果たします。 証明書に関する要件は、このセクションで説明するように、フェデレーション サーバーとフェデレーション サーバー プロキシのどちらのコンピューターをセットアップするかによって異なります。  
  
### <a name="federation-server-certificates"></a>フェデレーション サーバーの証明書  
フェデレーション サーバーには、次の表に示す証明書が必要です。  
  
|証明書の種類|説明|展開前の注意事項|  
|--------------------|---------------|------------------------------------------|  
|Secure Sockets Layer (SSL) 証明書|これは標準の Secure Sockets Layer (SSL) 証明書であり、フェデレーション サーバーとクライアントの間の通信のセキュリティ確保に使用されます。|この証明書は、フェデレーション サーバーまたはフェデレーション サーバー プロキシのインターネット インフォメーション サービス (IIS) において "既定の Web サイト" にバインドされている必要があります。  フェデレーション サーバー プロキシの場合は、このバインドを IIS で構成してからでなければ、フェデレーション サーバー プロキシ構成ウィザードを正常に実行することはできません。<br /><br />**推奨事項:** この証明書は AD FS のクライアントによって信頼されていることが必要であるため、VeriSign などの公的 (第三者) 証明機関 (CA) 発行のサーバー認証証明書を使用してください。 **クォータを調整する**この証明書のサブジェクト名は、展開される AD FS のインスタンスそれぞれのフェデレーション サービス名を表すのに使用されます。 このような理由から、CA 発行の新しい証明書のサブジェクト名は、パートナーに対して自社または自組織の名前を最も良く表すものを選ぶことをお勧めします。|  
|サービス通信証明書|この証明書は、フェデレーション サーバー間の通信のセキュリティを確保するための WCF メッセージ セキュリティに必要です。|既定の設定では、SSL 証明書がサービス通信証明書として使用されます。  これは、AD FS 管理コンソールで変更できます。|  
|トークン署名証明書|これは標準の X509 証明書であり、フェデレーション サーバーが発行するすべてのトークンについて署名のセキュリティを確保するために使用されます。|トークン署名証明書には秘密キーが格納されている必要があります。また、フェデレーション サービスにおいて信頼されたルートまでチェーンでつながっている必要があります。 既定の設定では、AD FS によって自己署名証明書が作成されます。 必要であれば、これを後で CA 発行の証明書に変更できます。変更するには、AD FS 管理スナップインを使用します。|  
|トークン暗号化解除証明書|これは標準の SSL 証明書であり、パートナーのフェデレーション サーバーによって暗号化されたトークンの暗号化解除に使用されます。 これは、フェデレーション メタデータでも公開されています。|既定の設定では、AD FS によって自己署名証明書が作成されます。 必要であれば、これを後で CA 発行の証明書に変更できます。変更するには、AD FS 管理スナップインを使用します。|  
  
> [!CAUTION]  
> 証明書のうち、トークン署名やトークン暗号化解除に使用されるものは、フェデレーション サービスの安定性を左右します。 この目的で構成された証明書が 1 つでも消失したり、予期せず削除されたりするとサービスが中断されるおそれがあるため、この目的で構成された証明書は必ずバックアップしてください。  
  
フェデレーション サーバーで使用される証明書の詳細については、「[フェデレーション サーバーの証明書の要件](Certificate-Requirements-for-Federation-Servers.md)」をご覧ください。  
  
### <a name="federation-server-proxy-certificates"></a>フェデレーション サーバー プロキシの証明書  
フェデレーション サーバー プロキシには、次の表に示す証明書が必要です。  
  
|証明書の種類|説明|展開前の注意事項|  
|--------------------|---------------|------------------------------------------|  
|サーバー認証証明書|これは標準の Secure Sockets Layer (SSL) 証明書であり、フェデレーション サーバー プロキシとインターネット クライアント コンピューターの間の通信のセキュリティを確保するために使用されます。|この証明書は、インターネット インフォメーション サービス (IIS) において "既定の Web サイト" にバインドされている必要があります。このとおりでない場合は、AD FS フェデレーション サーバー プロキシ構成ウィザードを正常に実行することはできません。<br /><br />**推奨事項:** この証明書は AD FS のクライアントによって信頼されていることが必要であるため、VeriSign などの公的 (第三者) 証明機関 (CA) 発行のサーバー認証証明書を使用してください。<br /><br />**クォータを調整する**この証明書のサブジェクト名は、展開される AD FS のインスタンスそれぞれのフェデレーション サービス名を表すのに使用されます。 このような理由から、サブジェクト名は、パートナーに対して自社または自組織の名前を最も良く表すものを選ぶことをお勧めします。|  
  
フェデレーション サーバー プロキシで使用される証明書の詳細については、「[フェデレーション サーバー プロキシの証明書の要件](Certificate-Requirements-for-Federation-Server-Proxies.md)」をご覧ください。  
  
## <a name="browser-requirements"></a>ブラウザーの要件  
JavaScript 対応の現行の Web ブラウザーはどれでも、AD FS クライアントとして動作させることができますが、既定で用意される Web ページのテストが完了しているのは Windows 上の Internet Explorer バージョン 7.0、8.0、9.0、Mozilla Firefox 3.0、および Safari 3.1 のみです。 JavaScript が有効化されている必要があり、ブラウザー ベースのサインインとサインアウトを正しく動作させるために Cookie が有効化されている必要があります。  
  
Microsoft の AD FS 製品チームでは、次の表にブラウザーとオペレーティング システムの構成が正常にテストします。  
  
|ブラウザー|Windows 7|Windows Vista|  
|-----------|-------------|-----------------|  
|Internet Explorer 7.0|x|x|  
|Internet Explorer 8.0|x|x|  
|Internet Explorer 9.0|x|テストせず|  
|FireFox 3.0|x|x|  
|Safari 3.1|x|x|  
  
> [!NOTE]  
> AD FS では、上の表に示したすべてのブラウザーについて、32 ビットと 64 ビットの両方のバージョンがサポートされます。  
  
### <a name="cookies"></a>Cookie  
AD FS によって作成されるセッションベースや永続的な Cookie がクライアント コンピューター上に保存される必要があります。これは、サインイン、サインアウト、シングル サインオンなどの機能を実現するためです。 したがって、クライアント ブラウザーは Cookie を受け入れるように設定されている必要があります。 認証に使用される Cookie はすべて HTTPS (Hypertext Transfer Protocol Secure) セッション Cookie であり、発信元サーバーごとに書き出されます。 クライアント ブラウザーがこの Cookie を受け入れるように設定されていない場合は、AD FS が正しく動作することができません。 永続的 Cookie は、ユーザーが選択したクレーム プロバイダーを記憶するために使用されます。 これを無効にするには、AD FS サインイン ページの構成ファイルにある構成設定を使用します。  
  
セキュリティ上の理由から、TLS/SSL のサポートが必要です。  
  
## <a name="network-requirements"></a>ネットワーク要件  
次のネットワーク サービスを適切に構成することは、組織で AD FS の展開を成功させるため重要です。  
  
### <a name="tcpip-network-connectivity"></a>TCP/IP ネットワーク接続  
クライアントの間で AD fs が機能する、TCP/IP ネットワーク接続が存在する必要があります。ドメイン コント ローラーです。コンピューターと、フェデレーション サービス、フェデレーション サービス プロキシ (使用している) 場合、AD FS Web エージェントをホストするコンピューター。  
  
### <a name="dns"></a>DNS  
Active Directory Domain Services (AD DS) 以外の AD FS の操作に不可欠なプライマリ ネットワーク サービスは、ドメイン ネーム システム (DNS) です。 DNS が展開されているときは、ユーザーは覚えやすいフレンドリ コンピューター名を使用して IP ネットワーク上のコンピューターなどのリソースに接続することができます。  
  
 Windows Server 2008 では、Windows NT 4.0 ベースのネットワークで使用されていた Windows インターネット ネーム サービス (WINS) NetBIOS 名前解決ではなく名前解決に DNS を使用します。 アプリケーションで必要とされている場合は、WINS を引き続き使用できます。 ただし、AD DS および AD FS には、DNS 名前解決が必要です。  
  
AD FS をサポートするために DNS を構成するプロセスは、かどうかによって異なります。  
  
-   組織の DNS インフラストラクチャが既に存在する。 ほとんどのシナリオでは、DNS は組織のネットワーク全体で構成済みです。これは、企業ネットワーク内の Web ブラウザー クライアントがインターネットにアクセスできるようにするためです。 インターネット アクセスと名前解決は AD FS の要件であるため、このインフラストラクチャは、AD FS の展開を配置すると見なされます。  
  
-   フェデレーション サーバーを企業ネットワークに追加する予定がある。 企業ネットワーク内でユーザー認証を行うには、フェデレーション サービスを実行する内部サーバーの CNAME を返すように企業ネットワーク フォレスト内の内部 DNS サーバーが構成されている必要があります。 詳細については、「[フェデレーション サーバーの名前解決の要件](Name-Resolution-Requirements-for-Federation-Servers.md)」をご覧ください。  
  
-   フェデレーション サーバー プロキシを境界ネットワークに追加する予定がある。 アイデンティティ パートナー組織の企業ネットワーク内にあるユーザー アカウントを認証する場合は、内部のフェデレーション サーバー プロキシの CNAME を返す企業ネットワーク フォレスト内の内部 DNS サーバーを構成する必要があります。 フェデレーション サーバー プロキシの追加に対応するために DNS を構成する方法については、次を参照してください。[フェデレーション サーバー プロキシの名前解決要件](Name-Resolution-Requirements-for-Federation-Server-Proxies.md)します。  
  
-   テスト ラボ環境用に DNS をセットアップしようとしている。 単一のルート DNS サーバーが権限のあるテストのラボ環境で AD FS を使用する場合は、2 つまたは複数のフォレスト間で名前のクエリが適切に転送できるように、DNS フォワーダーを設定する必要がある可能性の高いなります。 AD FS テスト ラボ環境を設定する方法については、次を参照してください。 [AD FS ステップ バイ ステップとハウツー ガイド](https://go.microsoft.com/fwlink/?LinkId=180357)します。  
  
## <a name="attribute-store-requirements"></a>属性ストアの要件  
AD FS には、ユーザーを認証し、そのユーザーのセキュリティ要求を抽出するために少なくとも 1 つの属性ストアが必要です。 AD FS でサポートされる属性ストアの一覧については、AD FS 設計ガイドの「 [The Role of Attribute Stores](../../ad-fs/technical-reference/The-Role-of-Attribute-Stores.md) 」を参照してください。  
  
> [!NOTE]  
> AD FS の既定の設定では、Active Directory 属性ストアが自動的に作成されます。  
  
属性ストアの要件は、自組織の役割がアカウント パートナー (フェデレーション ユーザーをホストする) であるかリソース パートナー (フェデレーション アプリケーションをホストする) であるかによって異なります。  
  
### <a name="adds"></a>AD DS  
正常に機能する AD fs、Windows Server 2003 SP1、Windows Server 2003 R2、Windows Server 2008、または Windows Server 2012、アカウント パートナー組織とリソース パートナー組織のいずれかのドメイン コント ローラーを実行する必要があります。  
  
AD FS がインストールされて構成されているコンピューターがドメインに参加している場合は、そのドメインの Active Directory ユーザー アカウント ストアが属性ストアとして選択可能になります。  
  
> [!IMPORTANT]  
> AD FS には、インターネット インフォメーション サービス (IIS) のインストールが必要であるために、セキュリティのため、運用環境でドメイン コント ローラーではない、AD FS ソフトウェアをインストールすることをお勧めします。 ただし、Microsoft カスタマー サービス サポートはこの構成もサポートします。  
  
#### <a name="schema-requirements"></a>スキーマの要件  
AD FS は、スキーマの変更や AD ds の機能レベルの変更は必要ありません。  
  
#### <a name="functional-level-requirements"></a>機能レベルの要件  
AD FS の機能のほとんどは、AD DS の機能レベルを変更しなくても正常に動作します。 ただし、クライアント証明書認証の証明書が明示的に AD DS 内のユーザー アカウントにマッピングされている場合に認証を正しく動作させるには、ドメイン機能レベルが Windows Server 2008 以上であることが必要です。  
  
#### <a name="service-account-requirements"></a>サービス アカウントの要件  
フェデレーション サーバー ファームを作成する場合は、最初に、AD DS 内にフェデレーション サービス専用のドメインベース サービス アカウントを作成する必要があります。 後で、このアカウントを使用するようにファーム内の各フェデレーション サーバーを構成します。 この方法の詳細については、AD FS 展開ガイドの「[フェデレーション サーバー ファームのサービス アカウントを手動で構成する](../../ad-fs/deployment/Manually-Configure-a-Service-Account-for-a-Federation-Server-Farm.md)」をご覧ください。  
  
### <a name="ldap"></a>LDAP  
LDAP (ライトウェイト ディレクトリ アクセス プロトコル) をベースとするその他の属性ストアを使用するときは、Windows 統合認証をサポートしている LDAP サーバーに接続する必要があります。 LDAP 接続文字列は、RFC 2255 での説明に従い、LDAP URL の形式で記述されている必要があります。  
  
### <a name="sql-server"></a>SQL Server  
AD FS が正常に機能するには、Microsoft SQL Server 2005 または SQL Server 2008 のいずれかに構造化照会言語 (SQL) Server 属性ストアをホストするコンピューターを実行する必要があります。 SQL ベースの属性ストアを使用するときは、接続文字列も構成する必要があります。  
  
### <a name="custom-attribute-stores"></a>カスタム属性ストア  
複雑なシナリオを実現するために、独自の属性ストアを開発することができます。 AD FS 内蔵のポリシー言語からカスタム属性ストアを参照できるので、次に示すようなシナリオの拡張が可能になります。  
  
-   ローカルで認証されるユーザーのクレームを作成する  
  
-   外部で認証されるユーザーのクレームを補足する  
  
-   トークンを取得することをユーザーに許可する  
  
-   ユーザーの行動に基づいてトークンを取得することをサービスに許可する  
  
カスタム属性ストアを使用するときは、接続文字列を構成することも必要になる可能性があります。 このような場合は、カスタム属性ストアへの接続を可能にするような、任意のカスタム コードを使用できます。 この場合の接続文字列は、一連の名前/値ペアであり、この文字列をどのように解釈するかはカスタム属性ストアの開発者が実装します。  
  
開発と、カスタム属性ストアを使用する方法の詳細については、次を参照してください。[属性ストアの概要](https://go.microsoft.com/fwlink/?LinkId=190782)します。  
  
## <a name="application-requirements"></a>アプリケーションの要件  
フェデレーション サーバーは、フェデレーション アプリケーションと通信してそのアプリケーションを保護することができます。フェデレーション アプリケーションの例としては、要求に対応するアプリケーションがあります。  
  
## <a name="authentication-requirements"></a>認証の要件  
Kerberos 認証、NTLM、スマート カード、および X.509 v3 クライアント側の証明書、AD FS はたとえば、自然なは、既存の Windows 認証と統合します。 フェデレーション サーバーは、標準の Kerberos 認証を使用して、ドメインに対するユーザーの認証を行います。 クライアントの認証に使用できるものとしては、フォームベースの認証、スマート カード認証、Windows 統合認証があり、認証をどのように構成するかによって決まります。  
  
AD FS フェデレーション サーバー プロキシという役割を利用すると、SSL クライアント認証を使用してユーザーを外部で認証するというシナリオが可能になります。 フェデレーション サーバーの役割を構成するときに SSL クライアント認証を必須とするよう指定することもできますが、一般的には、Windows 統合認証を使用するようにアカウント フェデレーション サーバーを構成すると最もシームレスなユーザー エクスペリエンスが実現します。 この場合は、ユーザーが Windows デスクトップ ログオンにどのような資格情報を使用するかを AD FS が制御することはできません。  
  
### <a name="smart-card-logon"></a>スマート カード ログオン  
AD FS は、認証 (パスワード、SSL クライアント認証、または Windows 統合認証) に使用される資格情報の種類を強制できますが、直接は強制されませんスマート カードによる認証。 したがって、AD FS では、スマート カードの個人識別番号 (PIN) 資格情報を取得するクライアント側ユーザー インターフェイス (UI) が提供はありません。 これは、Windows ベースのクライアントは意図的にフェデレーション サーバーまたは Web サーバーにユーザー資格情報の詳細を提供しないためにです。  
  
### <a name="smart-card-authentication"></a>スマート カード認証  
スマート カード認証では、アカウント フェデレーション サーバーへの認証に Kerberos プロトコルを使用します。 AD FS は、新しい認証方法を追加する拡張できません。 スマート カードの中の証明書は、クライアント コンピューター上の信頼されたルートまでチェーンでつながっていなくてもかまいません。 AD FS を使用したスマート カード ベースの証明書の使用には、次の条件が必要です。  
  
-   ブラウザーが存在するコンピューター上でスマート カードのリーダーと暗号化サービス プロバイダー (CSP) が動作する必要があります。  
  
-   スマート カード証明書は、アカウント フェデレーション サーバーと、アカウント フェデレーション サーバー プロキシの信頼されたルートまでチェーンする必要があります。  
  
-   証明書は、AD DS 内のユーザー アカウントに、次のいずれかの方法でマッピングされている必要があります。  
  
    -   証明書サブジェクト名が、AD DS 内のユーザー アカウントの LDAP 識別名に対応している。  
  
    -   証明書のサブジェクト別名拡張領域の中に、AD DS 内のユーザー アカウントのユーザー プリンシパル名 (UPN) がある。  
  
特定の認証強度が求められるシナリオをサポートするために、ユーザーがどのように認証されたかを示すクレームを作成するように AD FS を構成することも可能です。 証明書利用者は、このクレームを使用して権限付与に関する決定を行うことができます。  
  
## <a name="see-also"></a>関連項目
[Windows Server 2012 での AD FS 設計ガイド](AD-FS-Design-Guide-in-Windows-Server-2012.md)
