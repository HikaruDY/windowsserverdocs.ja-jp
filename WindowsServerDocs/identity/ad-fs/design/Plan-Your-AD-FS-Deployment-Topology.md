---
ms.assetid: 5c8c6cc0-0d22-4f27-a111-0aa90db7d6c8
title: "AD FS 展開トポロジを計画します。"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 7e41f7728c42912ec6ce680e1ed0c6a906a33392
ms.sourcegitcommit: 70c1b6cedad55b9c7d2068c9aa4891c6c533ee4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/03/2017
---
# <a name="plan-your-ad-fs-deployment-topology"></a>AD FS 展開トポロジを計画します。

>適用対象: Windows Server 2016、Windows Server 2012 R2

Active Directory フェデレーション サービス \(AD FS\) の展開の計画の最初の手順では、組織のニーズに対応する正しい展開トポロジを決定します。  
  
このトピックを読む前に、AD FS データは保存され、フェデレーション サーバー ファームの他のフェデレーション サーバーにレプリケートされる方法を確認しの目的とすることができます、AD FS 構成データベースに格納されている基になるデータのレプリケーションの方法を理解していることを確認します。  
  
AD FS 構成データの格納に使用できる 2 つのデータベース種類があります。Windows Internal Database \(WID\) と Microsoft SQL Server。 詳細については、次を参照してください。[AD FS 構成データベースの役割](../../ad-fs/technical-reference/The-Role-of-the-AD-FS-Configuration-Database.md)します。 さまざまな利点と、さまざまなアプリケーションのシナリオをサポートし、クリックすると、AD FS 構成データベースとして WID または SQL Server のいずれかを使用して関連付けられている制限事項を確認します。  
  
> [!IMPORTANT]  
> 基本的な冗長性、負荷分散、およびフェデレーション サービス \(if required\) をスケーリングするオプションを実装するにを使用するデータベースの種類に関係なく、すべての運用環境でフェデレーション サーバー ファームごとに少なくとも 2 つのフェデレーション サーバーを展開することをお勧めします。  
  
## <a name="determining-which-type-of-ad-fs-configuration-database-to-use"></a>使用する AD FS 構成データベースの種類の決定  
AD FS 構成を保存するデータベースを使用して: 場合によっては — トランザクション データは、フェデレーション サービスに関連します。 AD FS ソフトウェアを使用すると、組み込みの Windows Internal Database \(WID\) または Microsoft SQL Server 2008 以降では、フェデレーション サービス データを格納するのに] を選択します。  
  
ほとんどの場合、2 つのデータベース タイプはほぼ等価です。 ただし、これには注意すべきの詳細については、AD FS で使用できるさまざまな展開トポロジの検討を始める前にいくつかの違いがあります。 次の表では、WID データベースと SQL Server データベースの間でサポートされる機能の相違点について説明します。  
  
||機能|WID でのサポート|SQL Server でサポートされているか。
| --- | --- | --- |--- |
|AD FS 機能|フェデレーション サーバー ファーム展開|うん。 WID ファームは 30 台のフェデレーション サーバーの制限が 100 台以下証明書利用者信頼がある場合。</br></br>WID ファームはトークン リプレイ検出またはアーティファクト解決 (Security Assertion Markup Language (SAML) プロトコルの一部) をサポートしていません。 |うん。 1 つのファームに展開するフェデレーション サーバーの数の制限はありません。  
|AD FS 機能|SAML アーティファクト解決 </br></br>**注:**この機能は Microsoft Online Services、Microsoft Office 365、Microsoft Exchange、または Microsoft Office SharePoint のシナリオに必要なできません。|違います|うん  
|AD FS 機能|フェデレーション WS\ SAML\/トークン リプレイ検出|違います|うん  
|データベースの機能|プル レプリケーションを移行元サーバーで行われた変更をデータベースで要求の読み取り専用のコピーをホストしている 1 つまたは複数のサーバーをホストするデータベースの読み取り/書き込みコピーを使用して基本的なデータベース冗長化|うん|違います 
|データベースの機能|フェールオーバー クラスタ リングやミラーリングなどの高可用性ソリューションを使用するデータベース冗長化 \ (データベース層 only\) で**注:**すべての AD FS 展開トポロジは、AD FS サービス層でのクラスタ リングをサポートします。|違います|うん  

  
## <a name="sql-server-considerations"></a>SQL Server に関する考慮事項  
AD FS 展開の構成データベースとして SQL Server を選択した場合、次の事項を検討してください。  
  
-   **SAML の機能とデータベースのサイズと増大に及ぼす影響**します。 SAML アーティファクト解決や SAML トークン リプレイ検出の機能のいずれかが有効な場合、AD FS は、発行される AD FS トークンそれぞれの SQL Server 構成データベースの情報を格納します。 このアクティビティの結果として SQL Server データベースの拡張は重要であるとは見なされませんし、構成済みのトークン リプレイ保持期間に依存します。 各アーティファクト レコードは、約 30 キロバイト \(KB\) のサイズを持っています。  
  
-   **展開に必要なサーバー数**します。 少なくとも 1 つの追加サーバーを追加する必要があります \ (、AD FS infrastructure\ を展開するのに必要なサーバーの合計数) を SQL Server インスタンス専用のホストとして機能することです。 フェールオーバー クラスタ リングやミラーリングを使用して SQL Server 構成データベースのフォールト トレランスとスケーラビリティを提供する場合は、次の 2 つの SQL サーバーの最小値が必要です。  
  
## <a name="how-the-configuration-database-type-you-select-may-impact-hardware-resources"></a>構成データベースのタイプを選択する方法がハードウェア リソースに影響を与える  
SQL Server データベースを使用してファームに展開されているフェデレーション サーバーではなく、WID を使用してファームに展開されているフェデレーション サーバー上のハードウェア リソースへの影響は大きな違いはありません。 ただし、重要なこと、ファームで WID を使用するときにそのファーム内の各フェデレーション サーバー必要がありますを保存、管理、およびも継続するフェデレーション サービスに必要な通常の操作中に、AD FS 構成データベースのローカル コピーのレプリケーションの変更を維持考慮事項です。  
  
比較では、SQL Server データベースを使用しているファームに展開されているフェデレーション サーバーには必ずしもが含まれていない、AD FS 構成データベースのローカル インスタンスには。 そのため、ハードウェア リソースの量はかなり少なくをなる可能性があります。  
  
## <a name="BKMK_1"></a>フェデレーション サーバーを配置する場所  
セキュリティのベスト プラクティス、ファイアウォールの前に AD FS フェデレーション サーバーを配置およびをインターネットからの不正アクセスを防ぐために、企業ネットワークに接続します。 これは、機能は、フェデレーション サーバーがあるフル承認をセキュリティ トークンを付与するために重要です。 そのため、ドメイン コントローラーと同様に保護があります。 フェデレーション サーバーが侵害された場合、悪意のあるユーザーは、すべての Web アプリケーションに、AD FS によって保護されているフェデレーション サーバーに完全なアクセス トークンを発行する権限を持ちます。  
  
> [!NOTE]  
> セキュリティ ベスト プラクティスとして、インターネット上で、フェデレーション サーバーを直接アクセスを必要があります。 テスト ラボ環境をまたは、組織が境界ネットワークにないときに設定している場合にのみ、フェデレーション サーバーにインターネットに直接アクセスを与えることを検討してください。  
  
典型的な企業ネットワークでは、企業ネットワークと、境界ネットワークの間、intranet\ 接続されたファイアウォールが確立されているしとは限らない接続されたファイアウォールを境界ネットワークとインターネットの間に設けます。 このような状況では、フェデレーション サーバーは、企業ネットワーク内に配置しはインターネット クライアントから直接アクセスします。  
  
> [!NOTE]  
> 企業ネットワークに接続されているクライアント コンピューターは、Windows 統合認証を通じて、フェデレーション サーバーと直接通信できます。  
  
フェデレーション サーバー プロキシは、AD FS と共に使用するためのファイアウォール サーバーを構成する前に、境界ネットワークに配置する必要があります。  
  
## <a name="supported-deployment-topologies"></a>サポートされている展開トポロジ  
次のトピックでは、AD FS で使用できるさまざまな展開トポロジについて説明します。 利点と、特定のビジネス ニーズに最も適切なトポロジを選択できるように、各展開トポロジに関連付けられている制限事項についても説明します。  
  
-   [フェデレーション サーバー ファームが WID を使用します。](Federation-Server-Farm-Using-WID.md)  
  
-   [WID とプロキシを使用してフェデレーション サーバー ファーム](Federation-Server-Farm-Using-WID-and-Proxies.md)  
  
-   [SQL Server を使用してフェデレーション サーバー ファーム](Federation-Server-Farm-Using-SQL-Server.md)  
  
## <a name="see-also"></a>参照してください。  
[Windows Server 2012 R2 で AD FS 設計ガイドします。](AD-FS-Design-Guide-in-Windows-Server-2012-R2.md)  
  

