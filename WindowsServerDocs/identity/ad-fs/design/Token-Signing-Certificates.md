---
ms.assetid: 98c5ef45-2bcb-4f87-86c8-5ac6c16a6097
title: "トークン署名証明書"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 84e106ec87861960d7de651b4aaa0e88c952aa79
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2017
---
# <a name="token-signing-certificates"></a>トークン署名証明書

>適用対象: Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

フェデレーション サーバーでは、攻撃者が改ざんまたはフェデレーション リソースに不正にアクセスしようとすると、セキュリティ トークンを偽造するを防ぐために token\ 署名証明書が必要です。 ペアリングされている private\/パブリック キーは、これらのキーは、セキュリティ トークンが有効なパートナーのフェデレーション サーバーによって発行されたことと、転送中に、トークンが変更されていないことを確認するために、フェデレーション パートナーシップの最も重要な検証機構は token\ 署名証明書と共に使用です。  
  
## <a name="token-signing-certificate-requirements"></a>Token\ 署名証明書の要件  
Token\ 署名証明書は、AD FS を使用する、次の要件を満たしている必要があります。  
  
-   Token\ 署名証明書が正常にセキュリティ トークンに署名する、token\ 署名証明書は秘密キーを含める必要があります。  
  
-   AD FS サービス アカウント、ローカル コンピューターの個人用ストアに token\ 署名証明書の秘密キーへのアクセスが必要です。 これは、処理のセットアップでします。 また、後に、token\ 署名証明書を変更した場合、このアクセスを確保するのにの AD FS 管理スナップインを使用することができます。  
  
> [!NOTE]  
> これは、複数の目的で秘密キーを共有しないように、公開キー基盤 \(PKI\) のベスト プラクティスです。 したがって、token\ 署名証明書としてフェデレーション サーバーにインストールされているサービス通信証明書を使用しないでください。  
  
## <a name="how-token-signing-certificates-are-used-across-partners"></a>Token\ 署名証明書は、パートナー全体で使用される方法  
すべての token\ 署名証明書には秘密キーの暗号化とデジタル署名に使用される公開キーが含まれています \ (プライベート key \) を使用してセキュリティ トークン。 後で、パートナーのフェデレーション サーバーで受信した後、これらのキーは検証信頼性 \ (public key \) を使用して、暗号化されたセキュリティ トークンのします。  
  
各セキュリティ トークンは、アカウント パートナーによってデジタル署名されているため、リソース パートナーは、セキュリティ トークンがアカウント パートナーによって実際に発行されたことと、変更されていないことを確認できます。 パートナーの token\ が証明書の公開キー部分では、デジタル署名を検証します。 署名を検証した後、リソース フェデレーション サーバーは、組織の独自のセキュリティ トークンを生成し、token\ 署名証明書がそれぞれのセキュリティ トークンに署名します。  
  
フェデレーション パートナー環境では、token\ 署名証明書が CA によって発行された、ときにいることを確認します。  
  
1.  証明書の証明書失効リスト \(CRLs\) は、証明書利用者とフェデレーション サーバーを信頼している Web サーバーにアクセスできます。  
  
2.  ルート CA 証明書を信頼するには、証明書利用者とフェデレーション サーバーを信頼している Web サーバー。  
  
リソース パートナー内の Web サーバーは、token\ 署名証明書の公開キーを使用して、セキュリティ トークンが、リソース フェデレーション サーバーによって署名されていることを確認します。 Web サーバーには、クライアントに適切なアクセスが許可されます。  
  
## <a name="deployment-considerations-for-token-signing-certificates"></a>Token\ 署名証明書の展開に関する考慮事項  
新しい AD FS のインストールでは、最初のフェデレーション サーバーを展開するときに token\ 署名証明書を取得し、そのフェデレーション サーバーのローカル コンピューターの個人用証明書ストアにインストールする必要があります。 Token\ 署名を取得するエンタープライズからの要求元のいずれかで CA または公的 CA に証明書または自己署名証明書を作成します。  
  
AD FS ファームを展開するときに、サーバー ファームを作成する方法によって token\ 署名証明書が異なる方法でインストールします。  
  
展開に token\ 署名証明書を取得するときに検討できる 2 つのサーバー ファーム オプションがあります。  
  
-   1 つの token\ 署名証明書の秘密キーは、ファーム内のすべてのフェデレーション サーバー間で共有されます。  
  
    フェデレーション サーバー ファーム環境ですべてのフェデレーション サーバーが \(or reuse\) 同じ token\ 署名証明書を共有することをお勧めします。 フェデレーション サーバーでの CA から単一の token\ 署名証明書をインストールし、発行された証明書がエクスポート可能としてマークされている限り、秘密キーをエクスポートできます。  
  
    次の図に示すように、ファーム内のすべてのフェデレーション サーバーを単一の token\ 署名証明書の秘密キーを共有できます。 このオプション — 次「一意 token\ 署名の証明書」と比較してオプション — パブリック CA から token\ 署名証明書を取得する予定の場合は、コストを削減します。  
  
![トークン署名](media/adfs2_fedserver_certstory_3.gif)  
  
-   一意 token\ 署名証明書内の各フェデレーション サーバー ファームがあります。  
  
    複数を使用すると、そのファーム内の各サーバー ファーム全体で一意の証明書、独自の一意の秘密キーを持つトークンに署名します。  
  
    次の図に示すように、すべて 1 つのフェデレーション サーバー ファーム内の個別 token\ 署名証明書を取得できます。 このオプションは、パブリック CA から token\ 署名証明書を取得する予定の場合より高価なです。  
  
![トークン署名](media/adfs2_fedserver_certstory_4.gif)  
  
エンタープライズ CA として Microsoft Certificate Services を使用する場合は、証明書をインストールする方法については、次を参照してください。[IIS 7.0: IIS 7.0 でドメインのサーバー証明書を作成する](https://go.microsoft.com/fwlink/?LinkId=108548)します。  
  
パブリック CA から証明書をインストールする方法については、次を参照してください。[IIS 7.0: インターネット サーバー証明書を要求](https://go.microsoft.com/fwlink/?LinkId=108549)します。  
  
自己署名証明書をインストールする方法については、次を参照してください。[IIS 7.0: IIS 7.0 で Self\-Signed サーバー証明書を作成する](https://go.microsoft.com/fwlink/?LinkID=108271)します。  
  
## <a name="see-also"></a>参照してください。
[Windows Server 2012 で AD FS 設計ガイドします。](AD-FS-Design-Guide-in-Windows-Server-2012.md)
