---
title: イベントとユーザー プロファイルに関するトラブルシューティングします。
description: 読み込みに関する問題のトラブルシューティングを行う方法とイベントとトレース ログを使用してユーザー プロファイルをアンロードします。
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage
ms.date: 04/05/2018
ms.localizationpriority: medium
ms.openlocfilehash: f30bfcd531731e3a0d14350536ddf418c50f3ea0
ms.sourcegitcommit: ed27ddbe316d543b7865bc10590b238290a2a1ad
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/09/2019
ms.locfileid: "65475948"
---
# <a name="troubleshoot-user-profiles-with-events"></a>イベントとユーザー プロファイルに関するトラブルシューティングします。

>適用対象:Windows 10、Windows 8、Windows 8.1、Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、および Windows Server (半期チャネル)

このトピックでは、イベントとトレース ログを使用して読み込みに関する問題のトラブルシューティングを行う方法とアンロードのユーザー プロファイルについて説明します。 次のセクションでは、ユーザー プロファイル情報を記録する 3 つのイベント ログを使用する方法について説明します。

## <a name="step-1-checking-events-in-the-application-log"></a>手順 1:アプリケーション ログにイベントを確認します。

読み込みとアンロードの User Profile Service アプリケーションのレコードを記録する警告およびエラー イベントを確認するイベント ビューアーを使用するユーザー プロファイル (移動ユーザー プロファイルを含む) に関する問題のトラブルシューティングの最初の手順。

ユーザー プロファイル サービス イベント アプリケーション ログを表示する方法を次に示します。

1. イベント ビューアーを起動します。 これを行うには、開く**コントロール パネルの**を選択します**システムとセキュリティ**、、**管理ツール**セクションで、 **のイベントログを表示**. イベント ビューアー ウィンドウを開きます。
2. コンソール ツリーで、最初に移動します**Windows ログ**、し**アプリケーション**します。
3. [操作] ウィンドウで、次のように選択します。 **Filter Current Log**します。 現在のログをフィルターのダイアログ ボックスが開きます。
4. **イベント ソース**ボックスで、**ユーザー プロファイル サービス**チェック ボックスをオンし、 **OK**します。
5. エラー イベントに特に注意を払いますイベントの一覧を確認します。
6. 注目すべきイベントを検索するときに、追加情報とトラブルシューティングの手順を表示するイベント ログのオンライン ヘルプ リンクを選択します。
7. さらにトラブルシューティングを実行するには、注目すべきイベントの日時に注意してくださいし、操作ログ (手順 2. で説明されている) とエラーまたは警告イベントの前後に行っていたユーザー プロファイル サービスに関する詳細を表示します。

>[!NOTE]
>無視してかまいません User Profile Service イベント 1530「Windows 検出レジストリ ファイルは、他のアプリケーションやサービスで使用されている」

## <a name="step-2-view-the-operational-log-for-the-user-profile-service"></a>手順 2:ユーザー プロファイル サービスの操作ログを表示します。

だけで、アプリケーション ログを使用して問題を解決できない場合は、ユーザー プロファイル サービス イベント、操作ログを表示する、次の手順を使用します。 このログは、サービスの内部動作の一部を示していて、プロファイルの読み込みのどの場所の特定や問題が発生しているプロセスをアンロードできます。

すべての Windows インストールで既定では、Windows アプリケーション ログとユーザー プロファイル サービス操作のログの両方が有効にします。

ユーザー プロファイル サービスの操作のログを表示する方法を次に示します。

1. イベント ビューアーのコンソール ツリー **Applications and Services Logs**、し**Microsoft**、し**Windows**、し**User Profile Service**、し**運用**します。
2. アプリケーション ログでメモしたエラーまたは警告のイベントの前後に発生したイベントを確認します。

## <a name="step-3-enable-and-view-analytic-and-debug-logs"></a>手順 3:表示、分析とデバッグ ログを有効にします。

操作ログよりも詳細が必要な場合は、分析を有効にして、影響を受けるコンピューター上のログをデバッグします。 このレベルのログ記録ははるかに詳細なし、を除き、問題をトラブルシューティングするしようとしたときに無効にする必要があります。

表示、分析とデバッグ ログを有効にする方法を次に示します。

1. **アクション**のイベント ビューアーでは、選択ペイン**ビュー**、し、 **分析およびデバッグ ログ**します。
2. 移動します**Applications and Services Logs**、し**Microsoft**、し**Windows**、し**User Profile Service**、し**診断**します。
3. 選択**ログの有効化**選び**はい**。 これにより、診断のログは、ログ記録を開始できます。
4. さらに詳しい情報が必要な場合は、次を参照してください。[手順 4。作成して、トレースをデコード](#step-4-creating-and-decoding-a-trace)トレース ログを作成する方法の詳細について。
5. 移動し、問題のトラブルシューティングが完了したら、**診断**ログで、**ログの無効化**を選択します**ビュー**し、オフ、**を表示します。分析およびデバッグ ログ**分析を非表示にし、デバッグ ログのチェック ボックスをオンします。

## <a name="step-4-creating-and-decoding-a-trace"></a>手順 4:作成して、トレースをデコード

イベントを使用して問題を解決できない場合は、問題を再現しながらトレース ログ (ETL ファイル) を作成し、Microsoft シンボル サーバーからのパブリック シンボルを使用してこれをデコードします。 トレース ログは、User Profile Service でを行うことを通知し、障害が発生した場所の特定に役立つことができますに関する非常に特定の情報を提供します。

ETL トレースを使用する場合は、最適な方法では、まず考えられる最小のログをキャプチャします。 ログをデコードすると後、は、エラーのログを検索します。

作成し、ユーザー プロファイル サービスのトレースをデコードする方法を次に示します。

1. 場所、ユーザーは問題が発生して、ローカルの Administrators グループのメンバーであるアカウントを使用してコンピューターにサインオンします。
2. 管理者特権でコマンド プロンプトから次のコマンドを入力します。 ここ *\<パス\>* ローカル フォルダーに以前作成した例 c: パス\\ログ。
        
    ```PowerShell
    logman create trace -n RUP -o <Path>\RUP.etl -ets
    logman update RUP -p {eb7428f5-ab1f-4322-a4cc-1f1a9b2c5e98} 0x7FFFFFFF 0x7 -ets
    ```
3. スタート画面から、ユーザー名を選択し、**アカウントの切り替え**管理者は、ログオフしないように注意します。 リモート デスクトップを使用している場合は、ユーザー セッションを確立するために管理者セッションを閉じます。
4. 問題を再現します。 問題を再現する手順は、通常、ユーザーのサインオフ、問題が発生したユーザーまたはその両方としてサインオンします。
5. 問題を再現するには後ローカル管理者としてもう一度サインインします。
6. 管理者特権でコマンド プロンプトから ETL ファイルにログを保存するには、次のコマンドを実行します。
  
    ```PowerShell
    logman stop -n RUP -ets
    ```
7. 現在のディレクトリ内のユーザーが判読できるファイルに ETL ファイルをエクスポートする次のコマンドを入力 (ホーム フォルダーの場合、または、%windir%\\System32 フォルダー)。
    
    ```PowerShell
    Tracerpt <path>\RUP.etl
    ```
8. 開く、 **Summary.txt**ファイルと**Dumpfile.xml**ファイル (より簡単に、ログの完全な詳細を表示する Microsoft Excel で開くことができます)。 含むイベントを探して**失敗**または**失敗**; が含まれる行は無視してかまいません、**不明な**イベント名。

## <a name="more-information"></a>詳細情報

* [移動ユーザー プロファイルを展開する](deploy-roaming-user-profiles.md)