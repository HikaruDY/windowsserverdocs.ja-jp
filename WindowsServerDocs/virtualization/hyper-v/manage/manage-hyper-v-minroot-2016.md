---
title: Minroot
description: ホスト CPU リソースの制御を構成します。
keywords: Windows 10, Hyper-V
author: allenma
ms.date: 12/15/2017
ms.topic: article
ms.prod: windows-10-hyperv
ms.service: windows-10-hyperv
ms.assetid: ''
ms.openlocfilehash: e1269c11df32c8ce95cc7455d47d7170e9d0b1c8
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59844333"
---
# <a name="hyper-v-host-cpu-resource-management"></a>Hyper V ホスト CPU リソースの管理

HYPER-V ホストの CPU リソース制御は、Windows Server 2016 で導入されたか、後で、HYPER-V 管理者がより良く管理およびホスト サーバーの"root"、または管理のパーティションとゲスト Vm の間の CPU リソースを割り当てるを許可します。 これらのコントロールでは、管理者は、ルート パーティションにホスト システムのプロセッサのサブセットを割り当てることができます。 システム プロセッサの個別のサブセットに対して実行することによって、ゲスト仮想マシンで実行されているワークロードから HYPER-V ホストで実行された作業を分離このことができます。

HYPER-V ホストのハードウェアに関する詳細については、次を参照してください。 [Windows 10 Hyper-v のシステム要件](https://docs.microsoft.com/virtualization/hyper-v-on-windows/reference/hyper-v-requirements)します。

## <a name="background"></a>背景

HYPER-V の設定のコントロールは、CPU リソースをホストする前に、HYPER-V のアーキテクチャの基礎を確認することをお勧めします。  
一般的な概要を見つけることができます、 [HYPER-V アーキテクチャ](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/architecture)セクション。
この記事の重要な概念を次に示します。

* HYPER-V では、作成し、リソースの割り当てし、ハイパーバイザーの管理下にある、共有のどのコンピューティングの間で仮想マシンのパーティションを管理します。  パーティションは、ゲスト Vm と、ルート パーティション間のすべてのゲスト仮想マシン間で強固な分離境界を提供します。

* ルート パーティション自体が、仮想マシンのパーティションが固有のプロパティとゲスト仮想マシンよりも多くの大きい特権です。  ルート パーティションは、すべてのゲスト仮想マシンを制御する管理サービスを提供、ゲストの場合、仮想デバイスのサポートを提供し、ゲスト仮想マシン用のすべてのデバイス I/O を管理します。  Microsoft では、任意のアプリケーション ワークロードをホスト パーティションで実行されていない強くお勧めします。

* ルート パーティションの各仮想プロセッサ (VP) は、基になる論理プロセッサ (LP) にマップされた 1:1 です。  ホストの担当副社長は常に同じ基になる LP の実行 – ルート パーティションの Vp の移行はありません。  

* 既定では、ホスト Vp を実行する LPs はゲスト Vp も実行できます。

* ゲスト担当副社長は、使用可能な論理プロセッサ上で実行するハイパーバイザーによってスケジュールされる可能性があります。  ハイパーバイザー スケジューラ ゲスト担当副社長をスケジュールするときに一時的なキャッシュの局所性、NUMA のトポロジ、およびその他の多くの要因を考慮する、処理中に最終的に、担当副社長を任意のホスト LP スケジュールでした。

## <a name="the-minimum-root-or-minroot-configuration"></a>最小のルート、または"Minroot"の構成

以前のバージョンの HYPER-V では、パーティションあたり 64 Vp のアーキテクチャ上の最大制限がありました。  このルートとゲストの両方のパーティションに適用します。  64 を超える論理プロセッサを搭載したシステムは、ハイエンドのサーバーの状態、最大 320 LPs を持つホストをサポートしている 1 つの時点で、これらの大規模なシステムをサポートするために、ホストのスケール制限は、HYPER-V も進化しました。  ただし、互換性に影響する、64 および担当副社長ごとの時点でのパーティション制限課題がいくつか桁違いパーティションあたり 64 を超える Vp のサポートの複雑さを導入します。  これに対処するには、HYPER-V では、場合でも、基になるマシンがある使用可能な多くの論理プロセッサに Vp を 64、ルート パーティションの数が制限されます。  ハイパーバイザーはゲスト Vp を実行するためのすべての利用可能な LPs の利用になってしまいますが、64 にルート パーティションを人為的に上限します。  この構成は、「最小ルート」または"minroot"構成と呼ばれるようになりました。  パフォーマンス テストも 64 を超える LPs、大規模なシステムで、ルート必要はありませんでした実際には、ゲスト Vm とゲスト Vp – の数が多いための十分なサポートを提供する 64 を超えるルート Vp よりもかなり小さい 64 ルート Vp が適切な多くの場合、ことを確認で実行されている特定のワークロードなど、ゲスト Vm のサイズと数に応じてもちろんです。

この"minroot"の概念は、現在利用が続行されます。  実際には、Windows Server 2016 の HYPER-V ホスト LPs 512 LPs のアーキテクチャのサポートの最大の上限は増やすことも、ルート パーティションされます 320 LPs の最大数に制限されています。

## <a name="using-minroot-to-constrain-and-isolate-host-compute-resources"></a>Minroot を使用して制限し、ホストのコンピューティング リソースを分離します。
320 LPs で Windows Server 2016 HYPER-V の高の既定のしきい値は minroot 構成が非常に大規模のサーバー システムでのみ使用されます。  ただし、この機能を HYPER-V ホストの管理者を構成する量の下限しきい値とルート パーティションに使用できるホスト CPU リソースの量を大幅に制限するために利用します。  特定の数を利用するルート LPs は、Vm とホストに割り当てられているワークロードの最大の要求をサポートするために慎重に選択するもちろん必要があります。  ただし、について慎重に評価を決定し、運用環境のワークロードの監視と広範なデプロイの前に、運用環境で検証済みホスト LPs の数の妥当な値ができます。

## <a name="enabling-and-configuring-minroot"></a>有効化と Minroot の構成

Minroot 構成は、ハイパーバイザーの BCD エントリを使用して制御されます。 管理者特権でコマンド プロンプトからの minroot を有効にします。

```
    bcdedit /set hypervisorrootproc n
```
N は Vp のルートの数です。 

システムを再起動する必要があり、新しいルートのプロセッサ数は、OS ブートの有効期間にわたって保持されます。  Minroot 構成は、実行時に動的に変更することはできません。

複数の NUMA ノードがある場合は、各ノードの取得は`n/NumaNodeCount`プロセッサ。

対応する仮想マシンの NUMA ノード Vp を実行するには、各 NUMA ノードでは、複数の NUMA ノードにする必要があること、VM のトポロジは十分な空き LPs (つまり、ルート Vp LPs) が存在するように注意してください。

## <a name="verifying-the-minroot-configuration"></a>Minroot 構成を確認します。

次に示すように、タスク マネージャーを使用して、ホストの minroot 構成を確認できます。

![](./media/minroot-taskman.png)

Minroot がアクティブである場合、タスク マネージャーには、システム内の論理プロセッサの合計数だけでなく、ホストに現在割り当てられている論理プロセッサの数が表示されます。
 
