---
title: リモート デスクトップ サービス ロール
description: デスクトップ ホスティング サービスのコンポーネントについて説明します。
ms.prod: windows-server-threshold
ms.technology: remote-desktop-services
ms.author: helohr
ms.date: 07/06/2018
ms.topic: article
author: heidilohr
manager: dougkim
ms.openlocfilehash: 48efbffa4f82b707b63e33e6416da43eb105221f
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59844723"
---
# <a name="remote-desktop-services-roles"></a>リモート デスクトップ サービス ロール

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

この記事では、リモート デスクトップ サービス環境内での役割について説明します。

## <a name="remote-desktop-session-host"></a>リモート デスクトップ セッション ホスト

リモート デスクトップ セッション ホスト (RD セッション ホスト) は、セッション ベースのアプリとデスクトップのユーザーと共有するには保持します。 ユーザーは、これらのデスクトップと Windows、MacOS、iOS、および Android で実行されるリモート デスクトップ クライアントのいずれかでアプリを取得します。 ユーザーは、web クライアントを使用してもサポートされているブラウザーから接続できます。

「コレクションです」と呼ばれる 1 つまたは複数の RD セッション ホスト サーバーにデスクトップとアプリを整理することができます。 各テナント内のユーザーの特定のグループのこれらのコレクションをカスタマイズすることができます。 たとえば、コレクション、特定のユーザー グループが特定のアプリにアクセスできますが、それらのアプリにアクセスすることで、指定したグループ以外の人はできませんを作成できます。

小規模の展開には、RD セッション ホスト サーバーに直接アプリケーションをインストールできます。 大規模な展開は、基本イメージを構築し、そのイメージから仮想マシンをプロビジョニングお勧めします。

コレクションを展開するには、同じ可用性セットに割り当てられているコレクション内の各 RDSH 仮想マシンを含むコレクション ファームへの RD セッション ホスト サーバーの仮想マシンを追加します。 これは、コレクションの可用性が高いなり、以上のユーザーまたはリソースの量が多いアプリケーションをサポートするためにスケールできます。

ほとんどの場合は、複数のユーザーは、デスクトップ ホスティング ソリューションの Azure リソースを最も効率的に使用して、同じ RD セッション ホスト サーバーを共有します。 この構成で、ユーザーは管理者以外のアカウントを使用してコレクションにサインインする必要があります。 ユーザーに付与できますによって完全な管理者アクセス、リモート デスクトップを個人用セッション デスクトップのコレクションを作成します。

デスクトップの作成と新しい RD セッション ホストの仮想マシンを作成するためのテンプレートとして使用できる Windows Server OS を含むバーチャル ハード ディスクをアップロードして、さらにカスタマイズできます。

詳しくは、次の記事をご覧ください。

* [リモート デスクトップ サービスのセキュリティで保護されたデータ ストレージ](rds-plan-secure-data-storage.md)
* [一般化した VHD をアップロードし、それを使用して、Azure で新しい Vm を作成するには](https://docs.microsoft.com/azure/virtual-machines/windows/upload-generalized-managed?toc=%2Fazure%2Fvirtual-machines%2Fwindows%2Ftoc.json)
* [RDSH コレクションの更新 (ARM テンプレート)](https://azure.microsoft.com/resources/templates/rds-update-rdsh-collection/)

## <a name="remote-desktop-connection-broker"></a>リモート デスクトップ接続ブローカー

リモート デスクトップ接続ブローカー (RD 接続ブローカー) は、RD セッション ホスト サーバー ファームへの着信のリモート デスクトップ接続を管理します。 RD 接続ブローカーは、完全なデスクトップおよびリモート アプリのコレクションの両方のコレクションへの接続を処理します。 RD 接続ブローカーは、新しい接続を行うときに、コレクションのサーバー間で負荷を分散できます。 セッションが切断されると、RD 接続ブローカーは、ユーザーは、正しい RD セッション ホスト サーバーを RD セッション ホスト ファームにまだ存在する、中断されたセッションを再接続します。

RD 接続ブローカー サーバーとシングル サインオンとアプリケーションの発行をサポートするクライアントの両方でデジタル証明書に一致するをインストールする必要があります。 開発またはテストをネットワーク、ときに、自己生成および自己署名証明書を使用できます。 ただし、リリースされたサービスでは、信頼された証明機関からのデジタル証明書が必要です。 証明書に付ける名前は、として、内部完全修飾ドメイン名 (FQDN)、RD 接続ブローカーの仮想マシンの同じである必要があります。

Windows Server 2016 の RD 接続ブローカーは、コストを削減する AD DS と同じ仮想マシンにインストールできます。 多くのユーザーへのスケール アウトする必要がある場合、同じ可用性セット、RD 接続ブローカーのクラスターを作成するにも追加の RD 接続ブローカーの仮想マシンを追加できます。

RD 接続ブローカー クラスターを作成する前に、テナントの環境での Azure SQL Database のデプロイか、または SQL Server AlwaysOn 可用性グループを作成する必要があります。

詳しくは、次の記事をご覧ください。

* [展開に RD 接続ブローカー サーバーを追加し、高可用性構成](rds-connection-broker-cluster.md)
* [SQL データベース](desktop-hosting-service.md#sql-database)デスクトップ ホスティング サービスです。

## <a name="remote-desktop-gateway"></a>リモート デスクトップ ゲートウェイ

リモート デスクトップ ゲートウェイ (RD ゲートウェイ) は、Windows デスクトップおよび Microsoft Azure のクラウド サービスでホストされるアプリケーションへのパブリック ネットワーク上のユーザーを許可します。

RD ゲートウェイ コンポーネントでは、Secure Sockets Layer (SSL) を使用して、クライアントとサーバー間の通信チャネルを暗号化します。 RD ゲートウェイの仮想マシンは、ポート 443 への受信 TCP 接続とポート 3391 の受信 UDP 接続を許可するパブリック IP アドレスからアクセス可能である必要があります。 これにより、ユーザーは、HTTPS 通信トランスポート プロトコルと UDP プロトコルでは、それぞれ使用してインターネット経由で接続できます。

サーバーとクライアントにインストールされているデジタル証明書は、これを行うと一致する必要です。 開発またはテスト ネットワーク、する場合は、自己生成および自己署名証明書を使用できます。 ただし、リリースのサービスでは、信頼された証明機関から証明書が必要です。 証明書の名前は、FQDN がパブリック IP アドレスの外部に公開された DNS 名またはパブリック IP アドレスを指す CNAME DNS レコードであるかどうか、RD ゲートウェイにアクセスするために使用する FQDN と一致する必要があります。

少数のユーザーとテナントは、コストを削減する 1 つの仮想マシン上、RD Web アクセスおよび RD ゲートウェイのロールを結合することができます。 RD ゲートウェイ ファーム サービスの可用性とより多くのユーザーへのスケール アウトを向上させるその他の RD ゲートウェイ仮想マシンを追加することもできます。 負荷分散セットより大きな RD ゲートウェイ ファーム内の仮想マシンを構成する必要があります。 IP アフィニティは、Windows Server 2016 仮想マシンでは、RD ゲートウェイを使用しているが、Windows Server 2012 R2 仮想マシンで実行している場合は必要はありません。

詳しくは、次の記事をご覧ください。

* [RD Web とゲートウェイ web 前に、高可用性を追加します。](rds-rdweb-gateway-ha.md)
* [リモート デスクトップ サービスのどこからでもアクセス](rds-plan-access-from-anywhere.md)
* [リモート デスクトップ サービスの多要素認証](rds-plan-mfa.md)

## <a name="remote-desktop-web-access"></a>リモート デスクトップ Web アクセス

リモート デスクトップ Web アクセス (RD Web アクセス) でユーザー アクセスのデスクトップと web ポータル経由でのアプリケーション、デバイスのネイティブの Microsoft リモート デスクトップ クライアント アプリケーションを起動するとします。 Web ポータルを使用して、Windows デスクトップおよびアプリケーションを Windows および Windows 以外のクライアントのデバイスに発行して、特定のユーザーまたはグループにも選択的にデスクトップやアプリを発行することができます。

RD Web アクセスでは、適切に機能するように、インターネット インフォメーション サービス (IIS) が必要です。 ハイパー テキスト転送プロトコル セキュア (HTTPS) 接続では、クライアントと RD Web サーバーの間の暗号化された通信チャネルを提供します。 RD Web アクセスの仮想マシンは、HTTPS 通信トランスポート プロトコルを使用してポート 443、テナントのユーザーがインターネットから接続を許可する受信 TCP 接続を許可するパブリック IP アドレスからアクセス可能である必要があります。

デジタル証明書に一致するは、サーバーとクライアントにインストールする必要があります。 開発とテストの目的では、自己生成および自己署名証明書を指定できます。 リリース済みサービスの場合は、デジタル証明書を信頼された証明機関から取得しなければなりません。 証明書の名前は、完全修飾ドメイン名 (FQDN) RD Web アクセスへのアクセスに使用されると一致する必要があります。 可能な Fqdn には、パブリック IP アドレスとパブリック IP アドレスを指す CNAME DNS レコードの外部に公開された DNS 名が含まれます。

ユーザー数が少ないと、テナントに対しては、単一の仮想マシンに、RD Web アクセスとリモート デスクトップ ゲートウェイのワークロードを組み合わせることでコストを削減できます。 サービスの可用性とより多くのユーザーへのスケール アウトを向上させる、RD Web アクセスのファームに追加の RD Web 仮想マシンを追加することもできます。 複数の仮想マシンでの RD Web アクセス ファームでは、負荷分散セットで仮想マシンを構成する必要があります。

RD Web アクセスを構成する方法の詳細については、次の記事を参照してください。

* [ユーザーのリモート デスクトップ web クライアントの設定します。](clients/remote-desktop-web-client-admin.md)
* [作成し、リモート デスクトップ サービスのコレクションをデプロイ](rds-create-collection.md)
* [デスクトップとアプリを実行するリモート デスクトップ サービスのコレクションを作成します。](rds-create-collection.md)

## <a name="remote-desktop-licensing"></a>リモート デスクトップ ライセンス

リモート デスクトップ ライセンス (RD ライセンス) のアクティブ化されたサーバーでは、ユーザーがテナントのデスクトップとアプリをホストしている RD セッション ホスト サーバーに接続できるようにします。 RD ライセンス サーバーが既にインストールされている、付属して通常テナント環境がホストされている環境には、ユーザーごとのモードでサーバーを構成する必要があります。

サービス プロバイダーでは、ユーザーに対応するすべて承認された一意 (非同時実行) 1 か月あたり、サービスにサインインするための十分な RDS サブスクライバー アクセス ライセンス (Sal) を必要があります。 サービス プロバイダーは、直接、Microsoft Azure インフラストラクチャ サービスを購入でき、マイクロソフトのサービス プロバイダー ライセンス契約 (SPLA) プログラムを通じて Sal を購入することができます。 ホストされたデスクトップ ソリューションをお探しのお客様は、サービス プロバイダーから完全なホスト型ソリューション (Azure および RDS) を購入する必要があります。

小さなテナントでは、ファイル サーバーとコンポーネントを単一の仮想マシンに RD ライセンスを組み合わせることでコストを削減できます。 高いサービスの可用性を実現するには、テナントは、同じ可用性セットに 2 つの RD ライセンス サーバーの仮想マシンをデプロイできます。 テナントの環境内のすべての RD サーバーは、ユーザーは、サーバーの 1 つがダウンした場合でも、新しいセッションに接続することを保持する両方の RD ライセンス サーバーに関連付けられます。

詳しくは、次の記事をご覧ください。

* [RDS デプロイをクライアント アクセス ライセンス (Cal) ライセンスします。](rds-client-access-license.md)
* [リモート デスクトップ サービス ライセンス サーバーをアクティブ化します。](rds-activate-license-server.md)
* [リモート デスクトップ サービス クライアント アクセス ライセンス (RDS Cal) の追跡します。](rds-track-cals.md)
* [Microsoft ボリューム ライセンス: ライセンス サービス プロバイダー向けのオプション](https://www.microsoft.com/en-us/Licensing/licensing-programs/spla-program.aspx)