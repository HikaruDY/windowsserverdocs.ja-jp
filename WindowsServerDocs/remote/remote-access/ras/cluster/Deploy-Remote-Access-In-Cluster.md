---
title: クラスターでのリモート アクセスの展開
description: このトピックでは、Windows Server 2016 でのクラスターでのリモート アクセスの展開ガイドの一部です。
manager: dougkim
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-ras
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: ''
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 853788f20c452391c802f0681fa23978b4892c6a
ms.sourcegitcommit: afb0602767de64a76aaf9ce6a60d2f0e78efb78b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/20/2019
ms.locfileid: "67281229"
---
# <a name="deploy-remote-access-in-a-cluster"></a>クラスターでのリモート アクセスの展開

>適用先:Windows Server 2016 の Windows Server (半期チャネル)

Windows Server 2016 および Windows Server 2012 が DirectAccess とリモート アクセス サービスを組み合わせて\(RAS\) VPN は単一のリモート アクセス役割にします。 さまざまなエンタープライズ シナリオでのリモート アクセスを展開することができます。 この概要でのバランスを Windows ネットワーク負荷分散クラスターの負荷に複数のリモート アクセス サーバーを展開するエンタープライズ シナリオの概要については、 \(NLB\)または外部ロード バランサー \(ELB\)、f5 キーを押してビッグなど\-IP。  

## <a name="BKMK_OVER"></a>シナリオの説明  
クラスターのデプロイは、リモート クライアント コンピューターが DirectAccess または VPN 経由で外部の仮想 IPを使用して企業内部ネットワークに接続するための連絡先の1つのポイントとして機能し、1つの単位に複数のリモートアクセスサーバーを収集\(VIP\)リモート アクセス クラスターのアドレス。  クラスターへのトラフィックは、Windows NLB を使用して負荷分散は、または外部ロード バランサー \(F5 ビッグなど\-IP\)します。  

## <a name="prerequisites"></a>前提条件  
このシナリオの展開を開始する前に、重要な要件の一覧を確認してください。  

-   Windows NLB による既定の負荷分散。  

-   外部のロード バランサーがサポートされます。  

-   ユニキャスト モードが NLB の既定であり推奨されるモードです。  

-   DirectAccess 管理コンソールまたは Windows PowerShell コマンドレットを使用しないポリシーの変更はサポートされていません。  

-   NLB または外部ロード バランサーを使用する場合、IPHTTPS プレフィックスことはできません以外の変更を何も\/59 です。  

-   負荷分散されるノードは、同じ IPv4 サブネット内にある必要があります。  

-   ELB の展開で場合管理アウトが必要ですし、DirectAccess クライアントは使用できません&nbsp;Teredo です。 IPHTTPS のみを最後に使用できる\-に\-通信を終了します。  

-   認識されているすべての NLB を確認します。\/ELB の修正プログラムがインストールされています。  

-   企業ネットワーク内での ISATAP はサポートしていません。 ISATAP を使用している場合は、これを削除し、ネイティブ IPv6 を使用する必要があります。  

## <a name="in-this-scenario"></a>このシナリオの内容  
クラスター展開シナリオには、いくつかの手順があります。  

1.  [デプロイの高度なオプションを使用して VPN サーバーで、常に](../../vpn/always-on-vpn/deploy/always-on-vpn-adv-options.md)します。 高度な設定で単一のリモート アクセス サーバーは、クラスターのデプロイをセットアップする前にデプロイする必要があります。  

2.  [リモート アクセス クラスターの展開を計画](plan/Plan-a-Remote-Access-Cluster-Deployment.md)します。 単一サーバーの展開からクラスターを多くの追加のビルド手順が必要ですが、クラスター デプロイ用の証明書の準備など。  

3.  [リモート アクセス クラスターを構成](configure/Configure-a-Remote-Access-Cluster.md)します。 これは、Windows NLB または外部ロード バランサーの単一サーバーの準備、クラスターに参加するためにサーバーを準備、負荷分散を有効にするなど、構成手順の数で構成されます。  

## <a name="BKMK_APP"></a>実際の適用  
複数のサーバーをサーバー クラスターにまとめると、次のことが実現されます。  

-   スケーラビリティ。 単一のリモート アクセス サーバーは、限られたサーバー信頼性と拡張性の高いパフォーマンスを提供します。 2 台以上のサーバーのリソースを 1 つのクラスターにグループ化すると、対応可能なユーザー数とスループットの容量が増加します。  

-   高可用性。 クラスターは高可用性を常に\-にアクセスします。 クラスター内のサーバーで障害が発生しても、リモート ユーザーはクラスター内の別のサーバーを経由して企業ネットワークに引き続きアクセスすることができます。 クラスター内のすべてのサーバーがクラスターの仮想 IP の同じセットを持つ\(VIP\)アドレス、一意で維持しながら専用の各サーバーの IP アドレス。  

-   容易な\-の\-管理します。 クラスターでは、複数のサーバーの 1 つのエンティティとして管理をします。 クラスター サーバー全体で共有設定を簡単に設定できます。 任意のクラスター、またはリモート サーバー管理ツールを使用してリモート サーバーからリモート アクセスの設定を管理できます。 \(RSAT\)します。 また、単一のリモート アクセス管理コンソールからクラスター全体を監視できます。  

## <a name="BKMK_NEW"></a>役割と機能がこのシナリオに含まれる  
次の表に、このシナリオに必要な役割と機能を示します。  

|ロール\/機能|このシナリオのサポート方法|  
|---------|-----------------|  
|リモート アクセスの役割|この役割をインストールまたはアンインストールするには、サーバー マネージャー コンソールを使用します。 Windows Server 2008 R2、およびルーティングとリモート アクセス サービスの機能あった両方の DirectAccess では、あり\(RRAS\)、あったの役割サービスで、ネットワーク ポリシーとアクセス サービス\(NPAS\)サーバーの役割。 リモート アクセスの役割は、次の 2 つのコンポーネントで構成されています。<br /><br />-Always On VPN およびルーティングとリモート アクセス サービス\(RRAS\) VPN DirectAccess と VPN は、リモート アクセス管理コンソールでまとめて管理します。<br />RRAS ルーティング RRAS ルーティング機能は、従来のルーティングとリモート アクセス コンソールで管理されます。<br /><br />依存関係は次のとおりです。<br /><br />-インターネット インフォメーション サービス\(IIS\) Web サーバー - この機能は、ネットワーク ロケーション サーバーおよび既定の web プローブを構成するために必要です。<br />-リモート アクセス サーバー上のローカル アカウンティング Windows 内部 Database-Used します。|  
|リモート アクセス管理ツールの機能|この機能は、次のようにインストールされます。<br /><br />-は、リモート アクセスの役割がインストールされているし、リモート管理コンソールのユーザー インターフェイスをサポートしているときに、既定でリモート アクセス サーバーにインストールされます。<br />-は、リモート アクセス サーバーの役割が実行されていないサーバーで必要に応じてインストールすることができます。 この場合は、DirectAccess および VPN が実行されているリモート アクセス コンピューターのリモート管理に使用されます。<br /><br />リモート アクセス管理ツールの機能は、次の要素で構成されています。<br /><br />-リモート アクセス GUI およびコマンド ライン ツール<br />の Windows PowerShell 用リモート アクセス モジュール<br /><br />次の要素と依存関係があります。<br /><br />グループ ポリシー管理コンソール<br />RAS 接続マネージャー管理キット\(CMAK\)<br />-   Windows PowerShell 3.0<br />グラフィカル管理ツールとインフラストラクチャ|  
|ネットワーク負荷分散|この機能により、Windows NLB を使用してクラスターの負荷を分散します。|  

## <a name="BKMK_HARD"></a>ハードウェア要件  
このシナリオのハードウェア要件は次のとおりです。  

-   Windows Server 2012 のハードウェア要件を満たすには少なくとも 2 台のコンピューター。  

-   外部ロード バランサーのシナリオでは専用のハードウェアが必要な\(F5 BigIP\)します。  

-   シナリオをテストするには、Always On VPN クライアントとして構成されている Windows 10 を実行している少なくとも 1 つのコンピューターが必要です。   

## <a name="BKMK_SOFT"></a>ソフトウェアの要件  
このシナリオには、さまざまな要件があります。  

-   単一サーバーの展開のソフトウェア要件。 詳細については、次を参照してください。[詳細設定を使用する単一の DirectAccess サーバーをデプロイ](../../directaccess/single-server-advanced/Deploy-a-Single-DirectAccess-Server-with-Advanced-Settings.md)します。 単一のリモート アクセス)。  

-   さまざまなクラスターがある 1 台のサーバーのソフトウェア要件に加えて\-特定の要件。  

    -   各クラスター サーバー IP\-HTTPS 証明書のサブジェクト名が ConnectTo アドレスと一致する必要があります。 クラスターのデプロイのワイルドカードのおよび以外の混在をサポートする\-クラスター サーバー上でのワイルドカード証明書。  

    -   ネットワーク ロケーション サーバーがリモート アクセス サーバーにインストールされている場合、各クラスター サーバーで、ネットワーク ロケーション サーバー証明書に同じサブジェクト名が含まれている必要があります。 また、ネットワーク ロケーション サーバーの証明書の名前は、DirectAccess の展開内のどのサーバーの名前とも一致していてはなりません。  

    -   IP\-1 台のサーバー証明書が発行されている同じメソッドを使用して HTTPS とネットワークの場所のサーバー証明書を発行する必要があります。 たとえば、1 台のサーバーは、パブリック証明機関を使用して\(CA\)クラスター内のすべてのサーバーはパブリック CA によって発行された証明書を持つ必要があります。 1 台のサーバーで自己を使用する場合または\-IP の署名入り証明書\-HTTPS し、クラスター内のすべてのサーバーが同様に行う必要があります。  

    -   サーバー クラスターの DirectAccess クライアント コンピューターに割り当てられている IPv6 プレフィックスは 59 ビットである必要があります。 VPN が有効な場合は、VPN プレフィックスも 59 ビットである必要があります。  

## <a name="KnownIssues"></a>既知の問題  
クラスター構成シナリオには、次の既知の問題があります。  

-   IPv4 で DirectAccess を構成した後\-、1 つのネットワーク アダプターとは、既定の DNS64 の展開のみ\(を含む IPv6 アドレス": 3333::"\)は自動的には、ネットワーク アダプターの構成ロードを有効にしようと\-と、ユーザーが IPv6 DIP を指定するためのプロンプトのリモート アクセス管理コンソールを使用して分散します。 クリックすると、構成が失敗する場合、IPv6 DIP を指定すると、**コミット**エラー。パラメーターが正しくありません。  

    この問題の解決策は、以下のとおりです。  

    1.  「 [Back up and Restore Remote Access Configuration (リモート アクセスの構成のバックアップと復元)](https://gallery.technet.microsoft.com/Back-up-and-Restore-Remote-e157e6a6)」からバックアップおよび復元用のスクリプトをダウンロードします。  

    2.  バックアップのスクリプトのダウンロードを使用して、リモート アクセス Gpo をバックアップ\-RemoteAccess.ps1  

    3.  失敗した手順まで、負荷分散の有効化を試みます。 負荷分散を有効にする ダイアログ ボックスで、詳細領域権利を展開し\-、詳細領域でクリックし、クリックして**スクリプトのコピー**します。  

    4.  メモ帳を開き、クリップボードの内容を貼り付けます。 次に、例を示します。  

        ```  
        Set-RemoteAccessLoadBalancer -InternetDedicatedIPAddress @('10.244.4.19 /255.255.255.0','fdc4:29bd:abde:3333::2/128') -InternetVirtualIPAddress @('fdc4:29bd:abde:3333::1/128', '10.244.4.21 /255.255.255.0') -ComputerName 'DA1.domain1.corp.contoso.com' -Verbose  
        ```  

    5.  開いているリモート アクセス ダイアログ ボックスをすべて閉じ、リモート アクセス管理コンソールを閉じます。  

    6.  貼り付けたテキストを編集して、IPv6 アドレスを削除します。 例:  

        ```  
        Set-RemoteAccessLoadBalancer -InternetDedicatedIPAddress @('10.244.4.19 /255.255.255.0') -InternetVirtualIPAddress @('10.244.4.21 /255.255.255.0') -ComputerName 'DA1.domain1.corp.contoso.com' -Verbose  
        ```  

    7.  管理者特権の PowerShell ウィンドウで、前の手順のコマンドを実行します。  

    8.  実行中に、コマンドレットが失敗した場合\(不適切な入力値のないため\)、復元のコマンドを実行\-RemoteAccess.ps1 しに従って手順については、元の構成の整合性が維持されるかどうかを確認するには.  

    9. リモート アクセス管理コンソールを再び開くことができるようになります。  
