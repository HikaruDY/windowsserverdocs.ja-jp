---
title: 手順 1 は、リモート アクセス インフラストラクチャを構成します。
description: このトピックでは、リモート Windows Server 2016 での Directaccess の管理ガイドの一部です。
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology:
- networking-ras
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 0e7d1f5b-c939-47ca-892f-5bb285027fbc
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 95fc9cbef454c8f36b1921eb7f570138bf124256
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2019
ms.locfileid: "66446941"
---
# <a name="step-1-configure-the-remote-access-infrastructure"></a>手順 1 は、リモート アクセス インフラストラクチャを構成します。

>適用先:Windows Server 2016 の Windows Server (半期チャネル)

**注:** Windows Server 2012 では、DirectAccess およびルーティングとリモート アクセス サービス (RRAS) は単一のリモート アクセスの役割に統合されています。  
  
このトピックでは、IPv4 と IPv6 の混在環境で単一のリモート アクセス サーバーを使用して高度なリモート アクセス展開に必要なインフラストラクチャを構成する方法について説明します。 展開の手順を開始する前で説明されている計画手順を完了したことを確認[手順 1。リモート アクセス インフラストラクチャを計画](../plan/Step-1-Plan-the-Remote-Access-Infrastructure.md)します。  
  
|タスク|説明|  
|----|--------|  
|サーバーのネットワーク設定を構成する|リモート アクセス サーバーでサーバーのネットワーク設定を構成します。|  
|企業ネットワークでルーティングを構成する|企業ネットワークで、トラフィックが適切にルーティングされるようにルーティングを構成します。|  
|ファイアウォールを構成する|必要に応じて、追加のファイアウォールを構成します。|  
|CA および証明書を構成する|証明機関 (CA)、必要な場合、および展開に必要な証明書テンプレートを構成します。|  
|DNS サーバーを構成する|リモート アクセス サーバーの DNS 設定を構成します。|  
|Active Directory を構成する|クライアント コンピューターとリモート アクセス サーバーを Active Directory ドメインに参加します。|  
|GPO を構成する|必要な場合は、展開は、グループ ポリシー オブジェクト (Gpo) を構成します。|  
|セキュリティ グループを構成する|DirectAccess クライアント コンピューターを含むセキュリティ グループと、展開に必要なその他のセキュリティ グループを構成します。|  
|ネットワーク ロケーション サーバーを構成する|ネットワーク ロケーション サーバー Web サイト証明書を含めて、ネットワーク ロケーション サーバーを構成します。|  
  
> [!NOTE]  
> このトピックでは、サンプル Windows PowerShell コマンドレットを紹介します。ここで説明する手順の一部はこのコマンドレットで自動化できます。 詳しくは、 [コマンドレットの使用に関するページ](https://go.microsoft.com/fwlink/p/?linkid=230693)をご覧ください。  
  
## <a name="BKMK_ConfigNetworkSettings"></a>サーバーのネットワーク設定を構成します。  
エッジで、またはネットワーク アドレス変換 (NAT) デバイスの内側にリモート アクセス サーバーを配置する場合はに応じて、次のネットワーク インターフェイスのアドレス設定が IPv4 と IPv6 の環境でのシングル サーバー配置に必要です。 使用してすべての IP アドレスが構成されている **アダプターの設定を変更する** で、 **Windows ネットワークと共有センター**します。  
  
**エッジ トポロジ**:  
  
次が必要です。  
  
-   2 つインターネットに接続された連続するパブリック静的 IPv4 または IPv6 アドレス。  
  
    > [!NOTE]  
    > Teredo には、連続する 2 つのパブリック IPv4 アドレスが必要です。 Teredo を使用していない場合は、単一の静的パブリック IPv4 アドレスを構成できます。  
  
-   単一の内部静的 IPv4 または IPv6 アドレス。  
  
**NAT デバイス (2 つのネットワーク アダプター) の内側に**:  
  
単一の内部ネットワークに接続された静的 IPv4 または IPv6 アドレスが必要です。  
  
**NAT デバイス (1 つのネットワーク アダプター) の内側に**:  
  
単一の静的 IPv4 または IPv6 アドレスが必要です。  
  
リモート アクセス サーバーが 2 つのネットワーク アダプター (パブリックまたはプライベート プロファイルの他のドメイン プロファイルを 1 つ) を 1 つのネットワーク アダプターのトポロジを使用している場合、推奨事項はとおりです。  
  
1.  2 番目のネットワーク アダプターもドメイン プロファイルに分類することを確認します。  
  
2.  場合何らかの理由は、ドメイン プロファイル、2 つ目のネットワーク アダプターを構成することはできません、DirectAccess IPsec ポリシー必要があります手動でスコープのすべてのプロファイルに次の Windows PowerShell コマンドを使用しています。  
  
    ```  
    $gposession = Open-NetGPO -PolicyStore <Name of the server GPO>  
    Set-NetIPsecRule -DisplayName <Name of the IPsec policy> -GPOSession $gposession -Profile Any  
    Save-NetGPO -GPOSession $gposession  
    ```  
  
    このコマンドで使用する IPsec ポリシーの名前は **DirectAccess DaServerToInfra** と **DirectAccess DaServerToCorp**します。  
  
## <a name="BKMK_ConfigRouting"></a>企業ネットワークでルーティングを構成します。  
次のように、企業ネットワークでルーティングを構成します。  
  
-   組織でネィティブ IPv6 が展開されている場合、内部ネットワーク上のルーターがリモート アクセス サーバー経由で IPv6 トラフィックをルーティングするようにルートを追加します。  
  
-   リモート アクセス サーバー上で組織の IPv4 および IPv6 ルートを手動で構成します。 公開されたルートを追加ですべてのトラフィックを (/48) の IPv6 プレフィックスは、内部ネットワークに転送されます。 さらに、IPv4 トラフィックの場合、IPv4 トラフィックが内部ネットワークに転送されるように、明示的なルートを追加します。  
  
## <a name="BKMK_ConfigFirewalls"></a>ファイアウォールを構成します。  
選択したネットワークの設定に応じて、展開に追加のファイアウォールを使用する場合は、リモート アクセス トラフィックについて次のファイアウォール例外を適用します。  
  
### <a name="remote-access-server-on-ipv4-internet"></a>IPv4 インターネット上のリモート アクセス サーバー  
リモート アクセス サーバーが IPv4 インターネット上とリモート アクセス トラフィックについては、次のインターネットに接続するファイアウォール例外が適用されます。  
  
-   **Teredo トラフィック**  
  
    ユーザー データグラム プロトコル (UDP) 宛先ポート 3544 受信、および UDP 発信元ポート 3544 の送信。 リモート アクセス サーバーでインターネットに接続された連続するパブリック IPv4 アドレスの両方に対してこの除外を適用します。  
  
-   **6to4 トラフィック**  
  
    IP プロトコル 41 の受信および送信します。 リモート アクセス サーバーでインターネットに接続された連続するパブリック IPv4 アドレスの両方に対してこの除外を適用します。  
  
-   **IP-HTTPS のトラフィック**  
  
    伝送制御プロトコル (TCP) 宛先ポート 443 と TCP 発信元ポート 443 が送信されます。 リモート アクセス サーバーに単一のネットワーク アダプターがあり、ネットワーク ロケーション サーバーがリモート アクセス サーバー上にある場合は、TCP ポート 62000 も必要です。 これらの除外対象サーバーの外部の名前が解決されるアドレスに対してのみ適用されます。  
  
    > [!NOTE]  
    > この除外は、リモート アクセス サーバーで構成されます。 その他のすべての除外はエッジ ファイアウォールで構成されます。  
  
### <a name="remote-access-server-on-ipv6-internet"></a>IPv6 インターネット上のリモート アクセス サーバー  
リモート アクセス サーバーが IPv6 インターネット上とリモート アクセス トラフィックについては、次のインターネットに接続するファイアウォール例外が適用されます。  
  
-   IP プロトコル 50  
  
-   UDP 宛先ポート 500 の受信と、UDP 発信元ポート 500 の送信。  
  
-   IPv6 のインターネット制御メッセージ プロトコル (ICMPv6) トラフィックの受信と送信 - Teredo の実装だけです。  
  
### <a name="remote-access-traffic"></a>リモート アクセス トラフィック  
リモート アクセス トラフィックについては、次の内部ネットワーク ファイアウォール例外が適用されます。  
  
-   ISATAP:プロトコル 41 の受信と送信  
  
-   すべての IPv4 または IPv6 トラフィックに対する TCP/UDP  
  
-   すべての IPv4 または IPv6 トラフィックに対する ICMP  
  
## <a name="BKMK_ConfigCAs"></a>Ca と証明書を構成します。  
コンピューターの認証に証明書を使用して、ユーザー名とパスワードを使用する組み込みの Kerberos 認証を使用するかを選択する Windows Server 2012 を使用すると、リモート アクセスをします。 リモート アクセス サーバーで、IP-HTTPS の証明書を構成することも必要があります。 このセクションでは、これらの証明書を構成する方法について説明します。  
  
公開キー基盤 (PKI) の設定の詳細については、次を参照してください。 [Active Directory Certificate Services](https://technet.microsoft.com/library/cc770357.aspx)します。  
  
### <a name="BKMK_ConfigIPsec"></a>IPsec 認証を構成します。  
IPsec 認証を使用できるように、リモート アクセス サーバーと DirectAccess のすべてのクライアントで証明書が必要です。 内部証明機関 (CA) 証明書を発行する必要があります。 リモート アクセス サーバーと DirectAccess クライアントは、ルートおよび中間証明書を発行する CA を信頼する必要があります。  
  
##### <a name="to-configure-ipsec-authentication"></a>IPsec 認証を構成するには  
  
1.  内部 CA で既定のコンピューターの証明書テンプレートを使用する場合、または」の説明に従って、新しい証明書テンプレートを作成する場合を決定 [証明書テンプレートの作成](https://technet.microsoft.com/library/cc731705.aspx)します。  
  
    > [!NOTE]  
    > 新しいテンプレートを作成する場合は、クライアント認証を構成する必要があります。  
  
2.  必要な場合は、証明書テンプレートをデプロイします。 詳細については、次を参照してください。 [証明書テンプレートを展開する](https://technet.microsoft.com/library/cc770794.aspx)です。  
  
3.  必要な場合は、自動登録用のテンプレートを構成します。  
  
4.  必要な場合は、証明書の自動登録を構成します。 詳細については、次を参照してください。 [Configure Certificate Autoenrollment](https://technet.microsoft.com/library/cc731522.aspx)します。  
  
### <a name="BKMK_ConfigCertTemp"></a>証明書テンプレートを構成します。  
内部証明書を発行する CA を使用する場合は、IP-HTTPS 証明書と、ネットワーク ロケーション サーバー web サイト証明書の証明書テンプレートを構成する必要があります。  
  
##### <a name="to-configure-a-certificate-template"></a>証明書テンプレートを構成するには  
  
1.  内部 CA の証明書テンプレートの説明に従って作成 [証明書テンプレートの作成](https://technet.microsoft.com/library/cc731705.aspx)します。  
  
2.  」の説明に従って、証明書テンプレートを展開 [証明書テンプレートを展開する](https://technet.microsoft.com/library/cc770794.aspx)です。  
  
テンプレートを準備した後は、証明書を構成に使用できます。 詳細については、次の手順を参照してください。  
  
-   [IP-HTTPS 証明書を構成します。](#BKMK_IPHTTPS)  
  
-   [ネットワーク ロケーション サーバーを構成します。](#BKMK_ConfigNLS)  
  
### <a name="BKMK_IPHTTPS"></a>IP-HTTPS 証明書を構成します。  
リモート アクセスでは、リモート アクセス サーバーへの IP-HTTPS 接続を認証するために IP-HTTPS 証明書が必要です。 IP-HTTPS 証明書には 3 つの証明書オプションがあります。  
  
-   **パブリック**  
  
    サード パーティによって提供されます。  
  
-   **プライベート**  
  
    証明書が証明書テンプレートで作成したに基づいて [証明書テンプレートを構成する](assetId:///6a5ec5c1-d653-47b1-a567-cc485004e7bc#ConfigCertTemp)です。 これで、パブリックに解決可能な FQDN から到達可能な証明書失効リスト (CRL) 配布ポイントは必要。  
  
-   **自己署名**  
  
    この証明書には、パブリックに解決可能な FQDN から到達可能な CRL 配布ポイントが必要です。  
  
    > [!NOTE]  
    > 自己署名証明書はマルチサイト展開では使用できません。  
  
IP-HTTPS 認証に使用する Web サイトの証明書が次の要件を満たしていることを確認します。  
  
-   証明書のサブジェクト名は、リモート アクセス サーバーの IP-HTTPS 接続にのみ使用される、IP-HTTPS URL (ConnectTo アドレス) の外部で解決可能な完全修飾ドメイン名 (FQDN) にあります。  
  
-   証明書の共通名は、IP-HTTPS サイトの名前と一致している必要があります。  
  
-   [件名] フィールドでは、リモート アクセス サーバーの外部に接続されたアダプターまたは IP-HTTPS URL の FQDN の IPv4 アドレスを指定します。  
  
-   **拡張キー使用法** フィールドに、サーバー認証オブジェクト識別子 (OID) を使用します。  
  
-   **[CRL 配布ポイント]** フィールドに、インターネットに接続している DirectAccess クライアントがアクセスできる CRL 配布ポイントを指定します。  
  
-   IP-HTTPS 証明書には秘密キーが必要です。  
  
-   IP-HTTPS 証明書は、個人用ストアに直接インポートする必要があります。  
  
-   IP-HTTPS 証明書の名前にはワイルドカードを含めることができます。  
  
##### <a name="to-install-the-ip-https-certificate-from-an-internal-ca"></a>内部 CA から IP-HTTPS 証明書をインストールするには  
  
1.  リモート アクセス サーバーで、**開始**画面で「**mmc.exe**、し、ENTER キーを押します。  
  
2.  MMC コンソールで、 **[ファイル]** メニューの **[スナップインの追加と削除]** をクリックします。  
  
3.  **スナップインを追加または** ダイアログ ボックスで、 をクリックして **証明書**, 、 をクリックして **追加**, 、 をクリックして **コンピューター アカウント**, 、 をクリックして **次**, 、 をクリックして **ローカル コンピューター**, 、 をクリックして **完了**, 、順にクリック **ok**します。  
  
4.  証明書スナップインのコンソール ツリーで、 **[証明書 (ローカル コンピューター)]、[個人用]、[証明書]** の順に開きます。  
  
5.  右クリック **証明書**, 、 をポイント **すべてのタスク**, 、 をクリックして **新しい証明書の要求**, 、 をクリックし、 **次** 2 回.  
  
6.  **証明書の要求** ページで、証明書テンプレートの構成で作成した証明書テンプレートのチェック ボックスをオンにし、必要な場合はクリックして **の詳細については、この証明書を登録するために必要な**です。  
  
7.  **証明書のプロパティ**  ダイアログ ボックスの 、 **サブジェクト**  タブの 、 **サブジェクト名** 領域で、 **型**,  **共通名**します。  
  
8.  **値**, 、リモート アクセス サーバーの外部アダプターまたは IP-HTTPS URL の FQDN の IPv4 アドレスを指定し、クリックして **追加**します。  
  
9. **代替名** 領域で、 **型**,  **DNS**します。  
  
10. **値**, 、リモート アクセス サーバーの外部アダプターまたは IP-HTTPS URL の FQDN の IPv4 アドレスを指定し、クリックして **追加**します。  
  
11. **全般** ] タブの [ **フレンドリ名**, 、証明書を識別するための名前を入力することができます。  
  
12. **拡張**  タブの横に **拡張キー使用法**, 、矢印をクリックし、サーバー認証がであるかどうかを確認、 **するオプションを選択**  ボックスの一覧です。  
  
13. **[OK]** をクリックし、 **[登録]** をクリックして、 **[完了]** をクリックします。  
  
14. 証明書スナップインの詳細ウィンドウで、新しい証明書がサーバー認証の目的で登録されていることを確認します。  
  
## <a name="BKMK_ConfigDNS"></a>DNS サーバーを構成します。  
展開内の内部ネットワークのネットワーク ロケーション サーバー Web サイトの DNS エントリを手動で構成する必要があります。  
  
### <a name="NLS_DNS"></a>ネットワーク ロケーション サーバーと web プローブを追加するには  
  
1.  内部ネットワーク DNS サーバーで、**開始**画面で「**dnsmgmt.msc**、し、ENTER キーを押します。  
  
2.  **[DNS マネージャー]** コンソールの左側のウィンドウで、ドメインの前方参照ゾーンを展開します。 ドメインを右クリックし、をクリックして **新しいホスト (A または AAAA)** します。  
  
3.  **新しいホスト** ダイアログ ボックスで、 **名 (使用して親ドメイン名空白の場合)** (これは DirectAccess クライアントがネットワーク ロケーション サーバーへの接続に使用する名前です)、ネットワーク ロケーション サーバー web サイトの DNS 名を入力します。 **IP アドレス** ボックスで、ネットワーク ロケーション サーバーの IPv4 アドレスを入力してをクリックして **ホストの追加**, 、 をクリックし、 **OK**します。  
  
4.  **新しいホスト** ダイアログ ボックスで、 **名 (使用して親ドメイン名空白の場合)**  (既定の web プローブの名前は directaccess webprobehost) の web プローブの DNS 名を入力します。 **IP アドレス** ボックス、web プローブの IPv4 アドレスを入力し、クリックして **ホストの追加**します。  
  
5.  directaccess-corpconnectivityhost および手動で作成した接続検証ツールに対し、このプロセスを繰り返します。 **DNS** ダイアログ ボックスで、をクリックして **OK**します。  
  
6.  **[完了]** をクリックします。  
  
![Windows PowerShell](../../../../media/Step-1-Configure-the-Remote-Access-Infrastructure/PowerShellLogoSmall.gif)***<em>Windows PowerShell の同等のコマンド</em>***  
  
以下の Windows PowerShell コマンドレットは、前述の手順と同じ機能を実行します。 ここでは書式上の制約のために、折り返されて複数の行にわたって表示される場合もありますが、各コマンドレットは 1 行に入力します。  
  
```  
Add-DnsServerResourceRecordA -Name <network_location_server_name> -ZoneName <DNS_zone_name> -IPv4Address <network_location_server_IPv4_address>  
Add-DnsServerResourceRecordAAAA -Name <network_location_server_name> -ZoneName <DNS_zone_name> -IPv6Address <network_location_server_IPv6_address>  
```  
  
次の DNS エントリも構成する必要があります。  
  
-   **IP-HTTPS サーバー**  
  
    DirectAccess クライアントは、インターネットからリモート アクセス サーバーの DNS 名を解決できる必要があります。  
  
-   **CRL 失効確認**  
  
    DirectAccess は DirectAccess クライアントと、リモート アクセス サーバー間の IP-HTTPS 接続、DirectAccess クライアントとネットワーク ロケーション サーバーの間の HTTPS ベースの接続に証明書失効確認を使用します。 どちらの場合も、DirectAccess クライアントは、CRL 配布ポイントの場所の解決とアクセスができる必要があります。  
  
-   **ISATAP**  
  
    サイト内自動 Tunnel Addressing Protocol (ISATAP) では、トンネルを使用して、IPv4 ヘッダー内に IPv6 パケットをカプセル化する、IPv4 インターネット経由でリモート アクセス サーバーに接続する DirectAccess クライアントを有効にします。 イントラネットで、ISATAP ホストへの IPv6 接続を提供するため、リモート アクセスによって使用されます。 非ネイティブの IPv6 ネットワーク環境でリモート アクセス サーバーとして自動的に構成に自動的に ISATAP ルーター。 ISATAP 名の解決のサポートが必要です。  
  
## <a name="BKMK_ConfigAD"></a>Active Directory を構成します。  
リモート アクセス サーバーとすべての DirectAccess クライアント コンピューターは Active Directory ドメインに参加している必要があります。 DirectAccess クライアント コンピューターは、次のいずれかのドメインの種類のメンバーである必要があります。  
  
-   リモート アクセス サーバーと同じフォレストに属するドメイン。  
  
-   リモート アクセス サーバー フォレストと双方向の信頼を持つフォレストに属するドメイン。  
  
-   リモート アクセス サーバー ドメインへの双方向の信頼を持つドメイン。  
  
#### <a name="to-join-the-remote-access-server-to-a-domain"></a>リモート アクセス サーバーをドメインに追加するには  
  
1.  サーバー マネージャーで **[ローカル サーバー]** をクリックします。 詳細ウィンドウで、 **[コンピューター名]** の横にあるリンクをクリックします。  
  
2.  **[システムのプロパティ]** ダイアログ ボックスで **[コンピューター名]** タブをクリックし、 **[変更]** をクリックします。  
  
3.  **コンピューター名** ボックスに、サーバーをドメインに参加する際にも、コンピューター名を変更する場合は、コンピューターの名前を入力します。 [ **のメンバー**, 、] をクリックして **ドメイン**, 、クリックしてサーバー (corp.contoso.com など) に参加するドメインの名前を入力し、 **[ok]** します。  
  
4.  ユーザー名とパスワードを求められたら、ユーザー名とコンピューターをドメインに参加し、アクセス許可を持つユーザーのパスワードを入力してください。 **OK**します。  
  
5.  ドメインへの参加を知らせるダイアログ ボックスが表示されたら、 **[OK]** をクリックします。  
  
6.  コンピューターを再起動するよう求めるメッセージが表示されたら、 **[OK]** をクリックします。  
  
7.  **[システムのプロパティ]** ダイアログ ボックスで、 **[閉じる]** をクリックします。  
  
8.  コンピューターを再起動するよう求めるメッセージが表示されたら、 **[今すぐ再起動する]** をクリックします。  
  
#### <a name="to-join-client-computers-to-the-domain"></a>クライアント コンピューターをドメインに参加させるには  
  
1.  **開始** 画面で「**explorer.exe**, 、ENTER キーを押します。  
  
2.  コンピューター アイコンを右クリックし、**プロパティ** をクリックします。  
  
3.  **システム** ] ページで [ **システムの詳細設定**します。  
  
4.  **[システムのプロパティ]** ダイアログ ボックスの **[コンピューター名]** タブで **[変更]** をクリックします。  
  
5.  **コンピューター名** ボックスに、サーバーをドメインに参加する際にも、コンピューター名を変更する場合は、コンピューターの名前を入力します。 **[次のメンバー]** で **[ドメイン]** をクリックし、サーバーの追加先のドメイン名 (corp.contoso.com など) を入力し、 **[OK]** をクリックします。  
  
6.  ユーザー名とパスワードを求められたら、ユーザー名とコンピューターをドメインに参加し、アクセス許可を持つユーザーのパスワードを入力してください。 **OK**します。  
  
7.  ドメインへの参加を知らせるダイアログ ボックスが表示されたら、 **[OK]** をクリックします。  
  
8.  コンピューターを再起動するよう求めるメッセージが表示されたら、 **[OK]** をクリックします。  
  
9. **システム プロパティ**  ダイアログ ボックスを閉じる をクリックします。  
  
10. 指示に従い、 **[今すぐ再起動する]** をクリックします。  
  
![Windows PowerShell](../../../../media/Step-1-Configure-the-Remote-Access-Infrastructure/PowerShellLogoSmall.gif)***<em>Windows PowerShell の同等のコマンド</em>***  
  
以下の Windows PowerShell コマンドレットは、前述の手順と同じ機能を実行します。 ここでは書式上の制約のために、折り返されて複数の行にわたって表示される場合もありますが、各コマンドレットは 1 行に入力します。  
  
> [!NOTE]  
> 次のコマンドを入力した後は、ドメインの資格情報を指定する必要があります。  
  
```  
Add-Computer -DomainName <domain_name>  
Restart-Computer  
```  
  
## <a name="BKMK_ConfigGPOs"></a>Gpo を構成します。  
リモート アクセスを展開するには、2 つのグループ ポリシー オブジェクトの最小値が必要です。 1 つのグループ ポリシー オブジェクトには、リモート アクセス サーバーの設定が含まれていて、DirectAccess クライアント コンピューターの設定が含まれています。 リモート アクセスを構成するときに、ウィザードは自動的に必要なグループ ポリシー オブジェクトを作成します。 ただし、名前付け規則を実施する組織、またはグループ ポリシー オブジェクトを作成または更新に必要なアクセス許可がないは、リモート アクセスを構成する前に、作成する必要があります。  
  
グループ ポリシー オブジェクトを作成するを参照してください。 [を作成し、グループ ポリシー オブジェクトを編集](https://technet.microsoft.com/library/cc754740.aspx)します。  
  
管理者は、組織単位 (OU) に、DirectAccess グループ ポリシー オブジェクトを手動でリンクできます。 次の点を考慮します。  
  
1.  DirectAccess を構成する前に、それぞれの Ou に、作成した Gpo をリンクします。  
  
2.  DirectAccess を構成する場合は、クライアント コンピューターにセキュリティ グループを指定します。  
  
3.  Gpo は、自動的に構成されている場合は、管理者があるドメインに Gpo をリンクするアクセス許可にかかわらず、です。  
  
4.  Gpo は、既に OU にリンクされているが、リンクは削除されませんが、ドメインにリンクされていません。  
  
5.  サーバー Gpo、OU は、サーバーのコンピューター オブジェクトのそれ以外の場合に含める必要があります、GPO がドメインのルートにリンクされます。  
  
6.  OU がリンクされていない以前の構成が完了したら、DirectAccess のセットアップ ウィザードを実行して、管理者では、必要な Ou に DirectAccess の Gpo をリンクし、ドメインにリンクを削除することができます。  
  
    詳細については、次を参照してください。 [グループ ポリシー オブジェクト リンク](https://technet.microsoft.com/library/cc732979.aspx)します。  
  
> [!NOTE]  
> グループ ポリシー オブジェクトは、手動で作成されている場合は、グループ ポリシー オブジェクトが使用できないこと、DirectAccess 構成中に考えられるです。 グループ ポリシー オブジェクトは、管理コンピューターに最も近いドメイン コント ローラーにレプリケートするされていない可能性があります。 管理者は、完了またはレプリケーションを強制するレプリケーションの待機できます。  
  
## <a name="BKMK_ConfigSGs"></a>セキュリティ グループを構成します。  
クライアント コンピューターのグループ ポリシー オブジェクトに含まれる DirectAccess 設定は、リモート アクセスを構成するときに指定したセキュリティ グループのメンバーであるコンピューターにのみ適用されます。  
  
### <a name="Sec_Group"></a>DirectAccess クライアントのセキュリティ グループを作成するには  
  
1.  **開始** 画面で「**dsa.msc**, 、ENTER キーを押します。  
  
2.  **Active Directory ユーザーとコンピューター** コンソールの左側のウィンドウで、セキュリティ グループを含むを右クリックし、ドメインを展開する **ユーザー**, 、 をポイント **新規**, 、クリックして **グループ**します。  
  
3.  **[新しいオブジェクト - グループ]** ダイアログ ボックスの **[グループ名]** の下に、セキュリティ グループの名前を入力します。  
  
4.  **[グループのスコープ]** の下で **[グローバル]** をクリックし、 **[グループの種類]** の下で **[セキュリティ]** をクリックし、 **[OK]** をクリックします。  
  
5.  DirectAccess クライアント コンピューターのセキュリティ グループをダブルクリックし、[、 **プロパティ** ダイアログ ボックスで、をクリックして、 **メンバー** ] タブをクリックします。  
  
6.  **[メンバー]** タブで **[追加]** をクリックします。  
  
7.  **[ユーザー、連絡先、コンピューター、サービス アカウントまたはグループの選択]** ダイアログ ボックスで、DirectAccess 用に有効にするクライアント コンピューターを選択し、 **[OK]** をクリックします。  
  
![Windows PowerShell](../../../../media/Step-1-Configure-the-Remote-Access-Infrastructure/PowerShellLogoSmall.gif)**Windows PowerShell の同等のコマンド**  
  
以下の Windows PowerShell コマンドレットは、前述の手順と同じ機能を実行します。 ここでは書式上の制約のために、折り返されて複数の行にわたって表示される場合もありますが、各コマンドレットは 1 行に入力します。  
  
```  
New-ADGroup -GroupScope global -Name <DirectAccess_clients_group_name>  
Add-ADGroupMember -Identity DirectAccess_clients_group_name -Members <computer_name>  
```  
  
## <a name="BKMK_ConfigNLS"></a>ネットワーク ロケーション サーバーを構成します。  
ネットワーク ロケーション サーバーは、高可用性を備えたサーバーに配置する必要があり、DirectAccess クライアントによって信頼されている有効な Secure Sockets Layer (SSL) 証明書が必要があります。  
  
> [!NOTE]  
> ネットワーク ロケーション サーバー web サイトがリモート アクセス サーバー上にあるリモート アクセスを構成して、指定したサーバー証明書にバインドされているときに、web サイトが自動的に作成されます。  
  
ネットワーク ロケーション サーバー証明書には、次の 2 つの証明書オプションがあります。  
  
-   **プライベート**  
  
    > [!NOTE]  
    > 証明書が証明書テンプレートで作成したに基づいて [証明書テンプレートを構成する](assetId:///6a5ec5c1-d653-47b1-a567-cc485004e7bc#ConfigCertTemp)です。  
  
-   **自己署名**  
  
    > [!NOTE]  
    > 自己署名証明書はマルチサイト展開では使用できません。  
  
プライベート証明書または自己署名証明書を使用するかどうかは、次が必要です。  
  
-   ネットワーク ロケーション サーバーに使用する Web サイト証明書。 証明書のサブジェクトは、ネットワーク ロケーション サーバーの URL である必要があります。  
  
-   内部ネットワーク上の高可用性 CRL 配布ポイント。  
  
#### <a name="to-install-the-network-location-server-certificate-from-an-internal-ca"></a>内部 CA からネットワーク ロケーション サーバー証明書をインストールするには  
  
1.  ネットワーク ロケーション サーバー Web サイトをホストするサーバーで、**開始**画面で「**mmc.exe**、し、ENTER キーを押します。  
  
2.  MMC コンソールで、 **[ファイル]** メニューの **[スナップインの追加と削除]** をクリックします。  
  
3.  **スナップインを追加または** ダイアログ ボックスで、 をクリックして **証明書**, 、 をクリックして **追加**, 、 をクリックして **コンピューター アカウント**, 、 をクリックして **次**, 、 をクリックして **ローカル コンピューター**, 、 をクリックして **完了**, 、順にクリック **ok**します。  
  
4.  証明書スナップインのコンソール ツリーで、 **[証明書 (ローカル コンピューター)]、[個人用]、[証明書]** の順に開きます。  
  
5.  右クリック **証明書**, 、 をポイント **すべてのタスク**, 、 をクリックして **新しい証明書の要求**, 、 をクリックし、 **次** 2 回クリックします。  
  
6.  **証明書の要求** ページで、証明書テンプレートの構成で作成した証明書テンプレートのチェック ボックスをオンにし、必要な場合はクリックして **の詳細については、この証明書を登録するために必要な**です。  
  
7.  **証明書のプロパティ**  ダイアログ ボックスの 、 **サブジェクト**  タブの 、 **サブジェクト名** 領域で、 **型**,  **共通名**します。  
  
8.  **[値]** にネットワーク ロケーション サーバー Web サイトの FQDN を入力して、 **[追加]** をクリックします。  
  
9. **代替名** 領域で、 **型**,  **DNS**します。  
  
10. **[値]** にネットワーク ロケーション サーバー Web サイトの FQDN を入力して、 **[追加]** をクリックします。  
  
11. **全般** ] タブの [ **フレンドリ名**, 、証明書を識別するための名前を入力することができます。  
  
12. **[OK]** をクリックし、 **[登録]** をクリックして、 **[完了]** をクリックします。  
  
13. 証明書スナップインの詳細ウィンドウで、その新しい証明書がサーバー認証の使用目的に登録されているを確認します。  
  
#### <a name="to-configure-the-network-location-server"></a>ネットワーク ロケーション サーバーを構成するには  
  
1.  高可用性サーバーに Web サイトを設定します。 Web サイトにコンテンツは必要ありませんが、テストする際は、クライアントが接続したときにメッセージを表示する既定のページを定義できます。  
  
    ネットワーク ロケーション サーバー web サイトがリモート アクセス サーバーでホストされている場合、この手順は必要ありません。  
  
2.  HTTPS サーバー証明書を Web サイトにバインドします。 証明書の共通名は、ネットワーク ロケーション サーバー サイトの名前と一致している必要があります。 DirectAccess クライアントが発行元 CA を信頼していることを確認します。  
  
    ネットワーク ロケーション サーバー web サイトがリモート アクセス サーバーでホストされている場合、この手順は必要ありません。  
  
3.  CRL サイトその hass 高可用性で設定、内部ネットワーク。  
  
    CRL 配布ポイントは、次の方法でアクセスできます。  
  
    -   など、HTTP ベースの URL を使用する web サーバー: https://crl.corp.contoso.com/crld/corp-APP1-CA.crl  
  
    -   ファイル サーバーなど、汎用名前付け規則 (UNC) パスを介してアクセスされる \\\crl.corp.contoso.com\crld\corp-APP1-CA.crl  
  
    内部 CRL 配布ポイントが IPv6 によってのみ到達可能な場合は、高度なセキュリティ接続セキュリティ規則で Windows ファイアウォールを構成する必要があります。 これは、CRL 配布ポイントの IPv6 アドレスへのイントラネットの IPv6 アドレス空間からの保護の IPsec を除外します。  
  
4.  内部ネットワーク上の DirectAccess クライアントが、ネットワーク ロケーション サーバーの名前を解決できることと、インターネット上の DirectAccess クライアントが名前を解決できないことを確認してください。  
  
## <a name="BKMK_Links"></a>参照してください。  
  
-   [手順 2:リモート アクセス サーバーを構成する](Step-2-Configure-the-Remote-Access-Server.md)

