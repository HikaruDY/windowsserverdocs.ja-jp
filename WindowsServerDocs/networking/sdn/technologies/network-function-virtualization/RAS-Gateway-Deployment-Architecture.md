---
title: RAS ゲートウェイ展開アーキテクチャ
description: このトピックを使用すると、Windows Server 2016 で、RAS ゲートウェイ プール、ルート リフレクタ、個々 のテナント用の複数のゲートウェイの展開などの RAS ゲートウェイのクラウド サービス プロバイダー (CSP) の展開について説明します。
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-sdn
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.assetid: d46e4e91-ece0-41da-a812-af8ab153edc4
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 21b101e10dba3d3b9578d6804b4fd92fbbcd2167
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
---
# <a name="ras-gateway-deployment-architecture"></a>RAS ゲートウェイ展開アーキテクチャ

>適用対象: Windows Server (半期チャネル)、Windows Server 2016

このトピックを使用すると、RAS ゲートウェイは、RAS ゲートウェイ プール、ルート リフレクタ、個々 のテナント用の複数のゲートウェイの展開などのクラウド サービス プロバイダー (CSP) の展開について説明します。  
  
次のセクションでは、ゲートウェイ展開の設計でこれらの機能を使用する方法を理解できるように RAS ゲートウェイの新機能のいくつかの簡単な概要を提供します。  
  
さらに、展開の例が提供される、新しいテナント、ルート同期およびデータ プレーンのルーティング、ゲートウェイおよびルート Reflector フェールオーバー、および詳細を追加するプロセスに関する情報も含まれます。  
  
このトピックには、次のセクションが含まれています。  
  
-   [RAS ゲートウェイの新機能を使用して、展開を設計するには](#bkmk_new)  
  
-   [展開の例](#bkmk_example)  
  
-   [追加の新しいテナント、カスタマー アドレス (CA) 空間 EBGP ピアリング](#bkmk_tenant)  
  
-   [平面ルート同期とデータをルーティング](#bkmk_route)  
  
-   [ネットワーク コントローラーが RAS ゲートウェイおよびルート Reflector フェールオーバーにどのように応答する方法](#bkmk_failover)  
  
-   [RAS ゲートウェイの新機能を使用する利点](#bkmk_advantages)  
  
## <a name="bkmk_new"></a>RAS ゲートウェイの新機能を使用して、展開を設計するには  
RAS ゲートウェイには、さまざまな新機能変更し、データ センターで、ゲートウェイのインフラストラクチャを展開する方法を改善にはが含まれています。  
  
### <a name="bgp-route-reflector"></a>BGP ルート Reflector  
ボーダー ゲートウェイ プロトコル (BGP) のルート Reflector 機能が RAS ゲートウェイは、含まれており、ルーター間でのルートの同期に必要な通常 BGP フル メッシュ トポロジに代わる機能を提供します。 フル メッシュ同期では、すべての BGP ルーターは、ルーティング トポロジでは、その他のすべてのルーターで接続する必要があります。 ルート Reflector を使用して、ただし、ルート Reflector はすべての BGP ルート Reflector クライアント、ルートの同期を簡略化とネットワーク トラフィックが軽減と呼ばれる、その他のルーターに接続している唯一のルーター。 ルート Reflector は、すべてのルートを学習、最適なルートの場合を計算し、その BGP クライアントへの最適なルートを再分配します。  
  
詳細については、次を参照してください。[RAS ゲートウェイの新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)します。  
  
### <a name="bkmk_pools"></a>ゲートウェイ プール  
Windows Server 2016 では、さまざまな種類の多くのゲートウェイ プールを作成できます。 ゲートウェイ プールでは、インスタンスを含む多くの RAS ゲートウェイは、および物理ネットワークと仮想ネットワーク間のネットワーク トラフィックをルーティングします。  
  
詳細については、次を参照してください。[RAS ゲートウェイの新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
### <a name="bkmk_gps"></a>ゲートウェイ プールのスケーラビリティ  
容易に拡張できるゲートウェイ プール上または下へを追加またはプール内のゲートウェイ Vm を削除します。 ゲートウェイの追加または取り外しにプールによって提供されるサービスが中断されません。 追加し、[ゲートウェイの全体のプールを削除することもできます。  
  
詳細については、次を参照してください。[RAS ゲートウェイの新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
### <a name="bkmk_m"></a>M と N ゲートウェイ プールの冗長性  
各ゲートウェイ プールは、M と N の冗長です。 つまり、[' active ゲートウェイ Vm の数がスタンバイのゲートウェイ Vm の数 n 個でバックアップします。 M と N の冗長性を使うより柔軟に RAS ゲートウェイを展開するときに必要な信頼性のレベルを決定します。  
  
詳細については、次を参照してください。[RAS ゲートウェイの新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
## <a name="bkmk_example"></a>展開の例  
次の図は、eBGP ピアリングでは 2 つのテナント、Contoso と Woodgrove と Fabrikam CSP データ センター間で構成されているサイト間 VPN 接続経由での例を示します。  
  
![eBGP ピアリングでは、サイト間 VPN 経由で](../../../media/RAS-Gateway-Deployment-Architecture/ras_gateway_architecture.png)  
  
この例では Contoso 追加ゲートウェイ帯域幅が必要、GW2 ではなく GW3 で Contoso ロサンゼルス サイトを終了するゲートウェイ インフラストラクチャ設計の決定につながます。 このため、2 つの異なるゲートウェイ上、CSP データ センター内の複数のサイトから Contoso の VPN 接続を終了します。  
  
CSP は、そのインフラストラクチャに Contoso と Woodgrove のテナントを追加するときに、ネットワーク コントローラーで構成されている最初の RAS ゲートウェイは GW2 と GW3、これらのゲートウェイの両方のでした。 このため、これら 2 つのゲートウェイは、これらの対応するお客様 (またはテナント) のルート リフレクタとして構成されます。 GW2 Contoso ルート Reflector は、GW3、Woodgrove ルート Reflector - だけでなく、Contoso ロサンゼルス本社サイトと VPN 接続の CSP RAS ゲートウェイの終了向いています。  
  
> [!NOTE]  
> 1 つの RAS ゲートウェイは、各テナントの帯域幅要件に応じて、最大 100 個のさまざまなテナントの仮想および物理ネットワーク トラフィックをルーティングできます。  
  
ルート リフレクタ、として GW2 は、ネットワーク コントローラーに Contoso の CA 空間のルートを送信し、GW3 Woodgrove CA 空間のルートにネットワーク コントローラー。  
  
ネットワーク コントローラーは、Contoso と Woodgrove の仮想ネットワークと RAS ポリシー、RAS ゲートウェイと負荷分散ソフトウェア負荷分散プールとして構成されている Multiplexers (MUXes) にポリシーを Hyper-V ネットワーク仮想化ポリシーをプッシュします。  
  
## <a name="bkmk_tenant"></a>追加新しいテナント、カスタマー アドレス (CA) 空間 eBGP ピアリング  
新規ユーザーをサインイン データ センター内の新しいテナントとして、顧客を追加すると、ネットワーク コントローラーと RAS ゲートウェイの eBGP ルーターによって自動的に実行されるは、次の手順を使用することができます。  
  
1.  新しい仮想ネットワークとテナントの要件に従ってワークロードをプロビジョニングします。  
  
2.  必要に応じて、データ センターで、リモート テナント エンタープライズ サイトとその仮想ネットワークの間でのリモート接続を構成します。 テナントのサイト間 VPN 接続を展開するときに、ネットワーク コントローラーは自動的に利用可能なゲートウェイ プールから可用性の RAS ゲートウェイ バーチャル マシンを選択し、な接続を構成します。  
  
3.  新しいテナントの RAS ゲートウェイ VM を構成中にネットワーク コントローラーも RAS ゲートウェイを BGP ルーターとして構成し、テナントのルート Reflector として指定します。 ここで、RAS ゲートウェイは機能はゲートウェイとしてまたはゲートウェイおよびルート Reflector、他のテナントのような場合であっても同様です。  
  
4.  かどうか CA 空間ルーティングが構成されているネットワークを使用して静的に構成されている動的 BGP ルーティングしたり、によっては、ネットワーク コントローラーは、対応する静的ルート、BGP 近隣ノード、またはその両方で、RAS ゲートウェイ VM およびルート Reflector を構成します。  
  
    > [!NOTE]  
    > -   ネットワーク コントローラーの構成がしたら RAS ゲートウェイおよびルート Reflector、テナントのたびに同じテナントが必要です新しいサイト間 VPN 接続では、ネットワーク コントローラーがこの RAS ゲートウェイ VM 上で利用可能な容量を確認します。 元のゲートウェイは、必要な容量を処理できる、新しいネットワーク接続が同じ RAS ゲートウェイ VM 上で構成されているもします。 RAS ゲートウェイ VM で処理能力の増強を処理できない場合、ネットワーク コントローラーは新しい可用性 RAS ゲートウェイのバーチャル マシンを選択し、上に新しい接続を構成します。 この新しい RAS ゲートウェイ VM をテナントに関連付けられているでは、元のテナント RAS ゲートウェイのルート Reflector のルート Reflector クライアントになります。  
    > -   RAS ゲートウェイ プール (SLBs) ソフトウェア ロード バランサーの背後にあるため、テナントのサイト間 VPN は単一のパブリック IP アドレス、SLBs によってエンタープライズ テナントのトラフィックをルーティングする RAS ゲートウェイの動的 IP アドレス (DIP) と呼ばれる、データ センター内部 IP アドレスに変換されている仮想 IP アドレス (VIP) と呼ばれる各使用を説明します。 SLB によってこの公開/秘密 IP アドレスのマッピングは、エンタープライズ サイトと CSP の RAS ゲートウェイ、およびルート リフレクタ間、サイト間 VPN トンネルが正しく確立されることを確認します。  
    >   
    >     SLB、Vip、および Dip に関する詳細については、次を参照してください。[ソフトウェアの負荷分散と #40 です。SLB & #41 です。SDN の](../../../sdn/technologies/network-function-virtualization/Software-Load-Balancing--SLB--for-SDN.md)します。  
  
5.  エンタープライズ サイトと新しいテナントの RAS ゲートウェイが確立されている CSP データ センター間でサイト間 VPN トンネルを後は、トンネルの両側をエンタープライズと CSP の両方にトンネルに関連付けられている静的ルートが自動的にプロビジョニングします。  
  
6.  CA の空き領域が BGP ルーティング、エンタープライズ サイトと CSP の RAS ゲートウェイのルート Reflector の間でピアリング eBGP も確立されます。  
  
## <a name="bkmk_route"></a>平面ルート同期とデータをルーティング  
エンタープライズ サイトと CSP の RAS ゲートウェイのルート Reflector 間 eBGP ピアリングが確立されると、ルート Reflector は動的 BGP ルーティングを使用してすべてのエンタープライズ ルートを学習します。 ルート Reflector は、すべてが、同じルートのセットで構成されているように、すべてのルート Reflector クライアント間でのこれらのルートを同期します。  
  
ルート Reflector には、ネットワーク コントローラーへのルートの同期を使用して、これらの統合ルートも更新されます。 ネットワーク コントローラーは、Hyper-V ネットワーク仮想化ポリシーのルートに変換し、End-to-End データ パスのルーティングがプロビジョニングされていることを確認するファブリック ネットワークを構成します。 このプロセスでは、テナント仮想ネットワークのエンタープライズ テナントからアクセス可能なサイト。  
  
データの平面のルーティングのパケット RAS ゲートウェイ Vm に到達する直接ルーティングに、テナントの仮想ネットワークのために必要なルートが参加している RAS ゲートウェイ バーチャル マシンのすべてで利用可能なようになりました。  
  
同様に、場所にインストールされた Hyper-v ネットワーク仮想化ポリシーを使用テナントの仮想ネットワーク パケットをルーティングし、次を使用せずにルート Reflector について知っておく) RAS ゲートウェイ Vm に直接エンタープライズ サイト、サイト間 VPN トンネルを経由します。  
  
さらに。 テナントの仮想ネットワークから、リモート テナント エンタープライズ サイトへのトラフィックの戻り値は、SLBs、Direct Server Return (DSR) と呼ばれるプロセスをバイパスします。  
  
## <a name="bkmk_failover"></a>ネットワーク コントローラーが RAS ゲートウェイおよびルート Reflector フェールオーバーにどのように応答する方法  
次に、次の 2 つのフェールオーバーが可能なシナリオの RAS ゲートウェイのルート Reflector クライアントと RAS ゲートウェイのルート リフレクタに 1 つのネットワーク コントローラーでの処理方法フェールオーバーの vm のいずれかの構成に関する情報も含まれます。  
  
### <a name="vm-failure-of-a-ras-gateway-bgp-route-reflector-client"></a>RAS ゲートウェイの BGP ルート Reflector クライアントの VM の障害発生  
ネットワーク コントローラーは、RAS ゲートウェイのルート Reflector クライアントが失敗したときに次の操作を実行します。  
  
> [!NOTE]  
> RAS ゲートウェイがテナントの BGP インフラストラクチャのルート Reflector でない場合は、テナントの BGP インフラストラクチャでルート Reflector クライアントです。  
  
-   ネットワーク コントローラーは、スタンバイ、利用可能な RAS ゲートウェイ VM を選択し、障害が発生した RAS ゲートウェイ VM の構成を持つ新しい RAS ゲートウェイ VM を準備します。  
  
-   ネットワーク コントローラーは、新しい RAS ゲートウェイと、障害が発生した RAS ゲートウェイへのテナント サイトからサイト間 VPN トンネルが正しく確立されていることを確認する、対応する SLB 構成を更新します。  
  
-   ネットワーク コントローラーは、新しいゲートウェイの BGP ルート Reflector クライアントを構成します。  
  
-   ネットワーク コントローラーは、アクティブとして新しい RAS ゲートウェイの BGP ルート Reflector クライアントを構成します。 RAS ゲートウェイは、すぐに、テナントのルート Reflector ルーティング情報を共有して eBGP ピアリングでは、対応するエンタープライズ サイトを有効にするとピアリングを開始します。  
  
### <a name="vm-failure-for-a-ras-gateway-bgp-route-reflector"></a>RAS ゲートウェイの BGP ルート Reflector の VM の失敗  
ネットワーク コントローラーは、RAS ゲートウェイの BGP ルート Reflector が失敗したときに次の操作を実行します。  
  
-   ネットワーク コントローラーは、スタンバイ、利用可能な RAS ゲートウェイ VM を選択し、障害が発生した RAS ゲートウェイ VM の構成を持つ新しい RAS ゲートウェイ VM を準備します。  
  
-   ネットワーク コントローラーは、新しい RAS ゲートウェイ VM 上でルート Reflector を構成し、新しい VM、VM エラーに関係なくルートの整合性を提供するため、障害が発生した VM によって使用されていたのと同じ IP アドレスを割り当てます。  
  
-   ネットワーク コントローラーは、新しい RAS ゲートウェイと、障害が発生した RAS ゲートウェイへのテナント サイトからサイト間 VPN トンネルが正しく確立されていることを確認する、対応する SLB 構成を更新します。  
  
-   ネットワーク コントローラーは、アクティブとして新しい RAS ゲートウェイ BGP ルート Reflector VM を構成します。  
  
-   ルート Reflector はすぐにアクティブになります。 エンタープライズ サイト間 VPN トンネルが確立されると、およびルート Reflector eBGP ピアリングを使用してルートがエンタープライズ サイト ルーターを交換します。  
  
-   BGP ルートを選択した後、RAS ゲートウェイの BGP ルート Reflector 更新プログラム、データ センター内のルート Reflector クライアントをテナントがありネットワーク コントローラー、テナント トラフィック用の End-to-End データ パスを作成することとルートを同期します。  
  
## <a name="bkmk_advantages"></a>RAS ゲートウェイの新機能を使用する利点  
RAS ゲートウェイ展開を設計する際にこれらの新しい RAS ゲートウェイ機能を使用する利点の一部を次に示します。  
  
**RAS ゲートウェイのスケーラビリティ**  
  
RAS ゲートウェイ プールする必要がある、多くの RAS ゲートウェイ Vm を追加するため、パフォーマンスと容量を最適化するために、RAS ゲートウェイ展開を簡単に拡大できます。 Vm をプールに追加する場合は、サイト間 VPN 接続の任意の種類 (IKEv2、L3、GRE)、ダウンタイムなしで容量ボトルネックを排除することでこれらの RAS ゲートウェイを構成できます。  
  
**簡素化されたエンタープライズ サイト ゲートウェイ管理**  
  
テナントに複数のエンタープライズ サイトがある場合、テナントは 1 つのリモート サイト間 VPN の IP アドレスを持つすべてのサイトとリモート近隣ノードの 1 つの IP アドレス - テナントの CSP データ センター RAS ゲートウェイの BGP ルート Reflector VIP を構成できます。 これには、テナントのゲートウェイ管理が簡略化します。  
  
**ゲートウェイの失敗の高速の修復**  
  
高速フェールオーバーの応答を確実には、edge ルートより小さいか等しいを 10 秒間の短時間間隔にコントロール ルーター間の BGP Keepalive パラメーター時間を構成できます。 この短い keep alive 間隔 RAS ゲートウェイの BGP のエッジ ルーターに失敗した場合、障害が検出されたすばやくとネットワーク コントローラーは、前のセクションで説明する手順を次に示します。 この利点は、個別のエラーの検出プロトコル、双方向の転送の検出 (成功) プロトコルなどの必要性を減る可能性があります。  
  
 
  


