---
title: RAS ゲートウェイの展開アーキテクチャ
description: このトピックを使用すると、RAS ゲートウェイ RAS ゲートウェイ プール、ルートのリフレクターを含む、個々 のテナント用の複数のゲートウェイの展開と Windows Server 2016 でのクラウド サービス プロバイダー (CSP) の展開について説明します。
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-sdn
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.assetid: d46e4e91-ece0-41da-a812-af8ab153edc4
ms.author: pashort
author: shortpatti
ms.openlocfilehash: a3895e25a2af0437deb9eebe4ad89b110cfc9f2b
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59870273"
---
# <a name="ras-gateway-deployment-architecture"></a>RAS ゲートウェイの展開アーキテクチャ

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

このトピックを使用すると、RAS ゲートウェイ RAS ゲートウェイ プールでは、ルート リフレクタ、個々 のテナント用の複数のゲートウェイの展開などのクラウド サービス プロバイダー (CSP) の展開について説明します。  
  
次のセクションでは、ゲートウェイの展開の設計ではこれらの機能を使用する方法を理解できるように RAS ゲートウェイの新機能のいくつかの簡単な概要を提供します。  
  
さらに、展開の例が提供される、新しいテナントをルートの同期とデータ プレーンのルーティング、ゲートウェイおよびルート Reflector フェールオーバー、および詳細の追加のプロセスに関する情報などです。  
  
このトピックは次のセクションで構成されます。  
  
-   [RAS ゲートウェイの新しい機能を使用して、展開を設計するには](#bkmk_new)  
  
-   [展開の例](#bkmk_example)  
  
-   [追加する新しいテナント、カスタマー アドレス (CA) 空間 EBGP ピアリング](#bkmk_tenant)  
  
-   [ルートの同期とデータ プレーンのルーティング](#bkmk_route)  
  
-   [ネットワーク コント ローラーが RAS ゲートウェイおよびルート Reflector のフェールオーバーにどのように応答する方法](#bkmk_failover)  
  
-   [RAS ゲートウェイの新機能を使用する利点](#bkmk_advantages)  
  
## <a name="bkmk_new"></a>RAS ゲートウェイの新しい機能を使用して、展開を設計するには  
RAS ゲートウェイには、複数の新機能変更して、データ センターで、ゲートウェイ インフラストラクチャを展開する方法を向上させることにはが含まれています。  
  
### <a name="bgp-route-reflector"></a>BGP ルート Reflector  
ボーダー ゲートウェイ プロトコル (BGP) ルート Reflector 機能が RAS ゲートウェイを使用して含まれており、通常、ルーター間のルートの同期に必要な BGP フル メッシュ トポロジの代替を提供します。 フル メッシュの同期では、すべての BGP ルーターは、ルーティング トポロジ内の他のすべてのルーターで接続する必要があります。 ルート Reflector を使用して、ただし、ルート Reflector は、すべての BGP ルート Reflector クライアント、ルートの同期を簡略化およびネットワーク トラフィックの減少と呼ばれる、その他のルーターに接続している唯一のルーターが。 ルート Reflector は、すべてのルートを学習、最適なルートを計算し、その BGP クライアントへの最適なルートを再分配します。  
  
詳細については、次を参照してください。 [RAS ゲートウェイで新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)します。  
  
### <a name="bkmk_pools"></a>ゲートウェイ プール  
Windows Server 2016 では、さまざまな種類の多くのゲートウェイ プールを作成できます。 ゲートウェイ プールでは、RAS ゲートウェイのインスタンスを多く含むし、物理および仮想ネットワーク間のネットワーク トラフィックをルーティングします。  
  
詳細については、次を参照してください。 [RAS ゲートウェイで新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
### <a name="bkmk_gps"></a>ゲートウェイ プールの拡張性  
簡単にスケールできますゲートウェイ プール アップまたはスケール ダウンを追加または、プール内のゲートウェイ Vm の削除します。 ゲートウェイの追加や削除がプールによって提供されるサービスを妨害しません。 追加し、ゲートウェイの全体のプールを削除することができます。  
  
詳細については、次を参照してください。 [RAS ゲートウェイで新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
### <a name="bkmk_m"></a>ゲートウェイ プールの M+N 冗長性  
すべてのゲートウェイ プールでは、冗長化の M と N です。 つまり、います 'active ゲートウェイ Vm の数がスタンバイ ゲートウェイ Vm 数は' n ' でバックアップします。 M+N 冗長性を提供するより柔軟に RAS ゲートウェイを展開するときに必要な信頼性レベルを決定します。  
  
詳細については、次を参照してください。 [RAS ゲートウェイで新](../../../sdn/technologies/network-function-virtualization/What-s-New-in-RAS-Gateway.md)と[RAS ゲートウェイの高可用性](../../../sdn/technologies/network-function-virtualization/RAS-Gateway-High-Availability.md)します。  
  
## <a name="bkmk_example"></a>展開の例  
次の図は、eBGP ピアリング経由でのサイト対サイト VPN 接続を 2 つのテナント、Contoso と Woodgrove、Fabrikam の CSP のデータ センターと構成の例を示します。  
  
![サイト対サイト VPN 経由でピアリング eBGP](../../../media/RAS-Gateway-Deployment-Architecture/ras_gateway_architecture.png)  
  
この例で、Contoso では別のゲートウェイの帯域幅を必要と GW2 ではなく GW3 で Contoso Los Angeles サイトを終了するゲートウェイ インフラストラクチャ設計の決定に 。 このため、2 つの異なるゲートウェイ上の CSP のデータ センターでさまざまなサイトから Contoso VPN 接続を終了します。  
  
CSP は、インフラストラクチャに Contoso と Woodgrove のテナントを追加すると、ネットワーク コント ローラーで構成されている最初の RAS ゲートウェイ GW2、GW3、これらのゲートウェイのどちらも指定されています。 このため、これら 2 つのゲートウェイは、これらの対応する顧客 (またはテナント) のルート リフレクタとして構成されます。 GW2 Contoso ルート Reflector、GW3 Woodgrove ルート Reflector の Contoso Los Angeles 本社サイトとの VPN 接続の CSP の RAS ゲートウェイの終了ポイントだけでなく、します。  
  
> [!NOTE]  
> RAS ゲートウェイは 1 つは、テナントごとの帯域幅要件に応じて、最大 100 個の異なるテナントの仮想および物理のネットワーク トラフィックをルーティングすることができます。  
  
ルートのリフレクターとして GW2 Contoso CA 空間のルートをネットワーク コント ローラーに送信して GW3 Woodgrove CA 空間のルートをネットワーク コント ローラーに送信します。  
  
ネットワーク コント ローラーは、Contoso と Woodgrove の仮想ネットワークと RAS ゲートウェイや負荷分散ポリシー、ソフトウェア負荷分散として構成されている Multiplexers (MUXes) に RAS ポリシーに、HYPER-V ネットワーク仮想化ポリシーをプッシュします。プール。  
  
## <a name="bkmk_tenant"></a>追加する新しいテナント、カスタマー アドレス (CA) 空間 eBGP ピアリング  
新しい顧客のサインイン、データ センターで新しいテナントとして、顧客を追加すると、ネットワーク コント ローラーと RAS ゲートウェイの eBGP ルーターによって自動的に実行されるは、次のプロセスを使用できます。  
  
1.  新しい仮想ネットワークとテナントの要件に従ってワークロードをプロビジョニングします。  
  
2.  必要に応じて、データ センターで、リモート テナント エンタープライズ サイトと、仮想ネットワーク間のリモート接続を構成します。 テナントのサイト対サイト VPN 接続を展開するときに、ネットワーク コント ローラーは自動的に使用可能なゲートウェイ プールから RAS ゲートウェイ VM を使用を選択し、接続を構成します。  
  
3.  新しいテナントの RAS ゲートウェイの VM を構成するときにネットワーク コント ローラーも BGP ルーターとして RAS ゲートウェイを構成し、テナント用のルート Reflector として指定します。 RAS ゲートウェイが、ゲートウェイとしてまたはゲートウェイおよびルート Reflector を他のテナントの機能での状況であっても同様です。  
  
4.  CA 空間ルーティング構成されているかを使用して静的に構成されているネットワークや動的 BGP ルーティング、によっては、ネットワーク コント ローラーは、対応する静的ルート、BGP 近隣ノードまたは RAS ゲートウェイの VM とルート Reflector の両方を構成します。  
  
    > [!NOTE]  
    > -   ネットワーク コント ローラーが構成した後、RAS ゲートウェイとルート Reflector では、テナントのたびに、同じテナントは、ネットワーク コント ローラーがこの RAS ゲートウェイの VM で利用可能な容量を確認、新しいサイト対サイト VPN 接続を必要があります。 元のゲートウェイは、必要な容量を処理できる、新しいネットワーク接続が RAS ゲートウェイ VM で構成されているもします。 RAS ゲートウェイの VM は、追加の容量を処理できない場合、ネットワーク コント ローラーが使用可能な RAS ゲートウェイの新しい VM を選択しで新しい接続を構成します。 この新しい RAS ゲートウェイ VM に関連付けられたテナントでは、RAS ゲートウェイ ルート Reflector の元のテナントのルート Reflector クライアントになります。  
    > -   データ センター内部 IP アドレスに、SLBs で翻訳される仮想 IP アドレス (VIP) と呼ばれる 1 つパブリック IP アドレスを使用して、各テナントのサイト対サイト VPN アドレスと呼ばれる RAS ゲートウェイ プールでソフトウェア ロード バランサー (SLBs) の背後にあるため、動的 IP アドレス (DIP) RAS ゲートウェイ エンタープライズ テナントのトラフィックをルーティングします。 SLB でこのパブリック、プライベート IP アドレスのマッピングによりエンタープライズ サイトと CSP の RAS ゲートウェイ ルート リフレクタとサイト対サイト VPN トンネルが正しく確立されているようになります。  
    >   
    >     SLB、Vip、および Dip に関する詳細については、次を参照してください。[ソフトウェアの負荷分散&#40;SLB&#41; SDN の](../../../sdn/technologies/network-function-virtualization/Software-Load-Balancing--SLB--for-SDN.md)します。  
  
5.  エンタープライズ サイトと RAS ゲートウェイを確立する新しいテナントの CSP のデータ センター間のサイト対サイト VPN トンネル、後に、トンネルに関連付けられている静的ルートは自動的にトンネルのエンタープライズと CSP の両方の側でプロビジョニングします.  
  
6.  CA 空間 BGP のルーティング、エンタープライズ サイトと CSP の RAS ゲートウェイ ルート Reflector 間のピアリング eBGP も確立されます。  
  
## <a name="bkmk_route"></a>ルートの同期とデータ プレーンのルーティング  
エンタープライズ サイトと CSP の RAS ゲートウェイ ルート Reflector の eBGP ピアリングが確立された後、ルート Reflector は動的 BGP ルーティングを使用してすべてのエンタープライズ ルートを学習します。 ルート Reflector のすべてのルート Reflector クライアントの間でこれらのルートが同期するすべてのルートの同じセットで構成されます。  
  
ルート Reflector には、ネットワーク コント ローラーに、ルートの同期を使用してこれらの統合のルートも更新されます。 ネットワーク コント ローラーは、HYPER-V ネットワーク仮想化ポリシーのルートに変換し、エンド ツー エンドのデータ パスのルーティングがプロビジョニングされていることを確認するファブリック ネットワークを構成します。 このプロセスで、テナントは、エンタープライズ テナントからアクセスできる仮想ネットワーク サイト。  
  
データ プレーンのルーティングは、必要なルートはすべての参加の RAS ゲートウェイ Vm で使用できるようになりましたので、RAS ゲートウェイの Vm に到達したパケットをテナントの仮想ネットワークにルーティングされます直接。  
  
同様で、HYPER-V ネットワーク仮想化ポリシーを適用するには、テナントの仮想ネットワーク パケットをルーティング (ルート Reflector について知っておくことが必要な) なしの RAS ゲートウェイ Vm に直接、エンタープライズ サイトにし、サイト対サイト VPN トンネル経由で.  
  
さらに。 リモート テナント エンタープライズ サイトに、テナントの仮想ネットワークからの戻りトラフィックでは、SLBs、Direct Server Return (DSR) と呼ばれるプロセスをバイパスします。  
  
## <a name="bkmk_failover"></a>ネットワーク コント ローラーが RAS ゲートウェイおよびルート Reflector のフェールオーバーにどのように応答する方法  
次に、2 つの可能性のあるフェールオーバー シナリオの RAS ゲートウェイ ルート Reflector クライアントと RAS ゲートウェイ ルート リフレクタに 1 つのネットワーク コント ローラーの処理方法フェールオーバー Vm のいずれかの構成に関する情報などです。  
  
### <a name="vm-failure-of-a-ras-gateway-bgp-route-reflector-client"></a>RAS ゲートウェイの BGP ルート Reflector クライアントの VM の障害  
ネットワーク コント ローラーは、RAS ゲートウェイ ルート Reflector クライアントが失敗した場合の次のアクションを実行します。  
  
> [!NOTE]  
> RAS ゲートウェイがテナントの BGP インフラストラクチャ ルート Reflector でない場合は、テナントの BGP のインフラストラクチャでルート Reflector クライアントです。  
  
-   ネットワーク コント ローラーは、使用可能なスタンバイ RAS ゲートウェイ VM を選択し、失敗した RAS ゲートウェイ VM の構成に新しい RAS ゲートウェイ VM をプロビジョニングします。  
  
-   ネットワーク コント ローラーは、新しい RAS ゲートウェイで、失敗した RAS ゲートウェイへのテナント サイトのサイト対サイト VPN トンネルが正しく確立されていることを確認する、対応する SLB 構成を更新します。  
  
-   ネットワーク コント ローラーは、新しいゲートウェイの BGP ルート Reflector クライアントを構成します。  
  
-   ネットワーク コント ローラーは、アクティブとして新しい RAS ゲートウェイの BGP ルート Reflector クライアントを構成します。 RAS ゲートウェイは、ピアリング ルーティング情報を共有して、対応するエンタープライズ サイトの eBGP ピアリングを有効にする、テナントのルート Reflector をすぐに開始します。  
  
### <a name="vm-failure-for-a-ras-gateway-bgp-route-reflector"></a>RAS ゲートウェイの BGP ルート reflector VM の障害  
ネットワーク コント ローラーは、RAS ゲートウェイの BGP ルート Reflector が失敗した場合の次のアクションを実行します。  
  
-   ネットワーク コント ローラーは、使用可能なスタンバイ RAS ゲートウェイ VM を選択し、失敗した RAS ゲートウェイ VM の構成に新しい RAS ゲートウェイ VM をプロビジョニングします。  
  
-   ネットワーク コント ローラーは、新しい RAS ゲートウェイの VM でルート Reflector を構成し、新しい VM に VM の障害に関係なくルートの整合性を提供するため、失敗した VM で使用された同じ IP アドレスを割り当てます。  
  
-   ネットワーク コント ローラーは、新しい RAS ゲートウェイで、失敗した RAS ゲートウェイへのテナント サイトのサイト対サイト VPN トンネルが正しく確立されていることを確認する、対応する SLB 構成を更新します。  
  
-   ネットワーク コント ローラーは、アクティブとして新しい RAS ゲートウェイ BGP ルート Reflector VM を構成します。  
  
-   ルート Reflector は、すぐにアクティブになります。 エンタープライズ サイト対サイト VPN トンネルが確立されると、およびルート Reflector は、eBGP ピアリングを使用し、エンタープライズ サイトのルーターにルートを交換します。  
  
-   BGP ルートを選択した後は、RAS ゲートウェイの BGP ルート Reflector の更新プログラムは、データ センター内のルート Reflector のクライアントをテナントし、エンド ツー エンドのデータ パスをテナント トラフィックを利用できるように、ネットワーク コント ローラーとルートを同期します。  
  
## <a name="bkmk_advantages"></a>RAS ゲートウェイの新機能を使用する利点  
RAS ゲートウェイの展開を設計するときに、RAS ゲートウェイのこれらの新機能を使用する利点のいくつかを次に示します。  
  
**RAS ゲートウェイのスケーラビリティ**  
  
RAS ゲートウェイ プールに必要な数の RAS ゲートウェイ Vm を追加するため、パフォーマンスと容量を最適化するために、RAS ゲートウェイの展開を簡単にスケールできます。 プールに Vm を追加する場合は、サイト対サイト VPN 接続の任意の種類 (IKEv2、L3、GRE)、ダウンタイムなしで容量ボトルネックを排除することでこれらの RAS ゲートウェイを構成できます。  
  
**簡略化されたエンタープライズ サイト ゲートウェイ管理**  
  
テナントに複数のエンタープライズ サイトがある場合は、テナントは 1 つのリモート サイト対サイト VPN IP アドレスを持つすべてのサイトとリモート近隣ノードの 1 つの IP アドレス - そのテナントの CSP データ センター RAS ゲートウェイの BGP ルート Reflector VIP を構成できます。 これには、テナントのゲートウェイの管理が簡略化します。  
  
**ゲートウェイのエラーの高速の修復**  
  
高速フェールオーバーの応答を確実には、edge のルートと 10 秒以下などの短い期間に、コントロールのルーター間の BGP Keepalive パラメーター時間を構成できます。 この短い keep alive 間隔で、エラーが検出されるすばやく RAS ゲートウェイの BGP のエッジ ルーターに失敗した場合と、ネットワーク コント ローラーが前のセクションで説明する手順に従います。 この利点は、別個の障害の検出プロトコル、双方向転送検出 (成功) プロトコルなどの必要性を減らす可能性があります。  
  
 
  


