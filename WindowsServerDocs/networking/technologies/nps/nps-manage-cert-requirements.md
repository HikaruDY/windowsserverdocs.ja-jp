---
title: PEAP と EAP の要件に合わせて証明書テンプレートを構成する
description: このトピックでは、ネットワーク ポリシー サーバーと Windows Server 2016 でのリモート アクセス証明書の使用に関する情報を提供します。
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 2af0a1df-5c44-496b-ab11-5bc340dc96f0
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 41f6f88705fa3d58be695fd825d960e7df21cd24
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59885883"
---
# <a name="configure-certificate-templates-for-peap-and-eap-requirements"></a>PEAP と EAP の要件に合わせて証明書テンプレートを構成する

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

拡張認証プロトコルでネットワーク アクセスの認証に使用される証明書をすべて\-トランスポート層セキュリティ\(EAP\-TLS\)、Protected の Extensible Authentication Protocol\-トランスポート層セキュリティ\(PEAP\-TLS\)、および PEAP\-Microsoft チャレンジ ハンドシェイク認証プロトコル バージョン 2 \(MS\-CHAP v2\)する必要がありますX.509 証明書の要件を満たし、Secure Socket Layer/トランスポート レベルのセキュリティ (SSL/TLS) を使用する接続の動作します。 クライアントとサーバーの両方の証明書では、追加の要件があります。

>[!IMPORTANT]
>ここでは、証明書テンプレートを構成する手順について説明します。 これらの手順を使用する必要が公開キー基盤を展開した\(PKI\) Active Directory 証明書サービス\(AD CS\)します。

## <a name="minimum-server-certificate-requirements"></a>最小サーバー証明書の要件

PEAP と\-MS\-CHAP v2、PEAP\-TLS、または EAP\-TLS 認証方法として、NPS は最小サーバー証明書の要件を満たしているサーバー証明書を使用する必要があります。 

クライアント コンピューターを使用してサーバー証明書を検証するように構成できる、**サーバー証明書を検証**クライアント コンピューターまたはグループ ポリシー オプション。 

クライアント コンピューターでは、サーバー証明書は、次の要件を満たす場合、サーバーの認証の試行は受け入れます。

- サブジェクト名には、値が含まれています。 空白のサブジェクト名を持つネットワーク ポリシー サーバー (NPS) を実行しているサーバーに証明書を発行した場合は、証明書は、NPS の認証に使用できません。 サブジェクト名を持つ証明書テンプレートを構成します。

    1. 証明書テンプレートを開きます。
    2. 詳細ペインで、変更し、クリックする証明書テンプレートを右クリックして**プロパティ**します。
    3. をクリックして、**サブジェクト名**タブをクリックし、をクリックし、 **Active Directory の情報から構築**します。
    4. **サブジェクト名の形式**、以外の値を選択**None**します。

- 信頼されたルート証明機関 (CA) とリモート アクセス ポリシーまたはネットワーク ポリシーで指定された、CryptoAPI によって実行されるチェックのいずれかを合格にサーバーのチェーン コンピューター証明書。

- NPS または VPN サーバーのコンピューター証明書は、拡張キー使用法 (EKU) 拡張にサーバー認証目的で構成されます。 (サーバー認証オブジェクト識別子は、1.3.6.1.5.5.7.3.1 です)。

- 必須の暗号化を使用して、サーバー証明書を構成します。

    1. 証明書テンプレートを開きます。
    2. 詳細ペインで、変更し、クリックする証明書テンプレートを右クリックして**プロパティ**します。
    3. をクリックして、**暗号化**タブし、次を構成することを確認します。
       - **プロバイダーのカテゴリ。** キー ストレージ プロバイダー
       - **アルゴリズム名:** RSA
       - **プロバイダー:** Microsoft プラットフォーム暗号化プロバイダー
       - **最小キー サイズ:** 2048
       - **ハッシュ アルゴリズム:** SHA2
    4. **[次へ]** をクリックします。

- サブジェクトの別名 (SubjectAltName) 拡張機能を使用する場合が、サーバーの DNS 名を含める必要があります。 登録するサーバーのドメイン ネーム システム (DNS) 名で、証明書テンプレートを構成します。 

    1. 証明書テンプレートを開きます。
    2. 詳細ペインで、変更し、クリックする証明書テンプレートを右クリックして**プロパティ**します。
    3. をクリックして、**サブジェクト名**タブをクリックし、をクリックし、 **Active Directory の情報から構築**します。
    4. **サブジェクトの別名にこの情報を含める**、 **DNS 名**します。

PEAP と EAP-TLS を使用する場合、NPSs は次の例外がコンピューターの証明書ストアにインストールされているすべての証明書の一覧を表示します。

- EKU 拡張にサーバー認証の目的を含まない証明書は表示されません。

- サブジェクト名を含まない証明書は表示されません。

- レジストリ ベースのスマート カード ログオン証明書は表示されません。

詳細については、次を参照してください。 [802.1 X ワイヤードおよびワイヤレス展開用のサーバー証明書の展開](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments)します。

## <a name="minimum-client-certificate-requirements"></a>最小限のクライアント証明書の要件

EAP-TLS または PEAP-TLS では、サーバーは、証明書が、次の要件を満たしている場合、クライアント認証の試行を受け入れます。

- クライアント証明書がエンタープライズ CA によって発行された、または Active Directory Domain Services でのユーザーまたはコンピューター アカウントにマップされている\(AD DS\)します。

- 信頼されたルート CA をクライアントのチェーン内のユーザーまたはコンピューターの証明書には EKU 拡張にクライアント認証の目的が含まれています\(クライアント認証用オブジェクト識別子は 1.3.6.1.5.5.7.3.2\)、どちらも失敗して、CryptoAPI により実行されると、NPS ネットワーク ポリシーで指定されている証明書オブジェクト識別子チェックも、リモート アクセス ポリシーまたはネットワーク ポリシーで指定されているを確認します。

- 802.1 X クライアントでは、いずれかのスマート カード ログオンはレジストリ ベースの証明書またはパスワードで保護された証明書は使用しません。

- ユーザー証明書、サブジェクトの別名の\(SubjectAltName\)証明書の拡張機能には、ユーザー プリンシパル名が含まれています。 \(UPN\)します。 UPN で証明書テンプレートを構成するには

    1. 証明書テンプレートを開きます。
    2. 詳細ペインで、変更し、クリックする証明書テンプレートを右クリックして**プロパティ**します。
    3. をクリックして、**サブジェクト名**タブをクリックし、をクリックし、 **Active Directory の情報から構築**します。
    4. **サブジェクトの別名にこの情報を含める**、**ユーザー プリンシパル名\(UPN\)** します。

- コンピューターの証明書、サブジェクトの別名の\(SubjectAltName\)証明書の拡張機能は、完全修飾ドメイン名を含める必要があります\(FQDN\) とも呼ばれると、クライアントの*DNS 名*します。 証明書テンプレートには、この名前を構成します。

    1. 証明書テンプレートを開きます。
    2. 詳細ペインで、変更し、クリックする証明書テンプレートを右クリックして**プロパティ**します。
    3. をクリックして、**サブジェクト名**タブをクリックし、をクリックし、 **Active Directory の情報から構築**します。
    4. **サブジェクトの別名にこの情報を含める**、 **DNS 名**します。

PEAP と\-TLS および EAP\-TLS でクライアントの一覧を表示すべてインストールされている証明書、証明書スナップインで、次の例外。

- ワイヤレス クライアントをレジストリに基づいた表示しないとスマート カード ログオン証明書。 

- ワイヤレス クライアントと VPN クライアントでは、パスワードで保護された証明書は表示されません。 

- EKU 拡張にクライアント認証の目的を含まない証明書は表示されません。


NPS の詳細については、次を参照してください。[ネットワーク ポリシー サーバー (NPS)](nps-top.md)します。
