---
title: NPS を RADIUS プロキシとして計画する
description: このトピックでは、ネットワーク ポリシー サーバーの RADIUS プロキシの展開に Windows Server 2016 での計画に関する情報を提供します。
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: ca77d64a-065b-4bf2-8252-3e75f71b7734
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 83fbe57ee62480439190dcc53428e02a4f8e6897
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59829563"
---
# <a name="plan-nps-as-a-radius-proxy"></a>NPS を RADIUS プロキシとして計画する

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

リモート認証ダイヤルイン ユーザー サービスとしてネットワーク ポリシー サーバー (NPS) を展開するときに\(RADIUS\)プロキシ、NPS がネットワーク アクセス サーバーまたは他の RADIUS プロキシなどの RADIUS クライアントから接続要求を受信し、NPS または他の RADIUS サーバーを実行するサーバーにこれらの接続要求を転送します。 これらの計画ガイドラインを使用するには、RADIUS デプロイを簡略化します。

これらの計画ガイドラインでは、NPS を RADIUS サーバーとして展開する状況は含まれません。 RADIUS サーバーとして機能する NPS を展開するときに、NPS は、ローカル ドメインとローカルのドメインを信頼する接続要求の認証、承認、およびアカウンティングを実行します。

NPS を RADIUS プロキシとして、ネットワーク上を展開する前に、展開を計画して、次のガイドラインを使用します。

- NPS 構成を計画します。

- RADIUS クライアントを計画します。

- リモート RADIUS サーバー グループを計画します。

- メッセージ転送の属性の操作規則を計画します。

- 接続要求ポリシーを計画します。

- NPS のアカウンティングを計画します。

## <a name="plan-nps-configuration"></a>NPS 構成を計画します。

NPS を RADIUS プロキシとして使用する場合、NPS は NPS または他の RADIUS サーバーで処理する接続要求を転送します。 このため、NPS プロキシのドメイン メンバーシップは関係ありません。 プロキシは Active Directory Domain Services に登録する必要はありません\(AD DS\)ユーザー アカウントのダイヤルイン プロパティへのアクセスが必要がないためです。 さらに、プロキシが接続要求の承認を実行しないために、NPS プロキシのネットワーク ポリシーを構成する必要はありません。 NPS プロキシ ドメイン メンバーであることができますか、ドメイン メンバーシップなしのスタンドアロン サーバーであることができます。

NPS は、RADIUS クライアント、RADIUS プロトコルを使用して、ネットワーク アクセス サーバーとも呼ばれますと通信するように構成する必要があります。 さらに、構成できますイベントの種類を記録する NPS イベント ログは、サーバーの説明を入力できます。

### <a name="key-steps"></a>主要な手順

NPS プロキシ構成を計画する際に、次の手順を使用することができます。

- NPS プロキシを使用して RADIUS クライアントから RADIUS メッセージを受信し、リモート RADIUS サーバー グループのメンバーに RADIUS メッセージを送信する RADIUS ポートを決定します。 既定のユーザー データグラム プロトコル (UDP) ポートは、1812 および 1645 RADIUS 認証メッセージおよび UDP ポート 1813 および 1646 RADIUS アカウンティング メッセージ用です。

- 複数のネットワーク アダプター、NPS プロキシを構成する場合は、RADIUS トラフィックを許可するときに経由するアダプターを決定します。

- Nps イベント ログに記録するイベントの種類を決定します。 接続が拒否された要求、成功した接続要求、またはその両方にログインすることができます。

- 1 つ以上の NPS プロキシを展開するかどうかを決定します。 フォールト トレランスを提供するには、少なくとも 2 つの NPS プロキシを使用します。 1 つの NPS プロキシをプライマリ RADIUS プロキシとして使用して、もう一方はバックアップとして使用します。 各 RADIUS クライアントは、両方の NPS プロキシにし、構成されます。 プライマリの NPS プロキシが使用できなくなった場合 RADIUS クライアントは別の NPS プロキシにアクセス要求メッセージを送信します。

- 管理オーバーヘッドを保存して、サーバーの構成が正しくないようにするのには、他の NPS プロキシに 1 つの NPS プロキシ構成をコピーするためのスクリプトを計画します。 NPS は NPS プロキシ構成を別の NPS プロキシにインポートのすべてまたは一部をコピーするための Netsh コマンドを提供します。 コマンドは、Netsh プロンプトから手動で実行できます。 ただし、スクリプトとして、コマンドのシーケンスを保存する場合、プロキシ構成を変更する場合、後で、スクリプトを実行できます。

## <a name="plan-radius-clients"></a>RADIUS クライアントを計画します。

RADIUS クライアントは、仮想プライベート ネットワークのワイヤレス アクセス ポイントなどのネットワーク アクセス サーバー \(VPN\)サーバー、802.1 X 対応スイッチ、およびダイアル アップ サーバー。 要求メッセージを RADIUS サーバー、接続を転送する RADIUS プロキシが RADIUS クライアントもあります。 RFC 2865 の「すべてのネットワーク アクセス サーバーと RADIUS プロキシは、RADIUS プロトコル準拠 NPS がサポート"リモート認証ダイヤルイン ユーザー サービス\(RADIUS\)、"および RFC 2866 の「RADIUS Accounting"。

さらに、ワイヤレス アクセス ポイントとスイッチの両方は 802.1 X 認証に対応する必要があります。 拡張認証プロトコル (EAP) または保護されている拡張認証プロトコル (PEAP) をデプロイする場合は、アクセス ポイントとスイッチは EAP の使用をサポートする必要があります。

ワイヤレス アクセス ポイントの PPP 接続用の基本的な相互運用性をテストするには、アクセス ポイントとパスワード認証プロトコル (PAP) を使用するアクセス クライアントを構成します。 ネットワーク アクセスに使用するものをテストするまでは、PEAP などの追加 (PPP) ベースの認証プロトコルを使用します。

### <a name="key-steps"></a>主要な手順

RADIUS クライアントを計画する際に、次の手順を使用することができます。

- ドキュメント、ベンダー固有属性 (Vsa) が NPS に構成する必要があります。 Nas は、Vsa を必要とする場合は、NPS で、ネットワーク ポリシーを構成するときに、後で使用 VSA 情報を記録します。

- すべてのデバイスの構成を簡略化には、RADIUS クライアントと NPS プロキシの IP アドレスを文書化します。 RADIUS クライアントを展開するときに認証サーバーとして入力された NPS プロキシ IP アドレス、RADIUS プロトコルを使用するように構成する必要があります。 RADIUS クライアントと通信するように NPS を構成するときに、NPS スナップインに RADIUS クライアントの IP アドレスを入力する必要があります。

- RADIUS クライアントと NPS スナップインでは、構成の共有シークレットを作成します。 共有シークレット、または NPS の RADIUS クライアントを構成するときに、NPS スナップインにも入力するパスワードでは、RADIUS クライアントを構成する必要があります。

## <a name="plan-remote-radius-server-groups"></a>リモート RADIUS サーバー グループを計画します。

NPS プロキシのリモート RADIUS サーバー グループを構成するときに、一部またはすべての接続のネットワーク アクセス サーバーと NPS プロキシまたは他の RADIUS プロキシから受信する要求メッセージの送信先を NPS プロキシに通知されます。

NPS を使用するには、接続を転送する RADIUS プロキシが要求を 1 つまたは複数のリモート RADIUS サーバー グループ、および各グループには、1 つ以上の RADIUS サーバーを含めることができます。 複数のグループにメッセージを転送するように、NPS プロキシを設定する場合は、グループごとに 1 つの接続要求ポリシーを構成します。 接続要求ポリシーには、属性の操作規則、ポリシーで指定されたリモート RADIUS サーバー グループに送信するには、どのメッセージを NPS プロキシに指示するなどの追加情報が含まれています。

NPS の Netsh コマンドを使用して、リモート RADIUS サーバー グループでは、NPS スナップインで直接グループを構成することで、または新しい接続要求ポリシー ウィザードを実行して、リモート RADIUS サーバー グループを構成することができます。

### <a name="key-steps"></a>主要な手順

リモート RADIUS サーバー グループを計画する際に、次の手順を使用することができます。

- NPS プロキシに接続要求を転送する RADIUS サーバーを含むドメインを決定します。 これらのドメインには、展開する RADIUS クライアント経由でネットワークに接続するユーザーのユーザー アカウントが含まれます。

- 新しい RADIUS サーバーを RADIUS が既に展開されていないドメインに追加する必要があるかどうかを決定します。

- リモート RADIUS サーバー グループに追加する RADIUS サーバーの IP アドレスを文書化します。

- 作成する必要がある数のリモート RADIUS サーバー グループを決定します。 場合によっては、各ドメインでは、リモート RADIUS サーバー グループを 1 つを作成し、グループにドメインの RADIUS サーバーを追加することをお勧めします。 ただし、ドメイン、ドメイン コント ローラーの数が多いと多数の RADIUS サーバーで多数のユーザー アカウントを使ってユーザーを含む 1 つのドメインで大量のリソースが場合があります。 または、ドメインにすると、互いに離れている場所にネットワーク アクセス サーバーと RADIUS サーバーがあることになり、大規模な地理的領域をカバー可能性があります。 これらと可能性がありますそれ以外の場合、複数のリモート RADIUS サーバー グループごとのドメインを作成できます。

- NPS プロキシとリモート RADIUS サーバーは、構成の共有シークレットを作成します。

## <a name="plan-attribute-manipulation-rules-for-message-forwarding"></a>メッセージ転送の属性の操作規則を計画します。

接続要求ポリシー構成の属性の操作規則を使用すると、特定のリモート RADIUS サーバー グループに転送するアクセス要求メッセージを識別することができます。

属性の操作規則を使用せず、1 つのリモート RADIUS サーバー グループにすべての接続要求を転送するように NPS を構成することができます。

接続要求を転送する 1 つ以上の場所があれば、ただし、する必要があります場所ごとに、接続要求ポリシーを作成し、リモート RADIUS サーバー グループがメッセージを転送すると、ポリシーを構成するだけでなくで転送するメッセージを NPS に指示する属性の操作規則。

次の属性のルールを作成することができます。

- 呼ばれるステーション id ネットワーク アクセス サーバー (NAS) の電話番号。 この属性の値は、文字の文字列です。 パターン マッチング構文を使用すると、市外局番を指定します。

- 呼び出し元のステーションの id。 呼び出し元の電話番号。 この属性の値は、文字の文字列です。 パターン マッチング構文を使用すると、市外局番を指定します。

- ユーザー名。 ユーザー名は、アクセス クライアントによって提供されると、nas から RADIUS Access-request メッセージに含まれています。 この属性の値とは、通常、領域名とユーザー アカウント名を含む文字列です。

正しく置換または接続要求のユーザー名の領域名を変換する、適切な接続要求ポリシーでユーザー名属性の属性の操作規則を構成する必要があります。

### <a name="key-steps"></a>主要な手順

属性の操作規則を計画する際に、次の手順を使用することができます。

- RADIUS サーバーにメッセージを転送に使用する論理パスがあることを確認するリモート RADIUS サーバーに、プロキシ経由の NAS からメッセージのルーティングを計画します。

- 各接続要求ポリシーを使用する 1 つまたは複数の属性を決定します。

- 各接続要求ポリシーで使用する属性の操作規則を文書化し、メッセージの転送先にリモート RADIUS サーバー グループのルールに一致します。

## <a name="plan-connection-request-policies"></a>接続要求ポリシーを計画します。

RADIUS サーバーとして使用した場合、NPS の既定の接続要求ポリシーが構成されます。 特定の条件を定義する属性を作成するには、リモートの RADIUS サーバー グループに転送して、高度な属性を指定するメッセージを NPS に指示するための操作規則は、追加の接続要求ポリシーを使用できます。 新しい接続要求ポリシー ウィザードを使用して、一般的なまたはカスタムのいずれかの接続要求ポリシーを作成します。

### <a name="key-steps"></a>主要な手順

接続要求ポリシーを計画する際に、次の手順を使用することができます。

- RADIUS プロキシとしてのみ機能する NPS を実行する各サーバーの既定の接続要求ポリシーを削除します。

- 追加の条件とリモート RADIUS サーバー グループとポリシーの計画的な属性の操作規則でこの情報を組み合わせることの各ポリシーについて、必要な設定を計画します。

- すべての NPS プロキシへの一般的な接続要求ポリシーを配布する計画を設計します。 1 つの NPS で複数の NPS プロキシに共通のポリシーを作成し、NPS の Netsh コマンドを使用して、その他のすべてのプロキシに接続要求ポリシーおよびサーバー構成をインポートします。

## <a name="plan-nps-accounting"></a>NPS のアカウンティングを計画します。

NPS を RADIUS プロキシとして構成するときに、RADIUS NPS の形式のログ ファイル、データベースと互換性のある形式のログ ファイル、または NPS の SQL Server を使用して、アカウンティング ログ記録を実行するように構成できます。

これらのログ記録形式のいずれかを使用して、アカウンティングを実行するリモート RADIUS サーバー グループをアカウンティング メッセージを転送することもできます。

### <a name="key-steps"></a>主要な手順

NPS のアカウンティングを計画する際に、次の手順を使用することができます。

- NPS プロキシ アカウンティングのサービスを実行するか、アカウンティング用のリモート RADIUS サーバー グループにアカウンティング メッセージを転送するかどうかを決定します。

- アカウンティングの他のサーバーにアカウンティング メッセージを転送する予定の場合、ローカルの NPS プロキシを無効にする予定です。

- 他のサーバーにアカウンティング メッセージを転送する予定の場合は、接続要求ポリシーの構成手順を計画します。 NPS プロキシのローカル アカウンティングを無効にすると、そのプロキシを構成する各接続要求ポリシーがアカウンティング メッセージ転送を有効にし、適切に構成に必要です。

- 使用するログ記録形式を決定します。IAS 形式のログ ファイル、データベースと互換性のある形式のログ ファイル、または SQL サーバーの NPS のログ記録します。

RADIUS プロキシとして機能する NPS の負荷分散を構成するを参照してください。 [NPS プロキシ サーバーの負荷分散](nps-manage-proxy-lb.md)します。

