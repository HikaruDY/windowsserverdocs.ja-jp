---
title: NPS を RADIUS プロキシとして計画します。
description: このトピックでは、ネットワーク ポリシー サーバーの RADIUS プロキシ展開の Windows Server 2016 の計画に関する情報を提供します。
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: ca77d64a-065b-4bf2-8252-3e75f71b7734
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 966e555ebcac6c7daf4a26b322f0d29f023f8539
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
---
# <a name="plan-nps-as-a-radius-proxy"></a>NPS を RADIUS プロキシとして計画します。

>適用対象: Windows Server (半期チャネル)、Windows Server 2016

リモート認証ダイヤルイン ユーザー サービス \(RADIUS\) プロキシとしてネットワーク ポリシー サーバー (NPS) を展開するときに、NPS はネットワーク アクセス サーバーなどの RADIUS クライアントからの接続要求または他の RADIUS プロキシを受信し、NPS または他の RADIUS サーバーを実行しているサーバーにこれらの接続要求を転送します。 これらの計画のガイドラインを使用すると、RADIUS 展開を簡略化します。

これらの計画のガイドラインでは、NPS を RADIUS サーバーとして展開する場合は含まれません。 RADIUS サーバーとしての NPS を展開するときに、NPS は、ローカル ドメインと、ローカル ドメインを信頼するドメインの場合、接続要求に対する認証、承認、およびアカウンティングを実行します。

NPS を RADIUS プロキシとして、ネットワーク上で展開する前に、展開を計画して、次のガイドラインを使用します。

- NPS サーバーの構成を計画します。

- RADIUS クライアントを計画します。

- リモート RADIUS サーバー グループを計画します。

- メッセージの転送の属性の操作の規則を計画します。

- 接続要求ポリシーを計画します。

- NPS アカウンティングを計画します。

## <a name="plan-nps-server-configuration"></a>NPS サーバーの構成を計画します。

NPS を RADIUS プロキシとして使用すると、NPS が NPS サーバーまたは処理のためには、他の RADIUS サーバーへの接続要求を転送します。 このため、NPS のプロキシのドメインのメンバーシップは関係ありません。 プロキシは、ユーザー アカウントのダイヤルイン プロパティへのアクセスが必要がないために、Active Directory Domain Services \(AD DS\) に登録する必要はありません。 さらに、プロキシが接続要求の承認を実行しないために、NPS プロキシでネットワーク ポリシーを構成する必要はありません。 NPS プロキシは、ドメイン メンバーであることができます、またはドメインのメンバーシップがないとスタンドアロン サーバーであることができます。

NPS は、RADIUS プロトコルを使用して、ネットワーク アクセス サーバーとも呼ばれます、RADIUS クライアントと通信するように構成する必要があります。 さらに、構成できますイベントの種類 NPS を記録するイベント ログとするサーバーの説明を入力できます。

### <a name="key-steps"></a>主要な手順

NPSプロキシ構成の計画段階で、次の手順を使用することができます。

- RADIUS ポート NPS プロキシを使用して RADIUS クライアントから RADIUS メッセージを受信し、リモート RADIUS サーバー グループのメンバーに RADIUS メッセージを送信することを確認します。 既定のユーザー データグラム プロトコル (UDP) ポート 1812、RADIUS 認証メッセージおよび UDP ポート 1813 と RADIUS アカウンティング メッセージ 1646 1645 です。

- NPS プロキシが複数のネットワーク アダプターで構成されている場合は、RADIUS トラフィックを許可するときに経由するアダプターを決定します。

- Nps でイベント ログに記録するイベントの種類を決定します。 接続が拒否された要求、成功した接続要求の場合、またはその両方をログインすることができます。

- 1 つ以上の NPS プロキシを展開するかどうかを決定します。 フォールト トレランスを提供するには、少なくとも 2 つの NPS プロキシを使用します。 NPS の 1 つのプロキシは、プライマリ RADIUS プロキシとして使用し、他は、バックアップとして使用します。 各 RADIUS クライアントは両方の NPS プロキシし構成します。 プライマリ NPS プロキシが使用可能になるしない場合は、RADIUS クライアントは、別の NPS プロキシへアクセス要求メッセージを送信します。

- 管理オーバーヘッドで保存して、サーバーの構成が正しくないようにするのには、他の NPS プロキシを 1 つの NPS プロキシ構成をコピーするためのスクリプトを計画します。 NPS では、別の NPS プロキシにインポートする目的の NPS プロキシ構成の一部または全部をコピーするための Netsh コマンドを提供します。 Netsh プロンプトでコマンドを手動で実行することができます。 ただし、スクリプトとして、コマンド シーケンスを保存する場合、プロキシ構成を変更する場合、後で、スクリプトを実行できます。

## <a name="plan-radius-clients"></a>RADIUS クライアントを計画します。

RADIUS クライアントと、ワイヤレス アクセス ポイントなどのネットワーク アクセス サーバーは仮想プライベート ネットワーク \(VPN\) サーバー、802.1 X 対応スイッチ、およびダイアル アップ サーバー。 RADIUS クライアントがも RADIUS プロキシは、接続要求メッセージを RADIUS サーバーに転送できます。 NPS サポートしているすべてのネットワーク アクセス サーバーおよび RADIUS プロキシ、RADIUS プロトコルに準拠している RFC 2865、」の説明に従って"リモート認証ダイヤルイン ユーザー サービス \(RADIUS\)、"と、「RADIUS アカウンティング」。

さらに、ワイヤレス アクセス ポイントとスイッチの両方できる必要があります 802.1 X 認証します。 拡張認証プロトコル (EAP) または保護されている拡張認証プロトコル (PEAP) を展開する場合は、アクセス ポイントとスイッチは EAP の使用をサポートする必要があります。

ワイヤレス アクセス ポイントを PPP 接続用の基本的な相互運用性をテストするには、アクセス ポイントとパスワード認証プロトコル (PAP) を使用するアクセス クライアントを構成します。 ネットワーク アクセスに使用する予定のものをテストするまでは、PEAP などの追加 PPP ベースの認証プロトコルを使用します。

### <a name="key-steps"></a>主要な手順

RADIUS クライアントの計画時に、次の手順を使用することができます。

- NPS で構成する必要があります (Vsa) ベンダー固有属性を文書化します。 Nas は Vsa 必要がある場合は、NPS で、ネットワーク ポリシーを構成するときに後で使用できる VSA 情報を記録します。

- すべてのデバイスの構成を簡略化するには、RADIUS クライアントと、NPS のプロキシの IP アドレスを文書化します。 RADIUS クライアントを展開するときに、認証サーバーとして入力 NPS プロキシの IP アドレスを持つ、RADIUS プロトコルを使用するように構成する必要があります。 および RADIUS クライアントと通信するために NPS を構成するときに、NPS スナップインに RADIUS クライアントの IP アドレスを入力する必要があります。

- RADIUS クライアントと NPS の管理スナップインでは、共有シークレットの構成を作成します。 共有シークレット、または NPS の RADIUS クライアントを構成するときに、NPS スナップインにも入力するパスワードは、RADIUS クライアントを構成する必要があります。

## <a name="plan-remote-radius-server-groups"></a>リモート RADIUS サーバー グループを計画します。

NPS プロキシでリモート RADIUS サーバー グループを構成する場合は、一部またはすべての接続にネットワーク アクセス サーバーと NPS プロキシまたは他の RADIUS プロキシから受け取った要求メッセージを送信する場所を NPS プロキシに通知されます。

NPS を使用するには、接続を転送するように RADIUS プロキシが要求を 1 つまたは複数のリモート RADIUS サーバー グループ、および各グループは、1 つまたは複数の RADIUS サーバーを含めることができます。 複数のグループにメッセージを転送するように、NPS プロキシを設定する場合は、グループごとに 1 つの接続要求ポリシーを構成します。 接続要求ポリシーには、属性の操作規則、ポリシーで指定したリモート RADIUS サーバー グループに送信するには、どのメッセージを NPS プロキシに指示するなどの追加情報が含まれています。

NPS 用の Netsh コマンドを使用して、リモート RADIUS サーバー グループ] の下の NPS スナップインで直接、グループを構成することによって、または新しい接続要求ポリシー ウィザードを実行して、リモート RADIUS サーバー グループを構成することができます。

### <a name="key-steps"></a>主要な手順

リモート RADIUS サーバー グループの計画時に、次の手順を使用することができます。

- NPS プロキシ接続要求を転送する RADIUS サーバーを含むドメインを決定します。 これらのドメインには、展開する RADIUS クライアントを使用してネットワークに接続しているユーザーのユーザー アカウントが含まれます。

- RADIUS が既に展開されていないドメインに新しい RADIUS サーバーを追加する必要があるかどうかを決定します。

- リモート RADIUS サーバー グループに追加する RADIUS サーバーの IP アドレスを文書化します。

- リモート RADIUS サーバー グループの数を作成する必要がありますを決定します。 場合によっては、1 つのリモート RADIUS サーバー グループ、ドメインごとを作成し、ドメインの RADIUS サーバーをグループに追加することをお勧めします。 ただし、ドメイン内、多数のドメイン コントローラー、および RADIUS サーバーの数が多い多数のユーザー アカウントを持つユーザーを含む、1 つのドメインのリソースの消費量が場合があります。 または、ドメインが原因とすると、ネットワーク アクセス サーバーと RADIUS サーバーが互いから離れている場所にある、大規模な地理的領域をカバー可能性があります。 およびではこれら可能性がありますそれ以外の場合、リモートの複数の RADIUS サーバー グループが各ドメインを作成できます。

- NPS プロキシ上およびリモート RADIUS サーバーでは、共有シークレットの構成を作成します。

## <a name="plan-attribute-manipulation-rules-for-message-forwarding"></a>メッセージの転送の属性の操作の規則を計画します。

接続要求ポリシーで構成されて、属性の操作の規則を使用すると、特定リモート RADIUS サーバー グループに転送するアクセス要求メッセージを特定できます。

属性の操作規則を使用せずに 1 つのリモート RADIUS サーバー グループのすべての接続要求を転送するために NPS を構成することができます。

接続要求を転送する 1 つ以上の場所があれば、ただし、する必要があります場所ごとに、接続要求ポリシーを作成し、リモート RADIUS サーバー グループにメッセージを転送するだけでなく、属性の操作規則を転送するには、どのメッセージを NPS に指示するポリシーを構成します。

次の属性のルールを作成することができます。

- 呼ばれるステーション id ネットワーク アクセス サーバー (NAS) の電話番号です。 この属性の値は、文字の文字列です。 パターン マッチング構文を使用すると、市外局番を指定します。

- 通話-ステーションの id。 呼び出し元の電話番号。 この属性の値は、文字の文字列です。 パターン マッチング構文を使用すると、市外局番を指定します。

- ユーザー名。 アクセス クライアントによって提供されると、nas から RADIUS アクセス要求メッセージに含まれているユーザー名。 この属性の値は、通常領域名とユーザー アカウント名を含む文字列です。

正しくを置き換えたりするため、接続要求のユーザー名に領域名を変換、適切な接続要求ポリシーでユーザー名属性の属性の操作の規則を構成する必要があります。

### <a name="key-steps"></a>主要な手順

属性の操作規則の計画時に、次の手順を使用することができます。

- リモート RADIUS サーバーと RADIUS サーバーへのメッセージの転送に使用する論理パスがあることを確認するにメッセージが、プロキシ経由 NAS からルーティングを計画します。

- 各接続要求ポリシーを使用する 1 つまたは複数の属性を確認します。

- 各接続要求ポリシーの使用を計画する属性の操作の規則を文書化し、メッセージの転送先となるリモート RADIUS サーバー グループに規則と一致します。

## <a name="plan-connection-request-policies"></a>接続要求ポリシーを計画します。

RADIUS サーバーとして使用される場合は、既定の接続要求ポリシーを NPS の構成されます。 複数の特定の条件を定義する属性の高度な属性を指定して、リモート RADIUS サーバー グループに転送するように、どのメッセージを NPS に指示する操作の規則を作成、追加の接続要求ポリシーを使用できます。 一般的なまたはカスタムのいずれかの接続要求ポリシーを作成するのにには、新しい接続要求ポリシー ウィザードを使用します。

### <a name="key-steps"></a>主要な手順

接続要求ポリシーの計画時に、次の手順を使用することができます。

- RADIUS プロキシとしてのみ機能する NPS を実行する各サーバーの既定の接続要求ポリシーを削除します。

- 追加の条件とリモート RADIUS サーバー グループと、ポリシーの計画的な属性の操作の規則と、この情報を組み合わせると、ポリシーごとに必要な設定を計画します。

- NPS のすべてのプロキシに共通の接続要求ポリシーを配布する計画を設計します。 別の NPS サーバーで複数の NPS プロキシに共通のポリシーを作成し、NPS 用の Netsh コマンドを使用して、他のすべてのプロキシで接続要求ポリシーおよびサーバー構成をインポートします。

## <a name="plan-nps-accounting"></a>NPS アカウンティングを計画します。

NPS を RADIUS プロキシとして構成する場合は、RADIUS ログ NPS の形式のログ ファイル、データベース互換形式のログ ファイル、または NPS SQL Server を使用してアカウンティングを実行することを構成できます。

これらのログ形式のいずれかを使用して、アカウンティングを実行するリモート RADIUS サーバー グループにアカウンティング メッセージを転送することもできます。

### <a name="key-steps"></a>主要な手順

NPS アカウンティングの計画時に、次の手順を使用することができます。

- NPS プロキシまたはアカウンティングのリモート RADIUS サーバー グループにアカウンティング メッセージを転送するアカウンティング サービスを実行するかどうかを決定します。

- アカウンティングを他のサーバーのアカウンティング メッセージを転送する予定の場合、ローカルの NPS プロキシを無効にする予定です。

- 他のサーバーにアカウンティング メッセージを転送する予定の場合は、接続要求ポリシーの構成手順を計画します。 NPS プロキシのローカル アカウンティングを無効にした場合、そのプロキシで構成する各接続要求ポリシーは、アカウンティング メッセージの転送を有効になっており、正しく構成されているが必要です。

- 使用するログ形式を指定します。IAS 形式のログ ファイル、データベース互換形式ログ ファイル、または NPS SQL Server のログ記録します。

RADIUS プロキシとしての NPS の負荷分散を構成するのを参照してください。[NPS プロキシ サーバーの負荷分散](nps-manage-proxy-lb.md)します。

