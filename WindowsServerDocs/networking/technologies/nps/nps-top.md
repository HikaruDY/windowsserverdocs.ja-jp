---
title: ネットワーク ポリシー サーバー (NPS)
description: このトピックでは、Windows Server 2016 および Windows Server 2019、ネットワーク ポリシー サーバーの概要を示し、詳細なガイダンスについては、NPS へのリンクが含まれています。
manager: dougkim
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 9c7a67e0-0953-479c-8736-ccb356230bde
ms.author: pashort
author: shortpatti
ms.date: 06/20/2018
ms.openlocfilehash: 0439c0f45a604f6b3ef90369f5fe77a59568d9d7
ms.sourcegitcommit: 8ba2c4de3bafa487a46c13c40e4a488bf95b6c33
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/25/2019
ms.locfileid: "66222585"
---
# <a name="network-policy-server-nps"></a>ネットワーク ポリシー サーバー (NPS)

>適用対象:Windows Server (半期チャネル)、Windows Server 2016、Windows Server 2019

このトピックでは、Windows Server 2016 および Windows Server 2019 でネットワーク ポリシー サーバーの概要については使用できます。 Windows Server 2016 および Server 2019 でネットワーク ポリシーとアクセス サービス (NPAS) 機能をインストールするときに、NPS がインストールされます。

>[!NOTE]
>このトピックに加え、次の NPS のドキュメントは使用できます。
> - [ネットワーク ポリシー サーバーのベスト プラクティス](nps-best-practices.md)
> - [ネットワーク ポリシー サーバーの概要](nps-getstart-top.md)
> - [ネットワーク ポリシー サーバーを計画します。](nps-plan-top.md)
> - [ネットワーク ポリシー サーバーを展開します。](nps-deploy.md)
> - [ネットワーク ポリシー サーバーを管理します。](nps-manage-top.md)
> - [ネットワーク ポリシー サーバー (NPS) のコマンドレットでは、Windows PowerShell](https://technet.microsoft.com/library/jj872739.aspx) Windows Server 2016 および Windows 10
> - [ネットワーク ポリシー サーバー (NPS) のコマンドレットでは、Windows PowerShell](https://technet.microsoft.com/library/jj872739.aspx) Windows Server 2012 R2 および Windows 8.1
> - [Windows PowerShell のコマンドレットは NPS](https://technet.microsoft.com/library/jj872739.aspx) Windows Server 2012 および Windows 8

ネットワーク ポリシー サーバー (NPS) を使用すると、接続要求の認証と承認を行うための組織全体のネットワーク アクセス ポリシーを作成して適用できます。

負荷分散接続を要求して、認証用の正しいドメインに転送できるように、リモートの NPS または他の RADIUS サーバーに接続要求を転送するようにリモート認証ダイヤルイン ユーザー サービス (RADIUS) のプロキシとして NPS を構成することもできます。および承認します。

NPS では一元的に構成して、ネットワーク アクセスの認証、承認、およびアカウンティングを次の機能を管理することができます。

- **RADIUS サーバー**します。 NPS は、ワイヤレス、認証スイッチ、リモート アクセス ダイヤルアップと仮想プライベート ネットワーク (VPN) 接続に対して、一元化された認証、承認、およびアカウンティングを実行します。 NPS を RADIUS サーバーとして使用する場合、ワイヤレス アクセス ポイントや VPN サーバーなどのネットワーク アクセス サーバーを NPS の RADIUS クライアントして構成します。 また、NPS が接続要求を承認するために使用するネットワーク ポリシーを構成して、NPS がアカウンティング情報をローカル ハード ディスク上のログ ファイルまたは Microsoft SQL Server データベースに記録するように RADIUS アカウンティングを構成できます。 詳細については、次を参照してください。 [RADIUS サーバー](#radius-server)します。
- **RADIUS プロキシ**します。 NPS を RADIUS プロキシとして使用する場合は、他の RADIUS サーバーと接続要求を転送する RADIUS サーバーに転送する接続要求の NPS に指示する接続要求ポリシーを構成します。 アカウンティング データを転送して、リモート RADIUS サーバー グループの 1 つ以上のコンピューターに記録されるように構成することもできます。 RADIUS プロキシ サーバーとしては、NPS を構成するには、次のトピックを参照してください。 詳細については、次を参照してください。 [RADIUS プロキシ](#radius-proxy)します。
    - [接続要求ポリシーを構成します。](nps-crp-configure.md)
- **RADIUS アカウンティング**します。 ローカルのログ ファイルに、または Microsoft SQL Server のローカルまたはリモート インスタンスにイベントを記録する NPS を構成することができます。 詳細については、次を参照してください。 [NPS ログ](#nps-logging)します。

>[!IMPORTANT]
>ネットワーク アクセス保護\(NAP\)、正常性登録機関\(HRA\)、および Host Credential Authorization Protocol \(HCAP\) Windows Server 2012 R2 で非推奨とされました。Windows Server 2016 では使用できません。 Windows Server 2016 より前のオペレーティング システムを使用して、NAP 展開した場合は、Windows Server 2016 に NAP の展開を移行できません。

これらの機能の任意の組み合わせでは、NPS を構成できます。 たとえば、VPN 接続用の RADIUS サーバーとして、接続要求の一部を別のドメインで認証と承認のリモート RADIUS サーバー グループのメンバーに転送する RADIUS プロキシとしても、1 つの NPS を構成できます。

## <a name="windows-server-editions-and-nps"></a>Windows Server のエディションと NPS

NPS をインストールする Windows Server のエディションによって異なる機能を提供します。

### <a name="windows-server-2016-or-windows-server-2019-standarddatacenter-edition"></a>Windows Server 2016 または Windows Server 2019 Standard または Datacenter Edition

Windows Server 2016 Standard または Datacenter では、NPS を RADIUS クライアントとリモート RADIUS サーバー グループの無制限の数を構成できます。 さらに、IP アドレスの範囲を指定して RADIUS クライアントを構成することができます。

>[!NOTE]
>WIndows ネットワーク ポリシーとアクセス サービスの機能は、Server Core インストール オプションでインストールされているシステムでご利用いただけません。

次のセクションでは、RADIUS サーバーおよびプロキシとして NPS に関する詳細な情報を提供します。

## <a name="radius-server-and-proxy"></a>RADIUS サーバーとプロキシ

NPS は、RADIUS サーバー、RADIUS プロキシ、またはその両方として使用することができます。

### <a name="radius-server"></a>RADIUS サーバー

NPS は RADIUS 標準を指定して、Internet Engineering Task Force の Microsoft 実装\(IETF\) Rfc 2865 および 2866 でします。 NPS を RADIUS サーバーとしては、一元化された接続の認証、承認、およびアカウンティングのさまざまな種類のネットワーク アクセス、ワイヤレス接続、認証スイッチ、ダイヤルアップ、および仮想プライベート ネットワークの操作を実行します\(VPN\)リモートアクセス、およびルーターに接続します。

>[!NOTE]
>NPS を RADIUS サーバーとして展開する方法の詳細については、次を参照してください。[ネットワーク ポリシー サーバーの展開](nps-deploy.md)します。

NPS では、異種の一連のワイヤレス、スイッチ、リモート アクセス、または VPN 機器を使用できるようにします。 Windows Server 2016 で使用可能なリモート アクセス サービスと、NPS を使用することができます。

NPS は、Active Directory Domain Services を使用して\(AD DS\)ドメインまたはローカル セキュリティ アカウント マネージャー (SAM) のユーザー アカウントのデータベース接続の試行中にユーザーの資格情報を認証します。 NPS を実行しているサーバー、AD DS ドメインのメンバーでは時に、NPS はそのユーザー アカウント データベースとしてディレクトリ サービスを使用して、シングル サインオン ソリューションの一部です。 ネットワーク アクセス制御の資格情報の同じセットが使用される\(の認証とネットワークへのアクセスを承認\)AD DS ドメインにログオンするとします。

>[!NOTE]
>NPS は接続を承認するのにユーザー アカウントとネットワーク ポリシーのダイヤルイン プロパティを使用します。

インターネット サービス プロバイダー \(Isp\)ネットワーク アクセスを管理する組織があるすべての種類のネットワーク アクセスを管理する単一のネットワーク アクセスの種類に関係なく、管理ポイントからの大きな課題と使用する機器。 RADIUS 標準では、均一で異種の両方の環境でこの機能をサポートしています。 RADIUS は、認証およびアカウンティング要求を RADIUS サーバーに送信する (RADIUS クライアントとして使用される) のネットワーク アクセス機器を可能にするクライアント/サーバー プロトコルです。

RADIUS サーバーは、ユーザー アカウント情報にアクセスして、ネットワーク アクセス認証の資格情報を確認できます。 ユーザーの資格情報が認証し、接続試行が承認されると、RADIUS サーバーが指定した条件に基づいてユーザー アクセスを承認し、アカウンティング ログに記録し、ネットワーク アクセス接続ログに記録します。 RADIUS の使用により、ネットワーク アクセスのユーザー認証、承認、およびアカウンティング データを収集および各アクセス サーバーではなく、一元的に管理できます。

#### <a name="using-nps-as-a-radius-server"></a>NPS を RADIUS サーバーとして使用します。

NPS を RADIUS サーバーとして使用することができる場合。

- アクセス クライアントのユーザー アカウント データベースとして、AD DS ドメインまたはローカルの SAM ユーザー アカウント データベースを使用しています。 
- 複数のダイヤルアップ サーバー、VPN サーバー、リモート アクセスを使用しているまたはデマンド ダイヤル ルーターとするネットワーク ポリシーと接続およびアカウンティングのログの構成の両方を一元化します。 
- ダイヤルアップ、VPN、またはサービス プロバイダーへのワイヤレス アクセスをアウトソーシングしています。 アクセス サーバーでは、RADIUS を使用して認証し、組織のメンバーによって行われた接続を承認します。
- 認証、承認、および異種一連のアクセス サーバーのアカウンティングを一元化します。

次の図は、さまざまなアクセス クライアント、RADIUS サーバーとして NPS を示します。 

![RADIUS サーバーとして機能する NPS](../../media/Nps-Server/Nps-Server.jpg)

### <a name="radius-proxy"></a>RADIUS プロキシ

RADIUS プロキシとして NPS は NPS および他の RADIUS サーバーを認証およびアカウンティング メッセージを転送します。 NPS を使用するには、RADIUS のルーティングを提供する RADIUS プロキシが RADIUS クライアントの間でメッセージとして\(ネットワーク アクセス サーバーとも呼ばれます\)とユーザー認証、承認、およびアカウンティングを実行する RADIUS サーバー、。接続しようとしました。 

RADIUS プロキシとして使用した場合、NPS はスイッチングまたは RADIUS アクセスおよびアカウンティング メッセージが流れるルーティング ポイントです。 NPS はアカウンティング ログに記録が転送されるメッセージに関する情報を記録します。

#### <a name="using-nps-as-a-radius-proxy"></a>NPS を RADIUS プロキシとして使用します。

NPS を RADIUS プロキシとして使用することができる場合。

- アウトソースされたダイヤルアップ、VPN、またはワイヤレス ネットワーク アクセス サービスを複数の顧客に提供しているサービス プロバイダーがあります。 Nas は、接続要求を NPS RADIUS プロキシに送信します。 接続要求内のユーザー名の領域部分に基づき、NPS RADIUS プロキシ、顧客が管理する RADIUS サーバーに接続要求を転送し、認証および承認できます接続試行します。
- ドメインに NPS がメンバーまたは NPS メンバーであるドメインと双方向信頼関係がある別のドメインのいずれかのメンバーではないユーザー アカウントの認証と承認を提供するには。 これには、信頼されていないドメイン、一方向の信頼されたドメインと他のフォレストのアカウントが含まれます。 NPS RADIUS サーバーに、接続要求を送信するようにアクセス サーバーを構成する代わりに、接続要求を NPS RADIUS プロキシに送信するようを構成できます。 NPS RADIUS プロキシは、ユーザー名の領域名部分を使用して、要求を正しいドメインまたはフォレストの NPS に転送します。 Nas 別のドメインまたはフォレスト内の 1 つのドメインまたはフォレスト内のアカウントを認証できるユーザーの接続が試みられます。
- Windows アカウント データベースではないデータベースを使用して認証と承認を実行するには。 この場合、指定された領域名に一致する接続要求は、ユーザー アカウントと認証データの別のデータベースにアクセスする RADIUS サーバーに転送されます。 その他のユーザー データベースの例には、Novell Directory Services (NDS) および構造化照会言語 (SQL) データベースが含まれます。
- 多数の接続要求を処理するには。 この場合は、複数の RADIUS サーバー間で、接続およびアカウンティング要求を分散しようとする RADIUS クライアントを構成する代わりには、接続およびアカウンティング要求を NPS RADIUS プロキシに送信するようにできる構成します。 NPS RADIUS プロキシが接続の負荷を動的に分散し、アカウンティングが複数の RADIUS サーバー間で要求し、多数の RADIUS クライアントの処理と 1 秒あたりの認証が向上します。
- アウトソーシング サービスのプロバイダーの RADIUS 認証と承認を提供し、イントラネット ファイアウォールの構成を最小限にします。 イントラネット ファイアウォールは、境界ネットワーク (イントラネットとインターネットの間のネットワーク) とイントラネット間です。 NPS を境界ネットワークに配置すると、境界ネットワークとイントラネット間のファイアウォールは、NPS と複数のドメイン コント ローラーの間をフローするトラフィックを許可する必要があります。 NPS を NPS プロキシに置き換えることで、ファイアウォールは、NPS プロキシとイントラネット内の 1 つまたは複数の NPSs 間をフローする RADIUS トラフィックのみを許可する必要があります。

次の図は、RADIUS クライアントと RADIUS サーバー間の RADIUS プロキシとして NPS を示しています。

![RADIUS プロキシとして機能する NPS](../../media/Nps-Proxy/Nps-Proxy.jpg)


Nps、組織はリモート アクセス インフラストラクチャをサービス プロバイダーをユーザー認証、承認、およびアカウンティングの制御を維持しながらもアウトソーシングできます。

次のシナリオでは、NPS の構成を作成できます。

- 無線アクセス
- 組織のダイヤルアップまたは仮想プライベート ネットワーク (VPN) リモート アクセス
- アウトソースされたダイヤルアップまたはワイヤレス アクセス
- インターネット アクセス
- ビジネス パートナーのエクストラネット リソースへの認証済みアクセス

## <a name="radius-server-and-radius-proxy-configuration-examples"></a>RADIUS サーバーと RADIUS プロキシの構成例

次の構成例では、NPS を RADIUS サーバーと RADIUS プロキシとして構成する方法を示しています。

**NPS を RADIUS サーバーとして**します。 この例では、NPS が RADIUS サーバーとして構成されている、既定の接続要求ポリシーは、唯一の構成されたポリシーおよびすべての接続要求がローカルの NPS によって処理されます。 NPS では、認証でき、アカウントを持つが、NPS のドメインおよび信頼されたドメイン ユーザーを承認することができます。

**RADIUS プロキシとして機能する NPS**します。 この例では、NPS は接続要求を 2 つの信頼されていないドメインでのリモート RADIUS サーバー グループに転送する RADIUS プロキシとして構成されます。 既定の接続要求ポリシーを削除すると、および 2 つの信頼されていないドメインのそれぞれに要求を転送する 2 つの新しい接続要求ポリシーが作成されます。 この例では、NPS は、ローカル サーバー上で接続要求を処理しません。 

**RADIUS サーバーと RADIUS プロキシの両方として機能する NPS**します。 既定の接続要求ポリシー、接続要求がローカルで処理されることを指定するには、だけでなく、NPS や信頼されていないドメイン内の他の RADIUS サーバーに接続要求を転送する新しい接続要求ポリシーが作成します。 この 2 つ目のポリシーの名前は、プロキシ ポリシー。 この例で、プロキシ ポリシーがポリシーの順序付きリストの先頭に表示されます。 接続要求がプロキシ ポリシーに一致する場合、接続要求は、リモート RADIUS サーバー グループ内の RADIUS サーバーに転送されます。 接続要求がプロキシ ポリシーと一致しませんが、既定の接続要求ポリシーと一致する場合は、NPS は、ローカル サーバーに接続要求を処理します。 接続要求がいずれかのポリシーが一致しない場合は破棄されます。

**RADIUS サーバーとリモート アカウンティング サーバーとして機能する NPS**します。 この例でアカウンティングを実行するローカルの NPS が構成されていないと既定の接続要求ポリシーが改訂され、RADIUS アカウンティング メッセージは、NPS またはリモート RADIUS サーバー グループ内の他の RADIUS サーバーに転送されるようにします。 アカウンティング メッセージを転送すると、認証と承認のメッセージが転送されていないと、ローカル ドメインのローカル NPS がこれらの関数を実行し、信頼できるすべてのドメイン。

**Windows ユーザー マッピングへのリモート RADIUS で NPS**します。 この例では、NPS は RADIUS サーバーとして、個々 の接続要求を RADIUS プロキシとしてを承認をローカル Windows ユーザー アカウントを使用しながら、リモート RADIUS サーバーに認証要求を転送することによって機能します。 この構成は、接続要求ポリシーの条件として [Remote RADIUS to Windows User Mapping] 属性を構成することによって実装されます。 \(さらに、ユーザー アカウントをローカルに作成、リモート RADIUS サーバーによって認証を行う対象となるリモート ユーザー アカウントと同じ名前を持つ RADIUS サーバーにする必要があります。\)

## <a name="configuration"></a>構成

NPS を RADIUS サーバーとしての構成に、NPS コンソールで、またはサーバー マネージャーでは、標準的な構成または高度な構成を使用できます。 NPS を RADIUS プロキシとして構成するには、高度な構成を使用する必要があります。

### <a name="standard-configuration"></a>標準の構成

標準構成では、ウィザードは、次のシナリオに NPS を構成する際に提供されます。

- ダイヤルアップ接続または VPN 接続用の RADIUS サーバー
- 802.1X ワイヤレス接続またはワイヤード (有線) 接続用の RADIUS サーバー

ウィザードを使用して NPS を構成する、NPS コンソールを開き、前述のシナリオのいずれかを選択およびリンクをクリックするには、ウィザードを開きます。

### <a name="advanced-configuration"></a>詳細構成

高度な構成を使用する場合は、RADIUS サーバーまたは RADIUS プロキシとして NPS 手動で構成します。 

高度な構成を使用して NPS を構成する NPS コンソールを開くし、矢印をクリックし、**高度な構成**このセクションを展開します。

次の高度な構成項目が提供されます。

#### <a name="configure-radius-server"></a>RADIUS サーバーを構成します。

NPS を RADIUS サーバーとして構成するには、RADIUS クライアント、ネットワーク ポリシー、および RADIUS アカウンティングを構成する必要があります。

これらの構成を行う方法の詳細については、次のトピックを参照してください。

- [RADIUS クライアントを構成する](nps-radius-clients-configure.md)
- [ネットワーク ポリシーを構成する](nps-np-configure.md)
- [ネットワーク ポリシー サーバーのアカウンティングを構成します。](nps-accounting-configure.md)

#### <a name="configure-radius-proxy"></a>RADIUS プロキシを構成します。

NPS を RADIUS プロキシとして構成するには、RADIUS クライアント、リモート RADIUS サーバー グループ、および接続要求ポリシーを構成する必要があります。

これらの構成を行う方法の詳細については、次のトピックを参照してください。

- [RADIUS クライアントを構成する](nps-radius-clients-configure.md)
- [リモート RADIUS サーバー グループを構成します。](nps-crp-rrsg-configure.md)
- [接続要求ポリシーを構成します。](nps-crp-configure.md)

## <a name="nps-logging"></a>NPS ログ

NPS のログは、RADIUS アカウンティングとも呼ばれます。 NPS は NPS を RADIUS サーバー、プロキシ、またはこれらの構成の任意の組み合わせとして使用しているかどうか、要件にログを構成します。

NPS ログを構成するには、ログに記録するイベント ログに記録され、イベント ビューアーで表示を選択して、その他の情報を決定しを構成する必要があります。 さらに、テキストのログ ファイルがローカル コンピューターに格納するか、ローカル コンピューターまたはリモート コンピューター上の SQL Server データベースにユーザー認証およびアカウンティング情報を記録するかどうかを指定する必要があります。

詳細については、次を参照してください。[を構成するネットワーク ポリシー サーバー アカウンティング](nps-accounting-configure.md)します。
