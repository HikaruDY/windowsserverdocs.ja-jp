---
title: ネットワーク ポリシー サーバー (NPS)
description: このトピックでは、Windows Server 2016 でネットワーク ポリシー サーバーの概要を説明し、NPS に関する追加のガイダンスへのリンクが含まれています。
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 9c7a67e0-0953-479c-8736-ccb356230bde
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 8f48cbdaec82e9e60f734a4a8949082187b13166
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
---
# <a name="network-policy-server-nps"></a>ネットワーク ポリシー サーバー (NPS)

>適用対象: Windows Server (半期チャネル)、Windows Server 2016

Windows Server 2016 でネットワーク ポリシー サーバーの概要については、このトピックを使用できます。

>[!NOTE]
>このトピックに加え、次の NPS のドキュメントは使用できます。
> - [ネットワーク ポリシー サーバーのベスト プラクティス](nps-best-practices.md)
> - [ネットワーク ポリシー サーバーの概要](nps-getstart-top.md)
> - [ネットワーク ポリシー サーバーを計画します。](nps-plan-top.md)
> - [ネットワーク ポリシー サーバーを展開します。](nps-deploy.md)
> - [ネットワーク ポリシー サーバーを管理します。](nps-manage-top.md)
> - [ネットワーク ポリシー サーバー (NPS) コマンドレット](https://technet.microsoft.com/library/jj872739.aspx)for Windows Server 2016 および Windows 10
> - [ネットワーク ポリシー サーバー (NPS) のコマンドレットでは、Windows PowerShell](https://technet.microsoft.com/library/jj872739.aspx)の Windows Server 2012 R2 および Windows 8.1
> - [Windows PowerShell のコマンドレットを NPS](https://technet.microsoft.com/library/jj872739.aspx) Windows Server 2012 および Windows 8 用

ネットワーク ポリシー サーバー (NPS) を使用すると、作成し、接続要求の認証と承認のため、組織全体のネットワーク アクセス ポリシーを実施できます。

NPS は、負荷分散の接続を要求して、それらを認証および承認の正しいドメインに転送できるようにリモート NPS またはその他の RADIUS サーバーに接続要求を転送するようにリモート認証ダイヤルイン ユーザー サービス (RADIUS) のプロキシとして構成することもできます。

NPS では、一元的に構成し、ネットワーク アクセスの認証、承認、およびアカウンティング次の機能を管理することができます。

- **RADIUS サーバー**します。 NPS は、ワイヤレス、認証スイッチ、リモート アクセス ダイヤルアップおよび仮想プライベート ネットワーク (VPN) 接続に対して、一元的な認証、承認、およびアカウンティングを実行します。 NPS を RADIUS サーバーとして使用するときに NPS の RADIUS クライアントとしてワイヤレス アクセス ポイントなどのネットワーク アクセス サーバーおよび VPN サーバーを構成します。 構成することも、接続要求を承認するために NPS を使用してネットワーク ポリシーと RADIUS アカウンティングを構成するには、NPS アカウンティング情報をログ ファイルのローカルのハード ディスク上または Microsoft SQL Server データベースをログに記録できるようにします。 詳細については、次を参照してください。[RADIUS サーバー](#bkmk_server)します。
- **RADIUS プロキシ**します。 NPS を RADIUS プロキシとして使用するときに、他の RADIUS サーバーと接続要求を転送するどの RADIUS サーバーに転送する接続要求 NPS に指示する接続要求ポリシーを構成します。 また、リモート RADIUS サーバー グループの 1 つまたは複数のコンピューターによってログに記録するアカウンティング データを転送する NPS を構成することができます。 NPS を RADIUS プロキシ サーバーを構成するのには、次のトピックを参照してください。 詳細については、次を参照してください。[RADIUS プロキシ](#bkmk_proxy)します。
    - [接続要求ポリシーを構成します。](nps-crp-configure.md)
- **RADIUS アカウンティング**します。 NPS イベントをログにログ ファイルをローカルにまたは Microsoft SQL Server のローカルまたはリモート インスタンスを構成することができます。 詳細については、次を参照してください。[NPS ログ](#bkmk_logging)します。

>[!IMPORTANT]
>ネットワーク アクセス保護 \(NAP\)、正常性登録機関 \(HRA\)、Host Credential Authorization Protocol \(HCAP\) Windows Server 2012 R2 で廃止されましたおよび Windows Server 2016 では使用できません。 NAP を Windows Server 2016 より前のオペレーティング システムを使用して展開した場合は、Windows Server 2016 に、NAP 環境内を移行することはできません。

これらの機能の任意の組み合わせでは、NPS を構成できます。 たとえば、VPN 接続用の RADIUS サーバーおよび認証と承認を別のドメイン内のリモート RADIUS サーバー グループのメンバー一部の接続要求を転送するように RADIUS プロキシとしても別の NPS サーバーを構成することができます。

## <a name="windows-server-editions-and-nps"></a>Windows Server のエディションと NPS

NPS をインストールする Windows Server のエディションによって異なる機能を提供します。

### <a name="windows-server-2016-datacenter-edition"></a>Windows Server 2016 Datacenter Edition

Windows Server 2016 Datacenter では、NPS を RADIUS クライアントおよびリモート RADIUS サーバー グループの無制限の数を構成できます。 さらに、IP アドレス範囲を指定して RADIUS クライアントを構成することができます。

### <a name="windows-server-2016-standard-edition"></a>Windows Server 2016 Standard Edition

NPS で Windows Server 2016 Standard、50 の RADIUS クライアントの最大値と 2 つのリモート RADIUS サーバー グループの最大値を構成できます。 完全修飾ドメイン名または IP アドレスを使用して RADIUS クライアントを定義することができますが、IP アドレスの範囲を指定して RADIUS クライアントのグループを定義することはできません。 RADIUS クライアントの完全修飾ドメイン名は、複数の IP アドレスに解決する場合、NPS サーバーはドメイン ネーム システム (DNS) クエリで返される最初の IP アドレスを使用します。

次のセクションでは、RADIUS サーバーおよびプロキシとしての NPS に関する詳細な情報を提供します。

## <a name="radius-server-and-proxy"></a>RADIUS サーバーおよびプロキシ

NPS を RADIUS サーバー、RADIUS プロキシ、またはその両方として使用できます。

### <a name="bkmk_server"></a>RADIUS サーバー

NPS は、Rfc 2865 と 2866 でインターネット技術標準化委員 \(IETF\) によって指定された RADIUS 標準の Microsoft 実装です。 RADIUS サーバーとしては、NPS は、さまざまな種類のネットワーク アクセス (ワイヤレス、ダイヤルアップ、スイッチの認証と仮想プライベート ネットワーク \(VPN\) リモート アクセス、およびルーター間の接続を含む) の一元的な接続の認証、承認、およびアカウンティングを実行します。

>[!NOTE]
>NPS を RADIUS サーバーとして展開する方法の詳細については、次を参照してください。[ネットワーク ポリシー サーバーの展開](nps-deploy.md)します。

NPS では、さまざまな種類のワイヤレス、スイッチ、リモート アクセス、または VPN 機器の使用できるようにします。 Windows Server 2016 で利用可能なリモート アクセス サービスでは、NPS を使用できます。

NPS は Active Directory Domain Services \(AD DS\) ドメインまたは接続のユーザーの資格情報の認証にセキュリティ アカウント マネージャー (SAM) のローカル ユーザー アカウント データベースしようとします。 NPS を実行しているサーバーが AD DS ドメインのメンバーである、NPS でディレクトリ サービスはそのユーザー アカウント データベースとして使用し、シングル サインオン ソリューションの一部であります。 ネットワーク アクセス制御のため、同じ資格情報のセットが使用される \ (認証と、ネットワークへのアクセスを承認する) と AD DS ドメインにログオンします。

>[!NOTE]
>NPS では、ユーザー アカウントとネットワーク ポリシーのダイヤルイン プロパティを使用して、接続を承認します。

インターネット サービス プロバイダー \(ISPs\) とネットワーク アクセスを管理する組織の単一のネットワーク アクセス装置の使用の種類に関係なく、管理ポイントからすべての種類のネットワーク アクセスを管理する大きな課題があります。 RADIUS 標準では、同次および異機種混在環境でもこの機能をサポートしています。 RADIUS は、認証とアカウンティング要求を RADIUS サーバーに送信する (RADIUS クライアントとして使用される) ネットワーク アクセスの装置を可能にするクライアント/サーバー プロトコルです。

RADIUS サーバーは、ユーザー アカウント情報にアクセスし、ネットワーク アクセスの認証資格情報を確認することができます。 ユーザーの資格情報が認証された接続の試行が承認されている場合は、RADIUS サーバーが、指定した条件に基づいてユーザーのアクセスを承認およびアカウンティング ログに記録し、ネットワーク アクセス接続をログに記録します。 RADIUS の使用は、ネットワーク アクセスのユーザー認証、承認、およびアカウンティング データを収集し、各アクセス サーバーではなく、一元化された場所を管理できます。

#### <a name="using-nps-as-a-radius-server"></a>NPS を RADIUS サーバーとして使用します。

NPS を RADIUS サーバーとして使用する場合。

- アクセス クライアントのユーザー アカウントは、データベースと AD DS ドメインまたはローカルの SAM のユーザー アカウント データベースを使用しています。 
- VPN サーバー、複数のダイアル アップ サーバーでリモート アクセスを使用しているか、デマンド ダイヤル ルーターとしたが、両方のネットワーク ポリシーと接続およびアカウンティングのログの構成を集中管理します。 
- ダイヤルアップ、VPN、またはサービス プロバイダーへのワイヤレス アクセスを外部委託しています。 アクセス サーバーでは、RADIUS を使用して認証し、組織のメンバーによって行われる接続を承認します。
- 認証、承認、およびアカウンティング異機種混在一連のサーバーのアクセスを一元管理するには。

次の図は、さまざまなアクセス クライアント RADIUS サーバーとしての NPS を示します。 

![RADIUS サーバーとしての NPS](../../media/Nps-Server/Nps-Server.jpg)

### <a name="bkmk_proxy"></a>RADIUS プロキシ

RADIUS プロキシとしては、NPS は、NPS およびその他の RADIUS サーバーに認証とアカウンティング メッセージを転送します。 NPS を使用するには、RADIUS のルーティングを提供するための RADIUS プロキシが RADIUS クライアントの間でメッセージとして \ (ネットワーク アクセス \software\microsoft\sms\components\sms_site_component_manager\component servers \ とも呼ばれます) と、接続の試行のユーザー認証、承認、およびアカウンティングを実行する RADIUS サーバーです。 

使用する場合、RADIUS プロキシとして、NPS、集約型の切り替えまたは RADIUS アクセスおよびアカウンティング メッセージが流れるルーティング ポイントです。 NPS アカウンティング ログに記録転送されるメッセージに関する情報を記録します。

#### <a name="using-nps-as-a-radius-proxy"></a>NPS を RADIUS プロキシとして使用します。

NPS を RADIUS プロキシとして使用する場合。

- 複数の顧客を外部委託ダイヤルアップ、VPN、またはワイヤレス ネットワーク アクセス サービスを提供するサービス プロバイダーとしています。 Nas は、接続要求を NPS の RADIUS プロキシに送信します。 接続要求のユーザー名の領域の部分に基づき、NPS の RADIUS プロキシ接続要求を転送しますが、顧客が管理する RADIUS サーバーおよびできます認証し、承認、接続の試行します。
- NPS サーバーがメンバーとして所属するドメインまたは NPS サーバーがメンバーとして所属するドメインと双方向信頼関係がある別のドメインのメンバーではないユーザー アカウントの認証と承認を提供します。 これには、信頼されていないドメイン、一方向の信頼されたドメイン、およびその他のフォレストのアカウントが含まれます。 NPS の RADIUS サーバーに、接続要求を送信するようにアクセス サーバーを構成するには、代わりに、NPS の RADIUS プロキシ、接続要求を送信することを構成できます。 NPS の RADIUS プロキシは、ユーザー名の領域名部分を使用し、適切なドメインまたはフォレスト内の NPS サーバーに要求を転送します。 Nas 別のドメインまたはフォレスト内の 1 つのドメインまたはフォレスト内のアカウントを認証できるユーザーの接続が試みられます。
- Windows アカウント データベースではないデータベースを使用して認証と承認を実行するには。 この場合は、指定された領域名と一致する接続要求は、ユーザー アカウントおよび承認データの別のデータベースにアクセスできる、RADIUS サーバーに転送されます。 その他のユーザー データベースの例には、Novell ディレクトリ サービス (NDS) および Structured Query Language (SQL) データベースが含まれます。
- 接続要求の数が多いを処理します。 この場合、しようとすると、複数の RADIUS サーバーの接続およびアカウンティング要求のバランスを取る、RADIUS クライアントを構成するには、代わりに構成できます NPS の RADIUS プロキシ、接続およびアカウンティング要求を送信すること。 NPS の RADIUS プロキシが動的に接続の負荷を分散し、アカウンティングは複数の RADIUS サーバーを要求し、多数の RADIUS クライアントの処理と 1 秒あたりの認証回数が増加します。
- 外部委託サービス プロバイダーの RADIUS 認証と承認を提供し、イントラネット ファイアウォールの構成を最小化します。 イントラネット ファイアウォールでは、境界ネットワーク (イントラネットとインターネットの間のネットワーク) とイントラネット間です。 NPS サーバーを配置すると、境界ネットワーク上、境界ネットワークとイントラネットの間のファイアウォールは、NPS サーバーと複数のドメイン コントローラーの間を流れるトラフィックを許可する必要があります。 NPS サーバーを NPS プロキシに置き換えることで、ファイアウォールは、NPS プロキシとイントラネット内の 1 つまたは複数の NPS サーバーの間を流れる RADIUS トラフィックのみを許可する必要があります。

次の図は、NPS を RADIUS クライアントとサーバーの RADIUS サーバーの間で RADIUS プロキシとして表示されます。

![RADIUS プロキシとしての NPS](../../media/Nps-Proxy/Nps-Proxy.jpg)


NPS で組織外部委託することも、サービス プロバイダーにリモート アクセス インフラストラクチャ ユーザー認証、承認、およびアカウンティングの制御を維持したままです。

次のシナリオでは、NPS の構成を作成できます。

- 無線アクセス
- 組織ダイヤルアップまたは仮想プライベート ネットワーク (VPN) のリモート アクセス
- 外部委託ダイヤルアップまたはワイヤレス アクセス
- インターネットにアクセスできます。
- ビジネス パートナーのエクストラネットのリソースに認証済みアクセス

## <a name="radius-server-and-radius-proxy-configuration-examples"></a>RADIUS サーバーと RADIUS プロキシ構成の例

次の構成の例では、NPS を RADIUS サーバーと RADIUS プロキシとして構成する方法を示しています。

**NPS を RADIUS サーバーとして**します。 この例では NPS が RADIUS サーバーとして構成されている、既定の接続要求ポリシーが唯一の構成されているポリシーおよびすべての接続要求は、ローカルの NPS サーバーによって処理されます。 NPS サーバーを認証し、NPS サーバーのドメインと信頼されたドメイン内にあるアカウントを持つユーザーを承認できます。

**RADIUS プロキシとしての NPS**します。 この例では、NPS サーバーが 2 つの信頼されていないドメイン内のリモート RADIUS サーバー グループに接続要求を転送する RADIUS プロキシとして構成されます。 既定の接続要求ポリシーが削除され、2 つの信頼されていないドメインのそれぞれに要求を転送する 2 つの新しい接続要求ポリシーを作成します。 この例では、NPS は、ローカル サーバー上で接続要求を処理しません。 

**NPS を RADIUS サーバーおよび RADIUS プロキシの両方として**します。 既定の接続要求ポリシー、接続要求がローカルで処理されることを指定するには、だけでなく、NPS または信頼されていないドメイン内の他の RADIUS サーバーに接続要求を転送する新しい接続要求ポリシーが作成されます。 この 2 番目のポリシーをプロキシ ポリシーと呼びます。 この例では、プロキシ ポリシーが、ポリシーの順序付きリストの先頭に表示されます。 接続要求には、プロキシ ポリシーが一致すると、接続要求は、リモート RADIUS サーバー] グループで、RADIUS サーバーに転送されます。 接続要求がプロキシ ポリシーと一致しないが、既定の接続要求ポリシーと一致する場合は、NPS は、ローカル サーバーに接続要求を処理します。 接続要求がいずれかのポリシーが一致しない場合は破棄されます。

**リモート アカウンティング サーバーと RADIUS サーバーとしての NPS**します。 この例でアカウンティングを実行するローカルの NPS サーバーが構成されていないし、既定の接続要求ポリシーが改訂され、RADIUS アカウンティング メッセージは、NPS サーバーまたはリモート RADIUS サーバー グループの他の RADIUS サーバーに転送されるようにします。 アカウンティングのメッセージは転送が認証と承認のメッセージは転送されませんが、ローカルの NPS サーバーは、ローカル ドメインをこれらの関数を実行および信頼されているすべてのドメイン。

**Windows ユーザー マッピングへのリモート RADIUS で NPS**します。 この例では NPS の認証がローカルの Windows ユーザー アカウントの使用中にリモート RADIUS サーバーに認証要求を転送することによって RADIUS サーバーおよび各個々 の接続要求を RADIUS プロキシとして機能します。 この構成は、接続要求ポリシーの条件として、リモート RADIUS 属性の Windows ユーザー マッピングを構成することによって実装されます。 \ (さらに、ユーザー アカウント必要がありますできるにローカルで作成、RADIUS サーバーを対象となる認証は、リモート RADIUS サーバーで実行するリモート ユーザー アカウントと同じ名前を持つ \)。

## <a name="configuration"></a>構成

NPS を RADIUS サーバーとして構成するに、NPS コンソールでまたはサーバー マネージャーでは、標準の構成または高度な構成のいずれかを使用できます。 NPS を RADIUS プロキシとして構成するには、高度な構成を使用する必要があります。

### <a name="standard-configuration"></a>標準の構成

標準構成で、次のシナリオの NPS の構成に役立つウィザードが用意されています。

- ダイヤルアップまたは VPN 接続用の RADIUS サーバー
- 802.1 X ワイヤレスまたはワイヤード (有線) 接続用の RADIUS サーバー

ウィザードを使用して、NPS を構成するのには、NPS コンソールを開き、前述のシナリオのいずれかを選択およびウィザードを開くリンクをクリックしています。

### <a name="advanced-configuration"></a>高度な構成

高度な構成を使用する場合は、RADIUS サーバーまたは RADIUS プロキシとして NPS 手動で構成します。 

高度な構成を使用して、NPS を構成する、NPS コンソールを開き、横に矢印をクリックして**高度な構成**このセクションを展開します。

次のような高度な構成項目が提供されます。

#### <a name="configure-radius-server"></a>RADIUS サーバーを構成します。

NPS を RADIUS サーバーとして構成するには、RADIUS クライアント、ネットワーク ポリシー、および RADIUS アカウンティングを構成する必要があります。

これらの構成を行う方法については、次のトピックを参照してください。

- [RADIUS クライアントを構成します。](nps-radius-clients-configure.md)
- [ネットワーク ポリシーを構成します。](nps-np-configure.md)
- [ネットワーク ポリシー サーバー アカウンティングを構成します。](nps-accounting-configure.md)

#### <a name="configure-radius-proxy"></a>RADIUS プロキシを構成します。

NPS を RADIUS プロキシとして構成するには、RADIUS クライアント、リモート RADIUS サーバー グループ、および接続要求ポリシーを構成する必要があります。

これらの構成を行う方法については、次のトピックを参照してください。

- [RADIUS クライアントを構成します。](nps-radius-clients-configure.md)
- [リモート RADIUS サーバー グループを構成します。](nps-crp-rrsg-configure.md)
- [接続要求ポリシーを構成します。](nps-crp-configure.md)

## <a name="bkmk_logging"></a>NPS のログ記録

NPS のログ記録は、RADIUS アカウンティングとも呼ばれます。 NPS が NPS を RADIUS サーバー、プロキシ、またはこれらの構成の任意の組み合わせとして使用するかどうか、要件にログを構成します。

NPS のログを構成するには、ログに記録するイベント ログに記録され、イベント ビューアーで表示しているその他の情報を決定しを構成する必要があります。 さらに、テキスト ログ ファイルをローカル コンピューター上に保存するか、ローカル コンピューターまたはリモート コンピューター上の SQL Server データベースには、ユーザーの認証およびアカウンティング情報をログを記録するかどうかを決定する必要があります。

詳細については、次を参照してください。[ネットワーク ポリシー サーバー アカウンティングを構成する](nps-accounting-configure.md)します。
