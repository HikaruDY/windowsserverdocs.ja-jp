---
title: NIC チーミング
description: このトピックでは、するネットワーク インターフェイス カード (NIC) チーミングの概要 Windows Server 2016 でします。 NIC チーミングを使用すると、1 ~ 32 でグループに 1 つまたは複数のソフトウェア ベースの仮想ネットワーク アダプターの物理イーサネット ネットワーク アダプター。 これらの仮想ネットワーク アダプターは、高速なパフォーマンスに加え、ネットワーク アダプターに障害が発生した場合のフォールト トレランスを提供します。
manager: dougkim
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology:
- networking-nict
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: abded6f3-5708-4e35-9a9e-890e81924fec
ms.author: pashort
author: shortpatti
ms.date: 09/10/2018
ms.openlocfilehash: cf58956ead8e8a47b8ec6d189bf23e5c576d5f15
ms.sourcegitcommit: 6ef4986391607bb28593852d06cc6645e548a4b3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/07/2019
ms.locfileid: "66812185"
---
# <a name="nic-teaming"></a>NIC チーミング

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

このトピックでは、するネットワーク インターフェイス カード (NIC) チーミングの概要 Windows Server 2016 でします。 NIC チーミングを使用すると、1 ~ 32 でグループに 1 つまたは複数のソフトウェア ベースの仮想ネットワーク アダプターの物理イーサネット ネットワーク アダプター。 これらの仮想ネットワーク アダプターは、高速なパフォーマンスに加え、ネットワーク アダプターに障害が発生した場合のフォールト トレランスを提供します。  
  
> [!IMPORTANT]
> 同じ物理ホスト コンピューターで NIC チームのメンバーのネットワーク アダプターをインストールする必要があります。 

> [!TIP]  
> 1 つだけのネットワーク アダプターを含む NIC チームには、負荷分散とフェールオーバーを提供できません。 ただし、1 つのネットワーク アダプターでは、行えます NIC チーミング ネットワーク トラフィックの分離の仮想ローカル エリア ネットワーク (Vlan) も使用する場合。  
  
NIC チームにネットワーク アダプターを構成すると、それらの接続に、NIC チーミング ソリューションの common core、オペレーティング システムを 1 つまたは複数の仮想アダプター (チーム Nic [tNICs] またはチームのインターフェイスとも呼ばれます) について紹介しています。 

Windows Server 2016 では、チームごとに最大 32 のチームのインターフェイスをサポートするためのさまざまな Nic 間の送信トラフィック (読み込み) に分散するアルゴリズムがあります。  次の図は、複数 tNICs で NIC チームを示しています。  
  
![複数の tNICs で NIC チーム](../../media/NIC-Teaming/nict_overview.jpg)  
  
また、Nic のチーミングを同じスイッチまたは異なるスイッチに接続できます。 Nic を別々 のスイッチに接続する場合、同じサブネットに両方のスイッチを引き起こすことがあります。  
  
## <a name="availability"></a>対象  
NIC チーミングは、Windows Server 2016 のすべてのバージョンで使用できます。 NIC チーミングなど、クライアント オペレーティング システムを実行しているコンピューターを管理するさまざまなツールを使用することができます • Windows PowerShell コマンドレット、リモート デスクトップ、リモート サーバー管理ツール。  
  
## <a name="supported-and-unsupported-nics"></a>サポートされているとサポート非対象の Nic   
Windows Server 2016 で NIC チーム (WHQL テスト) Windows ハードウェア認定およびロゴ テストに成功した任意のイーサネット NIC を使用することができます。  
  
NIC チームには、次の Nic を配置できます。
  
-   ホスト パーティション内の Nic として公開されている HYPER-V 仮想スイッチ ポートである、HYPER-V 仮想ネットワーク アダプター。  
  
    > [!IMPORTANT]  
    > HYPER-V の仮想 Nic チーム内のホスト パーティション (Vnic) で公開されているを配置しないでください。 ホスト パーティション内の Vnic のチーミングの構成ではサポートされません。 しようとするチームの Vnic とは、ネットワーク障害が発生した場合、通信の完全喪失にすることがあります。  
  
-   カーネル デバッグ ネットワーク アダプター (KDNIC)。  
  
-   Nic をネットワーク ブートのために使用します。  
  
-   WWAN、WLAN、Wi-fi、Bluetooth、および Nic の Infiniband (IPoIB) 経由でインターネット プロトコルを含む、Infiniband などのイーサネット以外のテクノロジを使用する Nic です。  
  
## <a name="compatibility"></a>互換性  
NIC チーミングは、次の例外を Windows Server 2016 ですべてのネットワーク テクノロジとの互換性。  
  
-   **シングル ルート I/O 仮想化 (SR-IOV)** します。 SR-IOV のデータは (ホスト オペレーティング システム仮想化の場合) で、ネットワーク スタックを経由せず、NIC に直接配信します。 そのため、NIC チームを検査またはチームの別のパスにデータをリダイレクトすることはできません。  
  
-   **ネイティブ ホスト サービスの品質 (QoS)** します。 設定すると、ネイティブ モードまたはホスト システム上の QoS ポリシーとこれらのポリシーは、最小帯域幅の制限を呼び出し、NIC チームの全体的なスループットが、帯域幅のポリシーを適用せずことよりも少ない。  
  
-   **TCP Chimney**します。 TCP Chimney は、TCP Chimney NIC に直接のネットワーク スタック全体の負荷を軽減するための NIC チーミングでサポートされていません  
  
-   **802.1 x 認証**します。 一部のスイッチで 802.1 X 認証と同じポート上の NIC チーミングの構成が許可されていないため、NIC チーミングと 802.1 X 認証を使用する必要がありますできません。  
  
HYPER-V ホスト上で実行される仮想マシン (Vm) 内で NIC チーミングを使用して詳細については、次を参照してください。[ホスト コンピューターまたは VM に新しい NIC チームを作成する](Create-a-New-NIC-Team-on-a-Host-Computer-or-VM.md)します。
  
## <a name="virtual-machine-queues-vmqs"></a>仮想マシン キュー (VMQs)  

VMQs は、VM ごとに、キューによって割り当てられる NIC 機能です。  いつでも、HYPER-V が有効になっている; があります。また、VMQ を有効にする必要があります。 Windows Server 2016 では、VMQs は、同じ機能を提供するのに NIC のスイッチ拡張を vPort に割り当てられている 1 つのキューを使用します。 

構成モードの切り替えや、負荷分散アルゴリズム、に応じて NIC チーミングを表示します (最小キュー モード) のチームにアダプターによって使用可能でサポートされているキューの最小数または使用できるキューの合計数のいずれかすべてのチーム全体でメンバー (キューの合計モード)。  

チームがチーミング モードのスイッチに依存しない、HYPER-V ポートのモードまたはモードの動的に負荷分散を設定すると、報告されるキューの数は、チーム メンバー (キューの合計モード) から使用可能なすべてのキューの合計です。 それ以外の場合、報告されるキューの数は、(Min キュー モード)、チームのメンバーによってサポートされているキューの最小数です。

その理由を次に示します。  
  
-   スイッチに依存しないチームがの場合に、HYPER-V ポートのモードまたは動的モード (VM)、HYPER-V スイッチ ポートの受信トラフィック常には、同じチーム メンバーに到着します。 ホストできる予測/コントロール NIC チーミングは、特定のチーム メンバーに割り当てるには、どの VMQ キューについてよりよく考えられたために、どのメンバーが特定の VM に対してトラフィックを受け取る。 NIC チーミング、HYPER-V スイッチの操作では、VM の正確に 1 つのチーム メンバーに、VMQ を設定し、受信トラフィックがそのキューをヒットしたことを確認します。  
  
-   (静的チーミングまたは LACP チーミング) のスイッチ依存モードで、チームの場合に、チームが接続されているスイッチが受信トラフィック分散を制御します。 ホストの NIC チーミング ソフトウェアが VM のチーム メンバーの取得、着信トラフィックを予測することはできませんし、スイッチが、すべてのチーム メンバー間で VM のトラフィックを配布する場合があります。 NIC チーミング ソフトウェア、HYPER-V スイッチの操作の結果をすべてのチーム メンバー上の VM に対してキューのプログラムに 1 つだけでなくチームのメンバー。  
  
-   チームでは、スイッチ依存モードおよびアドレスのハッシュを使用して負荷分散、受信トラフィックはすべて 1 つのチーム メンバーの 1 つの NIC (プライマリ チームのメンバー) には - 常に、します。 他のチーム メンバーは、受信トラフィックを処理するはため、プライマリ メンバーに失敗した場合、受信トラフィックを取得するその他の任意のチーム メンバーを使用でき、キューが既に設定されているように、プライマリ メンバーと同じキューでプログラムが取得されます。  

- ほとんどの Nic があるキューの Receive Side Scaling (RSS) または VMQ のいずれかが同じ時点ではなくを使用します。 VMQ 設定の一部は、RSS のキューの設定はどの機能によって RSS および VMQ の両方の使用は現在使用されている一般的なキューに設定します。 各 NIC に、高度なプロパティでは、値 * RssBaseProcNumber と\*MaxRssProcessors します。 システムのパフォーマンスを高めるいくつかの VMQ 設定を次に示します。  
  
-   理想的には、各 NIC が必要、* よりも大きいまたは等しい RssBaseProcNumber が偶数に設定の 2 つ (2)。 最初の物理プロセッサ コア 0 (論理プロセッサを 0 と 1)、この物理プロセッサからネットワーク処理を調整する必要がありますので、システム処理のほとんどが通常は。 一部のコンピューターのアーキテクチャは、の物理プロセッサあたり 2 つの論理プロセッサがないため、1 以上、そのようなマシンの基本のプロセッサがあります。 かどうかの不明な想定物理プロセッサのアーキテクチャごとの 2 つの論理プロセッサの使用には、ホストします。  
  
-   チームがキューの合計モードの場合、チーム メンバー全員のプロセッサが重複しないする必要があります。 たとえば、10 gbps の 2 つの Nic のチームが 4 コアのホスト (論理プロセッサを 8) で設定できます 2 ベースのプロセッサを使用して、4 つのコアを使用する最初の 1 つ2 つ目は基本プロセッサ 6 を使用して、2 コアを使用して設定されます。  
  
-   チームは、Min キュー モードでは、チーム メンバーによって使用されるプロセッサ セットと同じ場合があります。  

  
## <a name="hyper-v-network-virtualization-hnv"></a>Hyper-V ネットワーク仮想化 (HNV)  
NIC チーミングは、HYPER-V ネットワーク仮想化 (HNV) で完全な互換性です。  HNV の管理システムは、HNV トラフィックを最適化する方法で負荷を分散する NIC チーミングを許可する NIC チーミングのドライバーに情報を提供します。  
  
## <a name="live-migration"></a>ライブ マイグレーション  
Vm の NIC チーミングは、ライブ マイグレーションには影響しません。 同じ規則は、VM の NIC チーミングを構成するかどうか、ライブ マイグレーションに存在します。  


## <a name="virtual-local-area-networks-vlans"></a>仮想ローカル エリア ネットワーク (Vlan)
NIC チーミングを使用する場合に、同時に別の Vlan に接続するホストを複数のチームのインターフェイスを作成できます。 次のガイドラインを使用して環境を構成します。
  
- NIC チーミングを有効にする前に、チーム化 (無作為検出) トランク モードを使用するホストに接続されている物理スイッチ ポートを構成します。 物理スイッチは、トラフィックを変更することがなくフィルター処理するため、ホストにすべてのトラフィックを渡す必要があります。  

- プロパティの設定を高度な NIC を使用して、Nic で VLAN のフィルターを構成しないでください。 NIC チーミング ソフトウェアを使って、または HYPER-V 仮想スイッチ (存在する) 場合は、VLAN がフィルター処理を実行します。  
  
### <a name="use-vlans-with-nic-teaming-in-a-vm"></a>VM の NIC チーミングで Vlan を使用します。  
チームは、HYPER-V 仮想スイッチに接続するときは、NIC チーミングではなく、HYPER-V 仮想スイッチですべての VLAN 分離を実行してください。  

次のガイドラインを使用して NIC チームに構成された VM で Vlan を使用する予定します。
  
-   HYPER-V 仮想スイッチ上の複数のポートを持つ VM を構成し、ポートごとに VLAN を関連付けるには、VM で複数の Vlan をサポートしているの勧めします。 ネットワーク通信の問題が発生しているため、VM でこれらのポートをチームことはありません。  

-   VM に複数の SR-IOV 仮想機能 (Vf) がある場合は、VM でそれらをチーミングする前に、同じ vlan が、ことを確認します。 別の Vlan 上に存在する異なる VFs を構成することが簡単には、ネットワーク通信の問題が発生します。  
 
  
### <a name="manage-network-interfaces-and-vlans"></a>ネットワーク インターフェイスと Vlan を管理します。 
ゲスト オペレーティング システムに公開されている複数の VLAN が必要な場合は、インターフェイスに割り当てられている VLAN が明確にイーサネット インターフェイスの名前を変更を検討してください。 関連付ける場合など**イーサネット**VLAN 12 とのインターフェイスと**Ethernet 2** VLAN 48 インターフェイス、イーサネット インターフェイスの名前を変更する**EthernetVLAN12**と他に**EthernetVLAN48**します。 

Windows PowerShell コマンドを使用してインターフェイスの名前を変更**Rename NetAdapter**または、次の手順を実行することで。
  
1.  サーバー マネージャーで**プロパティ**名前を変更するネットワーク アダプターのネットワーク アダプター名の右側にリンクをクリックします。 
  
2.  名前変更、および選択するネットワーク アダプターを右クリックして**の名前を変更**します。  
  
3.  ネットワーク アダプターの新しい名前を入力し、ENTER キーを押します。  


## <a name="virtual-machines-vms"></a>仮想マシン (Vm)

VM で NIC チーミングを使用する場合のみに外部 HYPER-V 仮想スイッチに VM の仮想ネットワーク アダプターを接続する必要があります。 これを行うには、1 つの仮想スイッチが失敗に接続されている物理ネットワーク アダプターのいずれか、または接続が切断されたときに、その環境であっても、ネットワーク接続を維持するために VM が使用できます。 内部またはプライベートの HYPER-V 仮想スイッチに接続されている仮想ネットワーク アダプターは、チームでは、VM のネットワークが失敗すると、スイッチに接続できません。  
  
Windows Server 2016 での NIC チーミングでは、仮想マシンで 2 つのメンバーのチームをサポートしています。 大規模なチームを作成できますが、大規模なチームはサポートされていません。 すべてのチーム メンバーは、さまざまな外部 HYPER-V 仮想スイッチに接続する必要があり、VM のネットワーク インターフェイスは、チーミングを許可するように構成する必要があります。

  
選択する必要があります、VM の NIC チームを構成する場合、**チーミング モード**の_スイッチに依存しない_と**負荷分散モード**の_アドレスのハッシュ_.   
  
  
## <a name="sr-iov-capable-network-adapters"></a>SR IOV 対応のネットワーク アダプター  
HYPER-V スイッチを通過しないために、NIC チームまたは HYPER-V ホストでは、SR-IOV トラフィックを保護できません。  オプションを使用して、VM の NIC チーミング、外部の 2 つの HYPER-V 仮想スイッチを構成すると、それぞれ独自の SR IOV 対応 NIC に接続  
  
![SR IOV 対応のネットワーク アダプターと NIC チーミング](../../media/NIC-Teaming-in-Virtual-Machines--VMs-/nict_in_vm.jpg)  
  
各 VM には、仮想機能 (VF) 個の SR-IOV Nic を 1 つまたは両方から、NIC の切断、プライマリ VF からバックアップ アダプター (VF) へのフェールオーバーが発生した場合を持つことができます。 代わりに、VM には、NIC ドライバーと非 VF vmNIC が別の仮想スイッチに接続されているいずれかから VF 場合があります。 VF に関連付けられた NIC の接続が切断された場合、トラフィックには、接続を失うことがなく他のスイッチにフェールオーバーことができます。  
  
VM の Nic 間のフェールオーバーは、他の vmNIC の MAC アドレスに送信されるトラフィックを可能性があります、ために、チーミングを許可する NIC のチーミングを使用して VM に関連付けられた各 HYPER-V 仮想スイッチ ポートを設定する必要があります。 


## <a name="related-topics"></a>関連トピック

- [NIC チーミングの MAC アドレスの使用と管理](NIC-Teaming-MAC-Address-Use-and-Management.md):Independent モードのスイッチとアドレスのハッシュまたは動的な負荷分散のいずれかで NIC チームを構成するときにメディア アクセス チームで使用してはの送信トラフィックにプライマリ NIC チームのメンバー (MAC) アドレスを制御します。 プライマリ NIC チームのメンバーは、チーム メンバーの初期セットから、オペレーティング システムによって選択されているネットワーク アダプターです。

- [NIC チーミング設定](nic-teaming-settings.md):、このトピックでは、チーミングなど、NIC チームのプロパティの概要を説明して、負荷分散モード。 スタンバイ アダプターの設定とプライマリ チーム インターフェイスのプロパティの詳細についても用意します。 を NIC チームで少なくとも 2 つのネットワーク アダプターがある場合は、フォールト トレランスのスタンバイ アダプターを指定する必要はありません。
  
- [ホスト コンピューターまたは VM に新しい NIC チームを作成する](Create-a-New-NIC-Team-on-a-Host-Computer-or-VM.md):このトピックでは、ホスト コンピューターまたは Windows Server 2016 を実行する HYPER-V 仮想マシン (VM) で新しい NIC チームを作成します。

- [NIC チーミングのトラブルシューティング](Troubleshooting-NIC-Teaming.md):このトピックでは、NIC チーミングは、ハードウェア、物理スイッチ証券、および Windows PowerShell を使用してネットワーク アダプターを無効化または有効化などをトラブルシューティングする方法について説明します。 
 
