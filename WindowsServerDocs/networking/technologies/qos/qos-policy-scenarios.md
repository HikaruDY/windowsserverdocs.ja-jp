---
title: QoS ポリシーのシナリオ
description: このトピックでは、サービスの品質 (QoS) ポリシーのシナリオは、グループ ポリシーを使用して、特定のアプリケーションおよび Windows Server 2016 でのサービスのネットワーク トラフィックの優先順位を設定する方法を示します。
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: c4306f06-a117-4f65-b78b-9fd0d1133f95
manager: brianlic
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 2617c897ed2ea173d29fc7c4a87e52557154d463
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2019
ms.locfileid: "66446994"
---
# <a name="qos-policy-scenarios"></a>QoS ポリシーのシナリオ

>適用対象:Windows Server 2016 の Windows Server (半期チャネル)

このトピックを使用するには、示す架空のシナリオを調査する方法については、QoS ポリシーを使用する、タイミングと理由。

このトピックでは、2 つのシナリオは次のとおりです。

1. 基幹業務アプリケーションのネットワーク トラフィックを優先順位を付ける
2. HTTP サーバー アプリケーションのネットワーク トラフィックを優先順位を付ける

>[!NOTE]
>このトピックのいくつかのセクションには、定義されたアクションを実行するための一般的な手順が含まれます。 QoS ポリシーを管理する方法について詳細を参照してください。 [QoS ポリシーの管理](qos-policy-manage.md)します。

## <a name="scenario-1-prioritize-network-traffic-for-a-line-of-business-application"></a>シナリオ 1:基幹業務アプリケーションのネットワーク トラフィックを優先順位を付ける

このシナリオで、IT 部門は QoS ポリシーを使用して実現できるいくつかの目標があります。

- ミッションのネットワーク パフォーマンスを向上\-クリティカルなアプリケーションです。
- 特定のアプリケーションを使用しているが、ユーザーのキーのセットのネットワーク パフォーマンスが向上を提供します。
- 会社を必ず\-全体のデータのバックアップ アプリケーションは、多くの帯域幅を一度に 1 つを使用してネットワークのパフォーマンスを妨げるしません。

IT 部門は、QoS ポリシーの差別化サービスのコード ポイントを使用して特定のアプリケーションの優先順位を構成する決定\(DSCP\)値、ネットワーク トラフィックの分類を優先的に提供するには、そのルーターを構成するには高い優先度のトラフィックを処理します。 

>[!NOTE]
>DSCP の詳細については、セクションをご覧ください。**定義 QoS 優先順位で、差別化されたサービス コード ポイントの**、トピックの「[サービスの品質 (QoS) ポリシー](qos-policy-top.md)します。

QoS ポリシーは、DSCP 値だけでなく、スロットル率を指定できます。 調整は、すべての送信トラフィック特定 QoS ポリシーの一致の送信率を制限することの影響です。

### <a name="qos-policy-configuration"></a>QoS ポリシーの構成

実行する独立した 3 つの目標を持つ 3 つの異なる QoS ポリシーを作成する、IT 管理者が決定します。

#### <a name="qos-policy-for-lob-app-servers"></a>LOB アプリのサーバーの QoS ポリシー

最初のミッション\-クリティカルなアプリケーションが IT 部門で QoS ポリシーを作成しますが、会社\-ワイド エンタープライズ リソース プランニング\(ERP\)アプリケーション。 ERP アプリケーションは、すべて Windows Server 2016 を実行している複数のコンピューターでホストされます。 これらのコンピューターで Active Directory Domain Services では、組織単位のメンバーである\(OU\)基幹業務用に作成された\(LOB\)アプリケーション サーバー。 クライアント\-ERP アプリケーション側のコンポーネントは Windows 10 および Windows 8.1 を実行しているコンピューターにインストールします。

グループ ポリシーで、IT 管理者がグループ ポリシー オブジェクトを選択\(GPO\) QoS ポリシーを適用するとします。 IT 管理者と呼ばれる QoS ポリシーの作成、QoS ポリシー ウィザードを使用すると、"LOB サーバー ポリシー"高値を指定する\-優先度のすべてのアプリケーション、任意の IP アドレス、TCP、UDP、およびポート番号 44 の DSCP 値。

LOB サーバーにのみ、このサーバーにのみ、グループ ポリシー管理コンソールを使用してを含む OU に GPO をリンクすることによって、QoS ポリシーが適用される\(GPMC\)ツール。 この最初のサーバーに LOB ポリシーの適用、高\-優先度の DSCP 値、コンピューターがネットワーク トラフィックが送信されるたびにします。 後でこの QoS ポリシーを編集できる\(グループ ポリシー オブジェクト エディター ツールで\)ERP アプリケーションのポート番号は、指定したポート番号が使用される場合にのみ適用するポリシーの制限を含める。

#### <a name="qos-policy-for-the-finance-group"></a>経理グループの QoS ポリシー

企業内の多数のグループは、ERP アプリケーションにアクセスするときに、finance グループは、お客様は、処理する場合、このアプリケーションとは異なります。 と、グループ、アプリから常に高いパフォーマンスが必要です。

財務グループで、顧客がサポートしていることを確認するには、QoS ポリシーが、優先度の高いとしてこれらのユーザーのトラフィックを分類する必要があります。 ただし、ポリシーは必要があります、経理グループのメンバー、ERP アプリケーション以外のアプリケーションを使用する場合に適用されません。 

このため、IT 部門と呼ばれる 2 番目の QoS ポリシーを定義します"LOB のクライアント ポリシー"経理ユーザーのグループは、ERP アプリケーションを実行すると、60 の DSCP 値を適用するグループ ポリシー オブジェクト エディターのツールでします。

#### <a name="qos-policy-for-a-backup-app"></a>アプリのバックアップの QoS ポリシー

別のバックアップ アプリケーションは、すべてのコンピューターで実行されています。 バックアップ アプリケーションのトラフィックはすべての利用可能なネットワーク リソースを使用しないことを確認するには、IT 部門では、データのバックアップ ポリシーを作成します。 このバックアップ ポリシーは、バックアップのアプリの実行可能ファイル名に基づく 1 の DSCP 値を指定する**backup.exe**します。 

3 つ目の GPO が作成され、ドメイン内のすべてのクライアント コンピューターに展開します。 バックアップ アプリケーションでは、データを送信するたびに優先順位の低い DSCP 値を適用すると、財務部門内のコンピューターから発生する場合でもです。
  
>[!NOTE]
>DSCP 値が 0 で QoS ポリシーのないネットワーク トラフィックを送信します。

### <a name="scenario-policies"></a>シナリオのポリシー

次の表では、このシナリオの QoS ポリシーをまとめたものです。
  
|ポリシー名|DSCP 値|スロットル率|組織単位に適用|説明|  
|-----------------|----------------|-------------------|-----------------------------------|-----------------|
|[ポリシーなし]|0|なし|[デプロイしない]|未分類のトラフィックの最適な残存作業時間 (既定値) 処理。|  
|バックアップ データ|1|なし|すべてのクライアント|この一括データの優先順位の低い DSCP 値を適用します。|  
|LOB サーバー|44|なし|ERP サーバーのコンピューターの OU|ERP server トラフィック用の優先度の高い DSCP を適用します。|  
|クライアント LOB|60|なし|経理ユーザー グループ|優先度の高い DSCP ERP クライアント トラフィック向けの適用します。|  

>[!NOTE]
>DSCP 値は 10 進形式で表されます。

QoS ポリシーが定義されているし、グループ ポリシーを使用して、適用では、送信ネットワーク トラフィックは、ポリシーが指定した DSCP 値を受け取ります。 ルーターは、キューを使用してこれらの DSCP 値に基づく差分の処理を提供します。 次の 4 つのキューにこの IT 部門のルーターが構成されている: 優先度の高い、中間の優先度、ベスト エフォート、および優先順位の低い。

トラフィックの DSCP 値を使用して、ルーターが届いたとき"Server LOB ポリシー"と"LOB のクライアント ポリシーを"データは優先度の高いキューに配置されます。 DSCP 値が 0 でのトラフィックは、サービス レベルをベスト エフォートを受け取ります。 (バックアップ アプリケーション) から 1 の DSCP 値を持つパケットは、優先順位の低い扱いを受けます。  
  
### <a name="prerequisites-for-prioritizing-a-line-of-business-application"></a>基幹業務アプリケーションの優先順位を付けるための前提条件

このタスクを完了するには、次の要件を満たしていることを確認します。

- 含まれるコンピューターは、QoS を実行している\-互換性のあるオペレーティング システム。

- 含まれるコンピューターを Active Directory Domain Services のメンバーである\(AD DS\)ドメイン グループ ポリシーを使用して構成できるようにします。

- TCP/IP ネットワークに DSCP 用に構成されたルーターで設定されている\(RFC 2474\)します。 詳細については、次を参照してください。 [RFC 2474](https://www.ietf.org/rfc/rfc2474.txt)します。

- 管理者の資格情報の要件が満たされています。

#### <a name="administrative-credentials"></a>管理資格情報

このタスクを完了するには、は作成し、グループ ポリシー オブジェクトを展開できる必要があります。
  
#### <a name="setting-up-the-test-environment-for-prioritizing-a-line-of-business-application"></a>基幹業務アプリケーションの優先順位付けのテスト環境のセットアップ

テスト環境をセットアップするには、次のタスクを完了します。

- クライアントおよびユーザーの組織単位にグループ化と、AD DS ドメインを作成します。 AD DS の展開の手順については、次を参照してください。、[コア ネットワーク ガイド](https://docs.microsoft.com/windows-server/networking/core-network-guide/core-network-guide)します。

- DSCP 値に基づいてキュー差分にルーターを構成します。 たとえば、DSCP 値を 44 が"Platinum"キューを入力し、重み付け公正-キューにその他すべてがします。

>[!NOTE]
> DSCP 値を表示するには、ネットワーク モニターなどのツールでのネットワーク キャプチャを使用します。 ネットワーク キャプチャを実行した後は、キャプチャされたデータの TOS フィールドを確認できます。

#### <a name="steps-for-prioritizing-a-line-of-business-application"></a>基幹業務アプリケーションの優先順位を付けるための手順

基幹業務アプリケーションを優先するには、次のタスクを実行します。

1. 作成し、グループ ポリシー オブジェクトをリンク\(GPO\) QoS ポリシーを使用します。

2. 差分ビジネス行を処理するルーターを構成、選択した DSCP 値に基づいて (を使用してアプリケーション キュー)。 このタスクの手順は、ルーターがあるの種類によって異なります。

## <a name="scenario-2-prioritize-network-traffic-for-an-http-server-application"></a>例 2:HTTP サーバー アプリケーションのネットワーク トラフィックを優先順位を付ける

Windows Server 2016 では、ポリシー ベースの QoS には、URL ベースのポリシーの機能が含まれています。 URL のポリシーでは、HTTP サーバーの帯域幅を管理できます。

多くのエンタープライズ アプリケーションが用に開発され、インターネット インフォメーション サービスでホストされている\(IIS\) web サーバー、および Web apps は、クライアント コンピューター上のブラウザーからアクセスされます。

このシナリオでは、管理すること、IIS サーバーのセットをホストのトレーニング ビデオ、組織内のすべての従業員のものとします。 これらのビデオのサーバーからのトラフィックが、ネットワークで、過負荷し、ビデオのトラフィックがネットワークで音声およびデータのトラフィックから差別化されたことを確認しないことを確認することが目的です。 

タスクは、シナリオ 1 での作業に似ています。 設計され、ビデオのトラフィックの DSCP 値など、トラフィック管理設定を構成し、基幹業務アプリケーションの場合と同じレート、調整します。 HTTP サーバー アプリケーションが応答する URL を入力のみ、アプリケーション名を指定する代わりに、トラフィックを指定する場合: たとえば、 https://hrweb/training。
  
> [!NOTE]
>URL ベースの QoS ポリシーを使用して、Windows 7 および Windows Server 2008 R2 より前にリリースされた Windows オペレーティング システムを実行しているコンピューターのネットワーク トラフィックの優先順位を付けることはできません。

### <a name="precedence-rules-for-url-based-policies"></a>URL ベースのポリシーの優先順位規則

次の Url が有効であり、すべての QoS ポリシーで指定し、コンピューターまたはユーザーに同時に適用します。

- https://video

- https://training.hr.mycompany.com

- https://10.1.10.249:8080/tech  

- https://*/ebooks

どの優先順位が表示されますか。 ルールは簡単です。 左から右の読み取り順序で URL ベースのポリシーの優先順位を設定します。 そのため、最も低い優先順位に最も高い優先順位から URL フィールドには。
  
[1.URL スキーム](#bkmk_QoS_UrlScheme)

[2.URL のホスト](#bkmk_QoS_UrlHost)

[3.URL のポート](#bkmk_QoS_UrlPort)

[4.URL パス](#bkmk_QoS_UrlPath)

詳細は次のとおりです。

####  <a name="bkmk_QoS_UrlScheme"></a> 1.URL スキーム

 `https://` も優先順位が高い`https://`します。

####  <a name="bkmk_QoS_UrlHost"></a> 2.URL のホスト

 最小の優先度の高いには。

1. hostname

2. IPv6 アドレス

3. IPv4 アドレス

4. ワイルドカード

場合は、ホスト名は、ピリオドで区切られた複数の要素 (詳細) を持つホスト名は、ホスト名が、ピリオドで区切られた要素の数が少ないより高い優先度をが。 たとえば、次のホスト名: 間

- video.internal.training.hr.mycompany.com (深さ = 6)
  
- selfguide.training.mycompany.com (深さ = 4)
  
- トレーニング (深さ = 1)
  
- ライブラリ (深さ = 1)
  
  **video.internal.training.hr.mycompany.com**が最高の優先順位と**selfguide.training.mycompany.com**が [次へ] の最高の優先順位。 **トレーニング**と**ライブラリ**同じ最も低い優先順位を共有します。  
  
####  <a name="bkmk_QoS_UrlPort"></a> 3.URL のポート

特定のまたは暗黙的なポート番号をワイルドカード ポートより高い優先順位を持っています。

####  <a name="bkmk_QoS_UrlPath"></a> 4.URL パス

ホスト名のような URL パスは可能性があります複数の要素で構成されます。 要素の 1 つは、常より少ない労力でより高い優先順位を持ちます。 たとえば、次のパスは優先度順に表示します。  

1.  /ebooks/tech/windows/networking/qos

2.  /ebooks/tech/windows/

3.  /ebooks

4.  /

すべてのサブディレクトリおよびファイルの次の URL パスを含めるには、ユーザーが選択した、この URL パスが選択が行われなかった場合よりも低い優先順位になります。

ユーザーは、URL ベースのポリシーで、宛先 IP アドレスを指定することもできます。 宛先 IP アドレスが、前に説明した 4 つの URL フィールドのいずれかのよりも優先順位の低い。
  
### <a name="quintuple-policy"></a>5 倍のポリシー

5 倍のポリシーは、プロトコル ID、送信元 IP アドレス、ソース ポート、宛先 IP アドレス、および宛先ポートによって指定されます。 5 倍のポリシーは、常に、URL ベースのポリシーよりも高い優先順位を持ちます。 

ユーザーの既に 5 倍のポリシーが適用される場合 URL ベースの新しいポリシーは競合が発生しないユーザーのクライアントのいずれかのコンピューター。

次のトピックでは、このガイドでは、次を参照してください。 [QoS ポリシーの管理](qos-policy-manage.md)します。

このガイドの最初のトピックを参照してください。[サービスの品質 (QoS) ポリシー](qos-policy-top.md)します。
