---
ms.assetid: 72a90d00-56ee-48a9-9fae-64cbad29556c
title: Windows Server 2016 の正確な時刻
description: 時刻同期の精度の Windows Server 2016 では、完全な下位 NTP の古いバージョンの Windows 互換性を維持しながら、大幅に向上しています。
author: shortpatti
ms.author: dacuo
ms.date: 05/08/2018
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: networking
ms.openlocfilehash: 75465aad45fc1b5e360fa1153a6530a771731f66
ms.sourcegitcommit: 63926404009f9e1330a4a0aa8cb9821a2dd7187e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/29/2019
ms.locfileid: "67469434"
---
# <a name="accurate-time-for-windows-server-2016"></a>Windows Server 2016 の正確な時刻

>適用対象:Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows 10 以降

Windows タイム サービスは、クライアントとサーバーの時刻同期プロバイダーのプラグイン モデルを使用するコンポーネントです。  Windows に 2 つの組み込みのクライアント プロバイダーがあり、サード パーティ プラグインがある使用可能です。 1 つのプロバイダーを使用して[NTP (RFC 1305)](https://tools.ietf.org/html/rfc1305)または[MS NTP](https://msdn.microsoft.com/library/cc246877.aspx) NTP や MS NTP の参照を準拠しているサーバーにローカル システム時刻を同期します。 他のプロバイダーは、HYPER-V の HYPER-V ホストに仮想マシン (VM) を同期します。  複数のプロバイダーが存在する場合、Windows はルートの遅延、ルートの分散、後に最初に、階層レベルを使用して最適なプロバイダーを選択し、最後に時刻のオフセット。

> [!NOTE]
> Windows タイム サービスの簡単な概要については、これを参照してください[概要ビデオ](https://aka.ms/WS2016TimeVideo)します。

このトピックでは、以下の操作について説明しています.これらのトピックに関連する正確な時刻を有効にします。 

- 機能強化
- 測定値
- ベスト プラクティス

> [!IMPORTANT]
> Windows 2016 の正確性の時間の記事で参照されている補遺がダウンロードできる[ここ](https://windocs.blob.core.windows.net/windocs/WindowsTimeSyncAccuracy_Addendum.pdf)します。  このドキュメントでは、テストおよび測定方法論の詳細を提供します。

> [!NOTE] 
> Windows タイム プロバイダー プラグイン モデルは[TechNet に記載されている](https://msdn.microsoft.com/library/windows/desktop/ms725475%28v=vs.85%29.aspx)します。

## <a name="domain-hierarchy"></a>ドメインの階層
ドメインとスタンドアロン構成の動作が異なります。

- ドメインのメンバーでは、セキュリティで保護されたセキュリティと時刻の参照の信頼性を確保する認証を使用する NTP プロトコルを使用します。  ドメインのメンバーは、ドメインの階層とスコア付けシステムによって決まりますマスターのクロックと同期します。  ドメインでは、各 DC がより正確な時間階層で親 DC を指すための時間 stratums の階層的なレイヤーがあります。  階層は、PDC、フォレスト ルート内の DC またはドメインの適切なタイム サーバーを表す GTIMESERV ドメイン フラグを使用して DC に解決されます。  参照してください、[指定をローカル信頼性の高いタイム サービスを使用して GTIMESERV](#GTIMESERV)以下のセクション。

- 既定で time.windows.com を使用するスタンドアロン マシンが構成されます。  この名前は、Microsoft 所有されたリソースをポイントする必要があります DNS サーバーによって解決されます。  ネットワーク障害、すべてのリモートに配置されている時間参照のような同期を妨げる可能性があります。  ネットワーク トラフィックの負荷し、非対称のネットワーク パスで時刻の同期の正確性を減らすことができます。  1 ミリ秒の精度のためには、リモートのタイム ソースに依存することはできません。

HYPER-V ゲストは、少なくとも 2 つの Windows タイム プロバイダーから選択する必要があります、ため、ホストの時間と NTP、表示されるドメインまたはスタンドアロンのいずれかで異なる動作をゲストとして実行する場合。

> [!NOTE] 
> ドメインの階層とシステムのスコア付けの詳細については、次を参照してください、 ["Windows タイム サービスは何でしょうか。"。](https://blogs.msdn.microsoft.com/w32time/2007/07/07/what-is-windows-time-service/) をご覧ください。

> [!NOTE]
> 階層は、NTP と HYPER-V の両方のプロバイダーで使用される概念と、その値を階層内のクロックの場所を示します。  Stratum 1 が最上位レベルのクロックの予約済みおよび階層 0 の正確であると見なされます、ハードウェアに予約されているし、はあまりまたは遅延関連付けられていません。  階層 2 は、これに stratum 1 サーバー、階層 2 には、階層 3 に問い合わせてください。  下位階層より正確なクロックの場合を示して、不一致を検出できなくなります。  また、W32time は、時間階層 15 から以下のみを受け入れます。  クライアントの階層を表示する*w32tm/query/status*します。

## <a name="critical-factors-for-accurate-time"></a>正確な時刻の重要な要素
正確な時刻のすべてのケースでは、次の 3 つの重要な要因があります。

1. **Solid ソース クロック**-ソースの時計、ドメインのニーズが安定的かつ正確にします。 これは通常、GPS デバイスのインストールまたは 3 を考慮して、階層 1 のソースを指すことを意味します。 類似点と比較して、その他のいずれかの高度の測定しようとしているが、2 つの船すると、水がある場合、精度は、ソースの登場は非常に安定したおよび移動しない場合に最適です。 時間、同じことがし、ソースの時計が安定していない場合クロックを同期させるのチェーン全体が影響を受ける各段階で拡大します。 アクセスできなければなりませんので、接続の中断時間の同期が妨げられます。 セキュリティで保護された、最後にあります。 参照が適切に保持されるため、または悪意のあるパーティによって運用される、時間ベースの攻撃へのドメインを公開する可能性があります。
2. **安定したクライアントのクロック**-安定したクライアント クロック オシレーターの自然な誤差が containable であることを保証します。  NTP では、可能性のある複数の NTP サーバーから複数のサンプルを使用して、条件し、ローカル コンピューター時計の規律します。  時刻の変更はステップしませんではなく速度の低下もすばやく正確な時刻のアプローチし、NTP 要求間で正確に維持できるローカル クロック速度が向上します。  ただし、クライアント コンピューターの時計のオシレーターが安定しない場合、調整の間の複数の変動が発生することが、Windows は、クロックの条件を使用して、アルゴリズムが正確に動作しません。  場合によっては、ファームウェアの更新プログラムを正確な時刻を必要な場合があります。
3. **対称的な NTP 通信**-NTP 通信用の接続が対称的なことが重要です。  NTP は、計算を使用して、ネットワークの更新プログラムが対称的な前提としている時間を調整します。  パス NTP パケットを受け取る場合、サーバーに、さまざまな時間のかかるを返す、精度が影響を受けます。  たとえば、ネットワーク トポロジ、または別のインターフェイスの速度のデバイスからルーティング対象パケットの変更のため、パスの変更でした。

バッテリ電源デバイス、モバイルと移植可能で、両方は、さまざまな方法を検討する必要があります。  当社の推奨事項に従って正確な時刻を維持することを 1 秒、クロックの更新頻度と相関関係がある統制されたクロックが必要です。 これらの設定は、推測され、そのようなデバイスの Windows で利用できるモードを省電力に干渉するよりも多くのバッテリ電力を消費します。 バッテリ電源デバイスでは、すべてのアプリケーションの実行で、クロックを規律し、正確な時刻を維持する W32time の機能に干渉を停止する特定の電源モードもあります。 さらに、モバイル デバイスのクロックが不正確になる非常にまずします。  アンビエント環境条件クロックの精度に影響を与える、モバイル デバイスは、1 つのアンビエント条件から時刻を正確に保持する機能を妨げる可能性が次に移動できます。  Microsoft が高精度の設定で、バッテリ電源をポータブル デバイスを設定することを推奨しないため、します。 

## <a name="why-is-time-important"></a>時間が重要な理由  
これは、さまざまな理由が正確な時刻をする必要があります。  Windows の一般的には、Kerberos クライアントとサーバー間の精度が 5 分必要があります。  ただし、これには時間精度を含めることによって影響を受けることができます、他の多くの領域があります。


- 政府の規制は次のようです。
    - 米国で FINRA の精度が 50 ミリ秒
    - 1 ミリ秒 ESMA (MiFID II)、EU 内に存在します。
- 暗号化アルゴリズム
- クラスター/Sql/exchange、およびドキュメント Db のような分散システム
- トランザクションのビットコイン ブロック チェーン フレームワーク
- 分散ログと脅威の分析 
- AD レプリケーション
- PCI (Payment Card Industry)、現在 1 の 2 つ目の精度



[!INCLUDE [windows-server-2016-improvements](windows-server-2016-improvements.md)]
