---
title: 構成し、フェールオーバー クラスターでクォーラムを管理します。
description: Windows Server フェールオーバー クラスターでクラスター クォーラムを管理する方法の詳細情報。
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 01/18/2019
ms.localizationpriority: medium
ms.openlocfilehash: 21f99362205e0a6aa90ebd26cef8f3a779bdc1dc
ms.sourcegitcommit: 28dc7c7f1e44fee7ab2112228af329a9ce0e02ba
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/22/2019
ms.locfileid: "9023998"
---
# クォーラムを構成および管理する

>適用対象: Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

このトピックでは、背景との構成し、Windows Server フェールオーバー クラスターでクォーラムを管理する手順を説明します。

## クォーラムを理解します。

クラスターのクォーラムは正常に起動または実行を継続をそのクラスターのアクティブなクラスター メンバーシップの一部でなければ返信の要素の数によって決まります。 詳細については、[クラスターとプール クォーラムのドキュメントを理解すること](../storage/storage-spaces/understand-quorum.md)を参照してください。

## クォーラム構成オプション

Windows Server のクォーラム モデルの柔軟性があります。 クラスターのクォーラムの構成を変更する必要がある場合は、クラスター クォーラムの構成ウィザードまたはフェールオーバー クラスターの Windows PowerShell コマンドレットを使用できます。 手順と考慮事項、クォーラムの構成をこのトピックの後半で[クラスター クォーラムの構成](#configure-the-cluster-quorum)を参照してください。

次の表では、クラスター クォーラムの構成ウィザードで利用できる 3 つのクォーラムの構成オプションを示します。

<table>
<thead>
<tr class="header">
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>一般的な設定を使用します。</td>
<td>クラスターは、各ノードに投票を自動的に割り当てられ、ノードの票を動的に管理します。 クラスターの適切なクラスターの共有記憶域がある利用可能な場合は、クラスターは、ディスクの監視を選択します。 ほとんどの場合は、このオプションをお勧め、クラスターの場合、最高レベルの可用性を提供するため、クラスターのソフトウェアが自動的に、クォーラムと監視の構成を選択します。</td>
</tr>
<tr class="even">
<td>追加または変更するクォーラム監視</td>
<td>追加、変更、または監視リソースを削除することができます。 ファイルの共有またはディスクの監視を構成することができます。 クラスターは、各ノードに投票を自動的に割り当てられ、ノードの票を動的に管理します。</td>
</tr>
<tr class="odd">
<td>高度なクォーラムの構成と監視の選択</td>
<td>クォーラムを構成するための特定のアプリケーションまたはサイト固有の要件がある場合にのみ、このオプションを選択する必要があります。 クォーラム監視を変更して追加や、ノードの票を削除するか、およびクラスターが動的にノードの票を管理するかどうかを選択できます。 既定では、票が、すべてのノードに割り当てられているし、ノードの票が動的に管理します。</td>
</tr>
</tbody>
</table>

クォーラム構成オプションを選択して、特定の設定、に応じてクラスターがクォーラム モードは次のいずれかで構成されます。

<table>
<thead>
<tr class="header">
<th>モード</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ノードの大部分 (監視なし)</td>
<td>投票があるノードのみです。 クォーラム監視が構成されていません。 クラスター クォーラムでは、アクティブなクラスター メンバーシップの返信のノードの大部分です。</td>
</tr>
<tr class="even">
<td>ノードの大部分を監視 (ディスクまたはファイル共有)</td>
<td>ノードでは、票があります。 さらに、クォーラム監視は、投票をいます。 クラスター クォーラムでは、アクティブなクラスター メンバーシップと監視投票内の返信のノードの大部分です。<br />
<br />
クォーラム監視は、指定されたディスク監視または指定されたファイル共有監視できます。</td>
</tr>
<tr class="odd">
<td>なしの大部分 (ディスク監視のみ)</td>
<td>ノードがある投票ありません。 ディスクの監視だけでは、投票があります。 クラスター クォーラムについては、ディスクの監視の状態によって決まります。<br />
<br />
クラスターでは、1 つのノードが利用可能であり、クラスターの記憶域で特定のディスクとの通信中である場合、クォーラムがあります。 一般に、このモードは推奨されませんとにする必要がありますいない選択するクラスターでの障害の 1 つのポイントが作成されるため。</td>
</tr>
</tbody>
</table>

次のサブセクションでは、高度なクォーラム構成の設定について詳しくを提供します。

### 監視の構成

一般的な規則として、クォーラムを構成するとき、クラスター内の返信の要素があります奇数。 したがって、クラスターにノードへの投票の偶数が含まれている場合は、ディスクの監視やファイル共有監視を構成する必要があります。 クラスターは、下に追加の 1 つのノードを維持するためにはできます。 さらに、監視投票を追加することにより、クラスターは、半分のクラスター ノードを同時にダウンまたは切断されている場合は、実行を継続します。

ディスクの監視は通常、すべてのノードは、ディスクを表示できる場合に推奨されます。 レプリケートされた記憶域を持つマルチサイト ディザスター リカバリーを考慮する必要がある場合は、ファイル共有監視の使用をお勧めします。 レプリケートされた記憶域を持つディスクの監視を構成することは、記憶域のベンダーは、すべてのサイトからレプリケートされた記憶域への読み取り/書き込みアクセスをサポートしている場合にのみ可能性があります。 <strong>*記憶域スペース ダイレクト サポートされていないディスク監視*</strong>します。

次の表は、追加の情報とクォーラム監視の種類に関する考慮事項を示します。

<table>
<thead>
<tr class="header">
<th>監視の種類</th>
<th>説明</th>
<th>要件と推奨事項</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ディスクの監視</td>
<td>- 専用の LUN、クラスター データベースのコピーを保存します。<br />
- クラスター共有 (レプリケートされません) 記憶域を持つ場合に最も役立ちます</td>
<td>- LUN のサイズは 512 MB 以上である必要があります。<br />
- 専用のクラスターで使用して、クラスター化されたロールに割り当てられていないする必要があります<br />
- 記憶域とパスのクラスター化された記憶域の検証テストに含める必要があります。<br />
- クラスター共有ボリューム (CSV) のディスクをすることはできません。<br />
- 1 つのボリュームをベーシック ディスク<br />
- ドライブ文字を設定する必要はありません。<br />
- NTFS または ReFS でフォーマットされていることができます。<br />
- フォールト トレランスのためのハードウェア RAID と必要に応じて構成することができます。<br />
- バックアップおよびウイルス対策スキャンから除外する必要があります。<br />
- 記憶域スペース ダイレクト ディスク監視はサポートされていません</td>
</tr>
<tr class="even">
<td>ファイル共有監視</td>
<td>- Windows Server を実行しているファイル サーバーで構成されている SMB ファイル共有<br />
- クラスター データベースのコピーを保存しません。<br />
- Witness.log ファイルのみでクラスターの情報を保持します。<br />
- レプリケートされた記憶域のマルチサイトのクラスターに最も役立ちます</td>
<td>- 5 MB の空き領域の最小値があります。<br />
- 専用に 1 つのクラスターを未使用のユーザーまたはアプリケーションのデータを保存する必要があります<br />
- クラスター名のコンピューター オブジェクトの有効な書き込みのアクセス許可が必要があります。<br />
<br />
ファイル共有監視をホストしているファイル サーバーの追加に関する考慮事項を次に示します。<br />
<br />
- クラスターの複数のファイル共有証人では、1 つのファイル サーバーを構成できます。<br />
- ファイル サーバーは、クラスターのワークロードとは別のサイト上にする必要があります。 これにより、サイトのネットワーク通信が失われた場合に、クラスター サイトのチャンスです。 同じサイト上のファイル サーバーの場合は、そのサイト、プライマリ サイトになり、ファイル共有にアクセスできる唯一のサイトがします。<br />
- ファイル サーバーは、ファイル共有監視を使用する同じクラスター上で仮想マシンがホストされていない場合、仮想マシンで実行できます。<br />
- 高可用性の個別のフェールオーバー クラスター上で、ファイル サーバーを構成できます。</td>
</tr>

<tr class-"odd">
<td>クラウド監視</td>
<td>- Azure blob ストレージに格納されている監視ファイル<br>
-クラスター内のすべてのサーバーの信頼性の高いインターネット接続がある場合にお勧めします。</td>
<td>参照してください<a href="https://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness">クラウド監視を展開</a>します。</td>
<td>
</td>
</tr>

</tbody>
</table>

### ノードの票の割り当て

高度なクォーラムの構成オプションとして割り当てるか、クォーラム票ノードごとを削除することもできます。 既定では、すべてのノードに投票が割り当てられます。 投票の割り当てに関係なくすべてのノードは引き続き、クラスター内の関数で、クラスター データベースの更新プログラムを受信して、アプリケーションをホストすることができます。

特定の障害回復構成内のノードから投票を削除することがあります。 たとえば、マルチサイト クラスターで、これらのノードはクォーラム計算に影響しないようにに投票をバックアップ サイト内のノードからに削除する可能性があります。 この構成は、サイト間で手動によるフェールオーバーに対してのみお勧めします。 詳細については、このトピックの後半で[災害復旧の構成のクォーラムに関する考慮事項](#quorum-considerations-for-disaster-recovery-configurations)を参照してください。

構成済みのノードの票を検証するには、 [Get ClusterNode](http://technet.microsoft.com/library/hh847268.aspx)Windows PowerShell コマンドレットを使用して、クラスター ノードの**NodeWeight**一般的なプロパティを調べます。 値 0 は、ノードが構成されているクォーラム投票を持っていないことを示します。 値を 1 ことを示し、ノードのクォーラム投票が割り当てられますがクラスターによって管理します。 ノードの票の管理について詳しくは、このトピックの後半で[動的なクォーラム管理](#dynamic-quorum-management)を参照してください。

**クラスター クォーラムを検証する**検証テストを使用して、すべてのクラスター ノードの票の割り当てを確認できます。

#### ノードの票割り当てに関する追加の考慮事項

  - 返信ノードの数が奇数を強制するノードの票割り当てはお勧めしません。 代わりに、ディスクの監視またはファイル共有監視を構成する必要があります。 詳細については、このトピックの後半で[監視の構成](#witness-configuration)を参照してください。
  - 動的クォーラム管理が有効になっている場合は、割り当てられているノードの票が構成されているノードのみ票割り当てられている、動的に削除されたかことができます。 詳細については、このトピックの後半で[動的なクォーラム管理](#dynamic-quorum-management)を参照してください。

### 動的なクォーラムの管理

Windows Server 2012 では高度なクォーラムの構成オプションとして選択できますクラスターでクォーラムの動的な管理を有効にします。 動的クォーラムのしくみについて詳しくは、[この説明](../storage/storage-spaces/understand-quorum.md#dynamic-quorum-behavior)を参照してください。

動的なクォーラムの管理をクラスターの残りの最後のクラスター ノード上で実行することはも。 クォーラム大部分の要件を動的に調整するには、によってクラスターはシーケンシャル ノードにシャット ダウンする 1 つのノードを維持できます。

[Get ClusterNode](https://docs.microsoft.com/powershell/module/failoverclusters/get-clusternode?view=win10-ps) Windows PowerShell コマンドレットを使用して、クラスター ノードの**DynamicWeight**一般的なプロパティを使用して、ノードのクラスターに割り当てられた動的投票を確認できます。 値 0 は、ノードがクォーラム投票を持っていないことを示します。 1 の値は、ノードがクォーラム投票を示します。

**クラスター クォーラムを検証する**検証テストを使用して、すべてのクラスター ノードの票の割り当てを確認できます。

#### 動的なクォーラム管理のための追加に関する考慮事項

- 動的なクォーラム管理では、返信メンバーの大多数の同時エラーを維持するためにクラスターは許可されません。 実行を継続するには、クラスターには、ノードのシャット ダウンまたは障害時にクォーラム大部分が常に必要です。

- ノードの票を明示的に削除した場合、クラスターに動的に追加または削除できないその投票します。
- 記憶域スペース ダイレクトを有効にする、クラスターは 2 つのノードの障害にのみサポートします。 これは説明より[プール クォーラム セクション](../storage/storage-spaces/understand-quorum.md#poolQuorum)

## クォーラム構成の一般的な推奨事項

クラスター ソフトウェアは、自動的に構成されているノードの数と共有記憶域の使用可能状況に基づいて、新しいクラスターのクォーラムを構成します。 通常はそのクラスターの最も適切なクォーラムの構成を選択します。 ただしは、クラスターが作成されたら、運用環境にクラスターを展開する前に、クォーラムの構成を確認することをお勧めします。 詳細なクラスター クォーラムの構成を表示することができます**クォーラム構成の検証**テストを実行する検証構成ウィザードでは、または、[テスト クラスター](https://docs.microsoft.com/powershell/module/failoverclusters/test-cluster?view=win10-ps)の Windows PowerShell コマンドレットを使用します。 フェールオーバー クラスター マネージャーでは、基本的なクォーラムの構成は、選択したクラスターの要約情報に表示されますか[Get ClusterQuorum](https://docs.microsoft.com/powershell/module/failoverclusters/get-clusterquorum?view=win10-ps) Windows PowerShell を実行するときに返すクォーラム リソースに関する情報を確認することができます。コマンドレットします。

いつでもでもにはクォーラムの構成がクラスターに最適なことを検証する**クォーラム構成の検証**テスト実行できます。 テストの出力は、クォーラムの構成に変更をお勧めし、設定が最適なかどうかを示します。 変更が推奨される場合は、推奨される設定を適用するクラスター クォーラムの構成ウィザードを使用できます。

クラスターは、実稼働環境では後、構成を変更しない、クォーラム変更がクラスターに適していることを確認した場合を除き、します。 次のような状況でクォーラムの構成を変更することを検討する必要があります。

- 追加またはノードを削除します。
- 追加または記憶域を削除します。
- 長期的なノードまたは監視エラー
- マルチサイト障害回復シナリオでは、クラスターの回復

フェールオーバー クラスター検証について詳しくは、[フェールオーバー クラスター用ハードウェアを検証](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134244(v%3dws.11)>)を参照してください。

## クラスター クォーラムを構成します。

フェールオーバー クラスター マネージャーまたはフェールオーバー クラスターの Windows PowerShell コマンドレットを使用して、クラスター クォーラムの設定を構成できます。

>[!IMPORTANT]
>クラスター クォーラムの構成ウィザードはお勧めするクォーラムの構成を使用することをお勧めします。 変更がクラスターに適したであると判断した場合にのみ、クォーラムの構成をカスタマイズすることをお勧めします。 詳細については、このトピックの[クォーラム構成の一般的な推奨事項](#general-recommendations-for-quorum-configuration)を参照してください。

### クラスター クォーラムの設定を構成します。

各クラスター化されたサーバー、またはそれと同等のローカルの**管理者**グループのメンバーシップは、この手順を完了するために必要な最小限のアクセス許可です。 また、使用するアカウントには、ドメイン ユーザー アカウントがあります。

>[!NOTE]
>クラスターまたは対象のクラスター リソース オフラインを停止することがなく、クラスター クォーラムの構成を変更できます。

### フェールオーバー クラスター マネージャーを使用して、フェールオーバー クラスターでクォーラム構成を変更します。

1. フェールオーバー クラスター マネージャーで、選択するかを変更するクラスターを指定します。
2. 選択すると、**操作**、下のクラスターには、**他の操作**を選択し、**クラスター クォーラム設定の構成**を選択します。 クラスター クォーラムの構成ウィザードが表示されます。 **[次へ]** を選びます。
3. **クォーラム構成オプションの選択**] ページで、3 つの構成オプションのいずれかを選択し、そのオプションの手順を完了します。 クォーラムの設定を構成する前に、選択内容を確認できます。 オプションについて詳しくは、先述の[フェールオーバー クラスターでクォーラムの概要について](#overview-of-the-quorum-in-a-failover-cluster)はを参照してください。

    - クラスター クォーラム設定の現在のクラスター構成に対して最適なを自動的にリセットできるようにには、**一般的な設定を使用**を選択し、ウィザードを完了します。
    - 追加したり、クォーラム監視を変更したり、**追加または変更クォーラム監視**を選択し、次の手順を完了します。 クォーラム監視の構成に関する考慮事項とについては、先述の[監視の構成](#witness-configuration)を参照してください。

      1. **クォーラム監視の選択**] ページで、ディスクの監視やファイル共有監視を構成するためのオプションを選択します。 ウィザードでは、クラスターの推奨される監視選択オプションを示します。

          >[!NOTE]
          >**クォーラム監視を構成しなかった場合**も選択し、ウィザードを完了できます。 クラスター内のノードの返信の偶数があれば、として、推奨される構成これいない必要があります。

      2. **記憶域の監視の構成**] ページで、ディスクの監視を構成するオプションを選択した場合、ディスク監視として割り当てる記憶域ボリュームを選択し、ウィザードを完了します。
      3. **ファイル共有監視の構成**] ページで、ファイル共有監視を構成するオプションを選択した場合は、入力またはファイル共有監視のリソースとして使用して、ウィザードを完了を参照します。

    - クォーラム管理の設定を構成するを追加し、クォーラム監視を変更したり**高度なクォーラムの構成と監視の選択**を選択し、次の手順を完了します。 高度なクォーラム構成の設定に関する考慮事項については、このトピックの前[の割り当てを投票ノード](#node-vote-assignment)と[動的クォーラム管理](#dynamic-quorum-management)を参照してください。

      1. **[投票構成の選択**] ページで、投票をノードに割り当てるオプションを選択します。 既定では、すべてのノードに投票が割り当てられます。 ただし、特定のシナリオを割り当てることができます投票ノードのサブセットだけにします。

          >[!NOTE]
          >**いいえノード**を選択することもできます。 これは一般にしないため、推奨クォーラムへの投票に参加するノードを許可しないし、ディスクの監視を構成する必要があります。 このディスク監視では、クラスターのエラーの 1 つのポイントになります。

      2. **クォーラム管理の構成**] ページで、有効にしたか、**動的にノードの割り当てを管理できるようにするクラスター投票**オプションを無効にします。 一般に、このオプションを選択すると、クラスターの可用性が向上します。 既定では、オプションを有効にして、このオプションを無効にすることを強くお勧めします。 このオプションは、クラスターは、このオプションを無効にした場合、可能な障害シナリオの実行を継続できます。
      3. **クォーラム監視の選択**] ページで、ディスクの監視やファイル共有監視を構成するためのオプションを選択します。 ウィザードでは、クラスターの推奨される監視選択オプションを示します。

          >[!NOTE]
          >**クォーラム監視を構成しなかった場合**も選択し、ウィザードを完了できます。 クラスター内のノードの返信の偶数があれば、として、推奨される構成これいない必要があります。

      4. **記憶域の監視の構成**] ページで、ディスクの監視を構成するオプションを選択した場合、ディスク監視として割り当てる記憶域ボリュームを選択し、ウィザードを完了します。
      5. **ファイル共有監視の構成**] ページで、ファイル共有監視を構成するオプションを選択した場合は、入力またはファイル共有監視のリソースとして使用して、ウィザードを完了を参照します。

4. **[次へ]** を選びます。 確認ページに、表示される内容を確認し、 **[次へ]** を選択します。

ウィザードを実行し、 **[概要**] ページが表示されたら、ウィザードを実行するタスクのレポートを表示する場合後、は、**レポートの表示**を選択します。 最新のレポートのままですが、 *systemroot。 \\Cluster\\Reports** **QuorumConfiguration.mht**名前のフォルダーです。

>[!NOTE]
>クラスター クォーラムを構成した後は、更新されたクォーラム設定を確認する**クォーラム構成の検証**テストを実行することをお勧めします。

### 同等の Windows PowerShell コマンド

次の例では、 [Set-clusterquorum](https://docs.microsoft.com/powershell/module/failoverclusters/set-clusterquorum?view=win10-ps)コマンドレットとその他の Windows PowerShell コマンドレットを使用してクラスター クォーラムを構成する方法を示します。

次の例では、 *CONTOSO FC1*クラスターでクォーラムの構成を変更しないクォーラム監視の構成は単純なノード大部分にします。

```PowerShell
Set-ClusterQuorum –Cluster CONTOSO-FC1 -NodeMajority
```

次の例では、監視の構成とノードの大部分をローカルのクラスターでクォーラムの構成を変更します。 *クラスター ディスク 2*という名前のディスク リソースは、ディスク監視として構成されます。

```PowerShell
Set-ClusterQuorum -NodeAndDiskMajority "Cluster Disk 2"
```

次の例では、監視の構成とノードの大部分をローカルのクラスターでクォーラムの構成を変更します。 *\\\CONTOSO-FS\\fsw*という名前のファイル共有リソースは、ファイル共有監視として構成されます。

```PowerShell
Set-ClusterQuorum -NodeAndFileShareMajority "\\fileserver\fsw"
```

次の例では、ローカルのクラスターのノード*ContosoFCNode1*からクォーラム投票を削除します。

```PowerShell
(Get-ClusterNode ContosoFCNode1).NodeWeight=0
```

次の例では、ローカルのクラスターのノード*ContosoFCNode1*にクォーラム投票を追加します。

```PowerShell
(Get-ClusterNode ContosoFCNode1).NodeWeight=1
```

次の例では、(以前無効にされている) 場合、クラスター *CONTOSO FC1*の**DynamicQuorum**プロパティが有効にします。

```PowerShell
(Get-Cluster CONTOSO-FC1).DynamicQuorum=1
```

## クォーラムせずに起動して、クラスターを回復します。

十分なクォーラム票を持たないクラスターは起動しません。 最初の手順として常にクラスター クォーラムの構成を確認し、クラスターが不要になったクォーラムを持つ理由を調査する必要があります。 これは、プライマリ サイトがマルチサイト クラスターに到達できない場合や、応答を停止したノードがある場合に発生する可能性があります。 クラスターの障害の原因を特定した後は、このセクションで説明されている回復の手順を使用できます。

>[!NOTE]
> * クォーラムが失われたために、クラスター サービスが停止した場合は、システム ログにイベント ID 1177 が表示されます。
> * クラスター クォーラムが失われた理由を調査するために必要です。
> * クラスター クォーラムせずを開始するのではなく、正常な状態 (結合クラスター) にノードまたはクォーラム監視を移植することはお勧め常にします。

### フォースは、クラスター ノードを開始します。

ノードまたはクォーラム監視、正常な状態にすることにより、クラスターを回復できないことを決定したら、強制的に開始するクラスターが必要になります。 強制的に開始するクラスター、クラスター クォーラムの構成設定を上書きし、 **ForceQuorum**モードでクラスターを起動します。

クラスター クォーラムがあるない場合、開始を強制することは、マルチサイト クラスターで特に役立ちます可能性があります。 サイトを含む個別にあるプライマリおよびバックアップ、*サイトの境界*と*サイト b*のクラスターが障害回復シナリオを検討してください。 *サイトの境界*に正規の障害がある場合は、かなりのサイトがオンラインに戻るの時間がかかる可能性があります。 クォーラムがあるない場合でも、オンラインします*サイト b*を強制するは可能性があります。

クラスターが**ForceQuorum**モードで起動したときと、それが戻った後後は、十分なクォーラム投票し、クラスターに自動的に強制の状態のままは正常に動作します。 したがって、クラスターをもう一度正常に起動する必要はありません。 ノードを失ったクラスター クォーラムが失われた場合は、それがオフラインになったもう一度しなくなった強制的な状態であるため。 オンラインに戻るクォーラムがない場合、強制的にクラスター クォーラムなしで開始する必要があります。

>[!IMPORTANT]
>* クラスターは、開始フォース、した後、管理者はクラスターを完全に制御します。
>* クラスターは、クラスターが開始されると、フォースは、ノードのクラスターの構成を使用して、利用できるその他のすべてのノードに複製します。
>* クラスター クォーラムなしで開始を強制的に実行し、 **ForceQuorum**モードでクラスターのままに、すべてのクォーラムの構成設定が無視されます。 これには、特定のノードの票を割り当てと動的クォーラム管理の設定が含まれます。

### 残りのクラスター ノード上のクォーラムを防ぐ

強制でクラスターを開始した後、ノード上をクォーラムを防ぐために設定すると、クラスター内の残りのノードを開始する必要があります。 クォーラムをようにする設定を使い始めるノードは、クラスター サービスが新しいクラスター インスタンスを形成するのではなく実行中の既存クラスターに参加することを示します。 これは、残りのノードが競合する 2 つのインスタンスが含まれている分割クラスターを形成することを防ぎます。

これが必要になります*サイト b*、バックアップ、サイトのクラスターが開始フォースした後は、いくつかのマルチサイトの障害回復シナリオで、クラスターを回復する必要がある場合。 *サイト b*、*サイトの境界*プライマリ サイト内のノードでクラスターを開始、強制的に参加するために、禁止クォーラムで開始する必要があります。

>[!IMPORTANT]
>クラスター ノード上で開始フォースとは後、は、常に禁止クォーラムで残りのノードを開始することをお勧めします。

フェールオーバー クラスター マネージャーでクラスターを回復する方法を次に示します。

1. フェールオーバー クラスター マネージャーで、選択するかを回復するクラスターを指定します。
2. [**アクション**] を選択したクラスター**フォース クラスターの開始**を選択します。

    フェールオーバー クラスター マネージャー フォース到達可能なすべてのノード上でクラスターを開始します。 クラスターは、起動時に、現在のクラスター構成を使用します。

>[!NOTE]
>* クラスターを使用するクラスター構成が含まれている特定のノードの開始を強制的には、この手順の後に表示されると、Windows PowerShell コマンドレットまたはと同等のコマンド ライン ツールを使用する必要があります。 
> * 最初に、フォースであるクラスターへの接続にフェールオーバー クラスター マネージャーを使用する**クラスター サービスの開始**アクションを使用して、ノードを起動する場合は、ノードがクォーラムしないように設定と自動的に開始します。

#### Windows PowerShell のと同じコマンド (開始 Clusternode)

次の例は、ノード*ContosoFCNode1*でクラスターの**開始 ClusterNode**コマンドレットを使用してスタート画面に強制する方法を示します。

```PowerShell
Start-ClusterNode –Node ContosoFCNode1 –FQ
```

または、ノードのローカルで次のコマンドを入力できます。

```PowerShell
Net Start ClusSvc /FQ
```

次の例では、ノード*ContosoFCNode1*で禁止クォーラムでクラスター サービスを開始する**開始 ClusterNode**コマンドレットを使用する方法を示します。

```PowerShell
Start-ClusterNode –Node ContosoFCNode1 –PQ
```

または、ノードのローカルで次のコマンドを入力できます。

```PowerShell
Net Start ClusSvc /PQ
```

## 障害回復の構成のクォーラムに関する考慮事項

このセクションでは、特性と障害回復の展開では 2 つのマルチサイトのクラスター構成のクォーラムの構成をまとめたものです。 クォーラム構成のガイドラインは、ワークロードの場合、サイト間で自動フェールオーバーまたは手動のフェールオーバーを必要がある場合、に応じて異なります。 構成は、通常、サービス レベル アグリーメント (Sla) を提供し、障害やサイトで障害が発生した場合、クラスター化されたワークロードをサポートして、組織内の場所にあるに依存します。

### 自動フェールオーバー

この構成ではクラスター化された役割をホストできる 2 つまたは複数のサイトのクラスターで構成されます。 すべてのサイトで障害が発生した場合、自動的に残りのサイトにフェールオーバー クラスター化された役割が必要です。 したがって、すべてのサイトが完全なサイトの障害を維持できるように、クラスター クォーラムを構成する必要があります。

次の表は、この構成の推奨事項と考慮事項をまとめたものです。

<table>
<thead>
<tr class="header">
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>各サイト ノードの票の数</td>
<td>同じにする必要があります。</td>
</tr>
<tr class="even">
<td>ノードの票の割り当て</td>
<td>すべてのノードが均等に重要なために、ノードの票を削除する必要があります。</td>
</tr>
<tr class="odd">
<td>動的なクォーラムの管理</td>
<td>有効にする必要があります。</td>
</tr>
<tr class="even">
<td>監視の構成</td>
<td>ファイル共有監視を推奨すると、クラスターのサイトから別のサイトで構成されています。</td>
</tr>
<tr class="odd">
<td>ワークロード</td>
<td>ワークロードは、サイトのいずれかのように構成できます。</td>
</tr>
</tbody>
</table>

#### 自動フェールオーバーの考慮事項

- 別のサイトでファイル共有監視の構成は、各サイトに等しい機会を提供する必要があります。 詳細については、先述の「[監視の構成](#witness-configuration)を参照してください。

### 手動によるフェールオーバー

この構成ではプライマリ サイト、*サイトの境界*、および*サイト b*バックアップ (回復) サイトのクラスターで構成されます。 クラスター化された役割は、*サイトの境界*でホストされます。 クラスター クォーラムの構成が原因の*サイトの境界*、すべてのノードに障害が発生した場合、クラスターが停止します。 このシナリオで、管理者が手動で*適度*クラスター サービスがフェールオーバーし、クラスターを回復する追加の手順を実行する必要があります。

次の表は、この構成の推奨事項と考慮事項をまとめたものです。

<table>
<thead>
<tr class="header">
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>各サイト ノードの票の数</td>
<td>異なることができます。</td>
</tr>
<tr class="even">
<td>ノードの票の割り当て</td>
<td>- プライマリ サイト ノードからは削除しない必要があるノードの投票<em>サイトのプロパティ</em><br />
- バックアップのサイトでのノードから削除する必要があるノードの投票<em>サイト b</em><br />
- 長期的な停止が発生した場合<em>サイトの境界</em>、投票を時にノードに割り当てる必要があります<em>サイト b</em>回復の一部としてそのサイトのクォーラムの大部分を有効にするには</td>
</tr>
<tr class="odd">
<td>動的なクォーラムの管理</td>
<td>有効にする必要があります。</td>
</tr>
<tr class="even">
<td>監視の構成</td>
<td>- 偶数数のノードがある場合は、監視を構成する<em>サイトのプロパティ</em><br />
- 監視が必要な場合は、ファイル共有監視または内のノードにのみアクセス可能なディスクの監視を構成する<em>サイトの境界</em>(、非対称ディスクの監視とも呼ばれます)</td>
</tr>
<tr class="odd">
<td>ワークロード</td>
<td>優先所有者を使用して、ワークロードのノードで実行されている<em>サイトのプロパティ</em></td>
</tr>
</tbody>
</table>

#### 手動によるフェールオーバーに関するその他の考慮事項

- *サイトの境界*にあるノードのみには、クォーラム投票が最初に設定されます。 これは、*サイト b*のノードの状態は、クラスター クォーラムには影響を与えませんことを確認する必要があります。
- *サイトの境界*一時的な障害や長期的なエラーを維持する場合、に応じて回復手順が異なることができます。

## 詳細

* [フェールオーバー クラスタリング](failover-clustering.md)
* [フェールオーバー クラスターの Windows PowerShell コマンドレット](https://docs.microsoft.com/powershell/module/failoverclusters/?view=win10-ps)
* [クラスターとプール クォーラム](../storage/storage-spaces/understand-quorum.md)