---
title: 2 つのノードのクラスター化されたファイル サーバーを展開します。
ms.prod: windows-server-threshold
ms.manager: eldenc
ms.technology: failover-clustering
ms.topic: article
author: johnmarlin-msft
ms.date: 02/01/2019
description: この記事では、2 ノード ファイル サーバー クラスターの作成について説明します
ms.openlocfilehash: fbfde60f60df64514a6a0f514cbabd005544af84
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/17/2019
ms.locfileid: "59846413"
---
# <a name="deploying-a-two-node-clustered-file-server"></a>2 つのノードのクラスター化されたファイル サーバーを展開します。

> 適用先:Windows Server 2019、Windows Server 2016

フェールオーバー クラスターとは、アプリケーションやサービスの可用性を向上するために、互いに連携する独立したコンピューターで構成されるグループを指します。 クラスター サーバー (ノード) は、物理ケーブルとソフトウェアにより接続されます。 クラスター ノードの 1 つに障害が発生すると、他のノードがサービスの提供を開始します (フェールオーバーと呼ばれる処理)。 ユーザーには、サービスの中断の最小値が発生します。

このガイドでは、インストールと 2 つのノードを持つ汎用ファイル サーバー フェールオーバー クラスターを構成する手順について説明します。 このガイドの構成を作成すると、フェールオーバー クラスターについて説明し、Windows Server 2019 または Windows Server 2016 フェールオーバー クラスター管理スナップインでインターフェイスについて理解できます。

## <a name="overview-for-a-two-node-file-server-cluster"></a>2 ノード ファイル サーバー クラスターの概要

フェールオーバー クラスター内のサーバーでは、ファイル サーバー、HYPER-V サーバー、またはデータベース サーバーのロールを含む、ロールのさまざまな機能し、その他のサービスとアプリケーションのさまざまな高可用性を実現することができます。 このガイドでは、2 ノード ファイル サーバー クラスターを構成する方法について説明します。

フェールオーバー クラスターには、記憶域の指定したボリュームが、一度に 1 つのサーバーでアクセスのみが、クラスター内のすべてのサーバーに物理的に接続されている記憶域ユニットが含まれています。 次の図は、記憶域ユニットに接続されている 2 ノード フェールオーバー クラスターを示します。

![2 ノード クラスター](media\Cluster-File-Server\Cluster-FS-Overview.png)

記憶域ボリュームまたはクラスター内のノードに公開されている論理ユニット番号 (Lun) を別のクラスターにサーバーを含む、他のサーバーに公開されませんする必要があります。 次の図は、これを示しています。

![記憶域の Lun](media\Cluster-File-Server\Cluster-FS-LUNs.png)

任意のサーバーの最大の可用性にサーバーの管理のベスト プラクティスに従う必要に注意してください — たとえば、完全に実装するには、前にソフトウェアの変更をテスト サーバーの物理環境を慎重に管理、慎重に。ソフトウェア更新プログラムとすべてのクラスター化されたサーバーの構成の変更の追跡。

次のシナリオでは、ファイル サーバーのフェールオーバー クラスターを構成する方法について説明します。 共有されているファイルが、クラスターの記憶域にあり、いずれかのクラスター化されたサーバーは、それらを共有するファイル サーバーとして機能できます。

## <a name="shared-folders-in-a-failover-cluster"></a>フェールオーバー クラスターでの共有フォルダー

次の一覧には、フェールオーバー クラスタ リングに統合されている共有フォルダーの構成機能について説明します。

- 表示のスコープは、クラスター化された共有フォルダーにのみ (混在できない共有フォルダーの非クラスター化)。ときに、ユーザー ビュー共有フォルダーをクラスター化されたファイル サーバーのパスを指定することで、表示には、特定のファイル サーバーの役割の一部である共有フォルダーが含まれます。 これにより、共有フォルダーの非クラスター化し、クラスターのノードに含まれる別のファイル サーバーの役割の一部を共有は除外します。

- アクセス ベースの列挙体。アクセス ベースの列挙を使用して、ユーザーのビューから指定したフォルダーを非表示にすることができます。 ユーザーは、フォルダーを参照してください。 これで何もアクセスできませんを許可せずにフォルダーをすべての参照を防ぐために選択できます。 クラスター化された共有フォルダーのアクセス ベースの列挙は、非クラスター化共有フォルダーと同じ方法で構成できます。

- オフライン アクセス:(キャッシュ) クラスター化された共有フォルダーの非クラスター化共有フォルダーと同じ方法でのオフライン アクセスを構成することができます。

- クラスター化されたディスクは、クラスターの一部として常に認識されます。フェールオーバー クラスターのインターフェイス、Windows エクスプ ローラーで、または共有と記憶域の管理スナップインを使用するかどうか、Windows はクラスター記憶域ものとして、ディスクが指定されているかどうかを認識します。 クラスター化されたファイル サーバーの一部としてフェールオーバー クラスターの管理に使用されているこのようなディスクが構成されて場合、前に説明したインターフェイスのいずれか、共有ディスクを作成する使用することができます。 このようなディスクがクラスター化されたファイル サーバーの一部として構成されていない場合に誤って共有を作成することはできません。 代わりに、エラーは、ディスクする必要がありますまずクラスター化されたファイル サーバーの一部として前に構成する共有することができますを示します。

- Services for Network File System の統合:Windows Server のファイル サーバーの役割には、ネットワーク ファイル システム (NFS) 用サービスと呼ばれるオプションの役割サービスが含まれています。 役割サービスをインストールして、NFS 用サービスの共有フォルダーを構成すると、UNIX ベースのクライアントをサポートするクラスター化されたファイル サーバーを作成することができます。

## <a name="requirements-for-a-two-node-failover-cluster"></a>2 ノード フェールオーバー クラスターの要件

Microsoft によって正式にサポートされている、ソリューションと見なすには、Windows Server 2016 または Windows Server 2019 でフェールオーバー クラスターでは、ソリューションは、次の条件を満たす必要があります。

- すべてのハードウェアおよびソフトウェア コンポーネントが、適切なロゴの要件を満たしている。 Windows Server 2016 では、これは、"Certified for Windows Server 2016"ロゴです。 Windows Server 2019、これは、"Certified for Windows Server 2019"ロゴです。 認定されたハードウェアとソフトウェア システムの詳細については、Microsoft をご覧ください[Windows Server Catalog](https://www.windowsservercatalog.com/default.aspx)サイト。

- (サーバー、ネットワーク、および記憶域) は、完全に構成されたソリューションは、検証ウィザード、フェールオーバー クラスター スナップインの一部であるすべてのテストを渡す必要があります。

次は 2 ノード フェールオーバー クラスターに必要になります。

- **サーバー:** 同一または類似したコンポーネントで一致するコンピューターを使用することをお勧めします。  2 ノード フェールオーバー クラスターのサーバーには、同じバージョンの Windows Server を実行する必要があります。 同じソフトウェア更新プログラム (修正プログラム) も必要です。

- **ネットワーク アダプターおよびケーブル。** フェールオーバー クラスター ソリューションで、その他のコンポーネントと同様に、ネットワーク ハードウェアは、Windows Server 2016 または Windows Server 2019 と互換性のあるである必要があります。 ISCSI を使用する場合、ネットワーク アダプターがネットワーク通信と iSCSI の両方ではないのいずれかに専用する必要があります。 クラスター ノードを接続するネットワーク インフラストラクチャでは、単一障害点を回避する必要があります。 これを実現する複数の方法はあります。 クラスター ノードを接続するには、複数の個別のネットワーク。 また、チーム化されたネットワーク アダプター、冗長なスイッチ、冗長なルーターなど、単一障害点を取り除くためのハードウェアが導入された単一のネットワークにクラスター ノードを接続する方法もあります。

   > [!NOTE]
   > 場合は、クラスター ノードが 1 つのネットワーク接続されている、ネットワークは検証の構成ウィザードの冗長性要件に適合します。  ただし、レポートには、ネットワークに単一障害点を持たせないように警告が含まれます。

- **デバイス コント ローラーまたは記憶域の適切なアダプター:**
    - **Serial Attached SCSI またはファイバー チャネル。** Serial Attached SCSI またはファイバー チャネル、すべてのクラスター化されたサーバーを使用している場合、記憶域スタックのすべてのコンポーネントが同じ場合があります。 必要ですが、マルチパス I/O (MPIO) ソフトウェアと同一で、デバイス固有モジュール (DSM) ソフトウェア コンポーネント。  また、クラスター記憶域に接続する大容量記憶装置コントローラー (つまり、ホスト バス アダプター (HBA)、HBA ドライバー、および HBA ファームウェア) も同じものを使用することをお勧めします。 異なる HBA を使用する場合は、サポートされる構成または推奨される構成に従っていることを記憶域の製造元に確認する必要があります。
    - **iSCSI:** ISCSI を使用している場合、クラスター化された各サーバーは、1 つ以上のネットワーク アダプターまたは ISCSI 記憶域専用のホスト バス アダプターが必要です。 ISCSI に使用するネットワークは、ネットワーク通信に使用できません。 クラスター化されたすべてのサーバーで、iSCSI 記憶域ターゲットへの接続に同一のネットワーク アダプターを使用する必要があります。ギガビット イーサネット以上の通信規格を使用することをお勧めします。  

- **記憶域:** Windows Server 2016 または Windows Server 2019 に認定されている共有記憶域を使用する必要があります。
  
    2 ノード フェールオーバー クラスターの記憶域はクォーラム監視ディスクを使用する場合、少なくとも 2 つの別々 のボリューム (Lun) を含める必要があります。 監視ディスクは、クラスター構成データベースのコピーを保持するために指定されているクラスターの記憶域ディスクです。 この 2 ノード クラスターの例では、クォーラム構成のノードおよびディスク マジョリティされます。 ノードおよびディスク マジョリティ ノードと監視ディスクがクラスターの構成のコピーを格納し、これらのコピーの過半数 (2 つのうち 3 つ) が使用可能な限り、クラスターがクォーラムことを意味します。 その他のボリューム (LUN) は、ユーザーに共有されているファイルが格納されます。

    記憶域の要件を次に示します。

    - フェールオーバー クラスタリングに含まれるネイティブのディスク サポートを利用するには、ダイナミック ディスクではなくベーシック ディスクを使用してください。
    - NTFS でパーティションをフォーマットすることをお勧めします。 (監視ディスク、パーティションあります NTFS)。
    - ディスクのパーティション スタイルとして、マスター ブート レコード (MBR) と GUID パーティション テーブル (GPT) のいずれかを使用できます。
    - 記憶域は、特定の SCSI コマンドに正しく応答する必要があります、記憶域は、SCSI Primary commands-3 (spc-3) と呼ばれる標準に従う必要があります。 具体的には、ストレージは、spc-3 標準で指定されている永続的な予約をサポートする必要があります。 
    -  記憶域に使用するミニポート ドライバーでは、Microsoft Storport 記憶域ドライバーを使用する必要があります。

## <a name="deploying-storage-area-networks-with-failover-clusters"></a>フェールオーバー クラスターを備えた記憶域ネットワークの展開

フェールオーバー クラスターで記憶域エリア ネットワーク (SAN) をデプロイするときに、次のガイドラインに従ってください。

- **記憶域の証明書を確認します。** 使用して、 [Windows Server Catalog](https://www.windowsservercatalog.com/default.aspx)サイトで、ドライバー、ファームウェア、およびソフトウェアを含む、仕入先のストレージが Windows Server 2016 または Windows Server 2019 の認定を確認します。

- **記憶域装置を装置あたり 1 クラスター。** 異なるクラスターのサーバーが同一の記憶装置にアクセスしないようにしてください。 ほとんどの場合、クラスター サーバーの 1 つのセットに使用される LUN は lun マスキングまたはゾーニングの他のすべてのサーバーから分離する必要があります。

- **マルチパス I/O ソフトウェアの使用を検討します。** 高可用性記憶域ファブリックでは、マルチパス I/O ソフトウェアを使用して、複数のホスト バス アダプターを備えたフェールオーバー クラスターを展開できます。 これによって、冗長性と可用性を最大限に引き出すことができます。 マルチパス ソリューションは、Microsoft マルチパス I/O (MPIO) に基づく必要があります。 Windows Server 2016 および Windows Server 2019 オペレーティング システムの一部として 1 つまたは複数の Dsm は含まれませんが、記憶域ハードウェアのベンダーは、ハードウェアには、MPIO デバイス固有モジュール (DSM) を指定可能性があります。

## <a name="network-infrastructure-and-domain-account-requirements"></a>ネットワーク インフラストラクチャとドメイン アカウントの要件

2 ノード フェールオーバー クラスターおよびドメインのアクセス許可を持つ管理者アカウントは、次のネットワーク インフラストラクチャを必要となります。

- **ネットワーク設定と IP アドレス:** ネットワークの同一のネットワーク アダプターを使用する場合もこれらのアダプター (速度、二重モード、フロー制御、およびメディアの種類など) で通信設定を使用します。 また、ネットワーク アダプターとその接続先のスイッチ間で設定を比較して、設定に競合がないことを確認します。

    ネットワーク インフラストラクチャの残りの部分にルーティングされないプライベート ネットワークを使用する場合、それらのプライベート ネットワークが固有のサブネットを使用することを確認します。 これは、各ネットワーク アダプターに固有の IP アドレスを割り当てる場合であっても必要です。 たとえば、1 つの物理ネットワークを使用する本社にクラスター ノードがあり、別個の物理ネットワークを使用する支社に別のノードがある場合、各アダプターに固有の IP アドレスを割り当てる場合であっても、両方のネットワークに対して 10.0.0.0/24 を指定しないでください。

    ネットワーク アダプターの詳細については、このガイドの前半での 2 ノード フェールオーバー クラスターのハードウェア要件を参照してください。

- **DNS:** 名前解決は、クラスター内のサーバーをドメイン ネーム システム (DNS) を使用する必要があります。 DNS 動的更新プロトコルを使用できます。

- **ドメインの役割:** クラスター内のすべてのサーバーが同じ Active Directory ドメインにあります。 ベスト プラクティスとして、クラスター化されたサーバーはすべて同じドメインの役割 (メンバー サーバーまたはドメイン コントローラー) を持つ必要があります。 推奨される役割は、メンバー サーバーです。

- **ドメイン コント ローラー:** クラスター化されたサーバーがメンバー サーバーにすることをお勧めします。 その場合は、追加のサーバー、フェールオーバー クラスターを含むドメインでドメイン コント ローラーとして機能する必要があります。

- **クライアント:** テストするため、必要に応じては、1 つまたは複数のネットワークに接続されたクライアントを作成すると、フェールオーバー クラスターに接続し、移動したり、他の 1 つのクラスター ノードからクラスター化されたファイル サーバーをフェールオーバーする場合は、クライアントへの影響を確認します。

- **クラスター管理用のアカウント:** 初めてクラスターを作成したり、サーバーを追加して、ときに、そのクラスター内のすべてのサーバー上で管理者権限とアクセス許可のあるアカウントでドメインにログオンする必要があります。 このアカウントは Domain Admins アカウントである必要はなく、クラスター化された各サーバーの Administrators グループに属するドメイン ユーザー アカウントでもかまいません。 さらに、アカウントが Domain Admins アカウントでない場合、アカウント (またはグループ アカウントのメンバーである) 必要がある、**コンピューター オブジェクト作成**と**Read All Properties**でのアクセス許可、ドメイン組織単位 (OU) は、内に配置されます。

## <a name="steps-for-installing-a-two-node-file-server-cluster"></a>2 ノード ファイル サーバー クラスターをインストールする手順

2 ノード ファイル サーバー フェールオーバー クラスターをインストールするには、次の手順を完了する必要があります。

手順 1:クラスター サーバーをネットワークと記憶域に接続します。

手順 2:フェールオーバー クラスター機能をインストールします。

手順 3:クラスター構成を検証する

手順 4:クラスターを作成する。

クラスター ノードが既にインストールされているファイル サーバーのフェールオーバー クラスターを構成する場合、このガイドの後半で、2 ノード ファイル サーバー クラスターを構成するための手順を参照してください。

### <a name="step-1-connect-the-cluster-servers-to-the-networks-and-storage"></a>手順 1:クラスター サーバーをネットワークと記憶域に接続します。

フェールオーバー クラスターのネットワーク、避けて単一障害点」を参照してください。 これを実現する複数の方法はあります。 クラスター ノードを接続するには、複数の個別のネットワーク。 チーミングされたネットワーク アダプター、冗長なスイッチ、冗長なルーター、または単一障害点を除去するハードウェアで作成されますが、1 つのネットワークとクラスター ノードを接続することができます (iscsi ネットワークを使用すると、作成する必要がこのネットワークの他のネットワークだけでなく)。

2 ノード ファイル サーバー クラスターでは、クラスター記憶域にサーバーを接続するときに、少なくとも 2 つのボリューム (Lun) を公開する必要があります。 構成の徹底的なテストの必要に応じて、追加のボリュームを公開できます。 クラスターではないサーバーをクラスター化されたボリュームを公開しません。

#### <a name="to-connect-the-cluster-servers-to-the-networks-and-storage"></a>クラスター サーバーをネットワークと記憶域に接続するには

1. 2 ノード フェールオーバー クラスターのハードウェア要件およびこのガイドの前半で、2 ノード フェールオーバー クラスターのネットワーク インフラストラクチャおよびドメイン アカウントの要件で、ネットワークに関する詳細を確認します。

2. クラスター内のサーバーが使用するネットワークを接続および構成します。

3. テスト構成には、クライアントまたはクラスター化されていないドメイン コント ローラーが含まれている場合は、これらのコンピューターが少なくとも 1 つのネットワーク経由のクラスター化されたサーバーに接続できることを確認します。

4. 製造元の指示に従って、サーバーを記憶域に物理的に接続します。

5. クラスターで使用するディスク (LUN) がクラスター化するサーバーに (およびそれらのサーバーにのみ) 公開されていることを確認します。 ディスクまたは Lun を公開するのにには、次のインターフェイスのいずれかを使用できます。

    - 記憶域の製造元によって提供されたインターフェイス

    - ISCSI、適切な iSCSI インターフェイスを使用しています。 場合、

6. 形式またはディスクの機能を制御するソフトウェアを購入している場合は、手順 Windows Server でそのソフトウェアを使用する方法、ベンダーに従います。

7. クラスターは、スタート をクリックするサーバーのいずれかで、管理ツール をクリックして、コンピューターの管理 をクリックしておよびディスクの管理 をクリックします。 (操作が表示が目的の動作であることを確認、ユーザー アカウント制御] ダイアログ ボックスが表示される場合と、[続行します。)ディスク管理で、クラスター ディスクを表示することを確認します。

8. 2 テラバイトを超える記憶域ボリュームを使用し、Windows インターフェイスを使用してディスクの形式を制御する場合は、そのディスクを GUID パーティション テーブル (GPT) と呼ばれるパーティション スタイルに変換します。 ディスク上のデータをバックアップし、ディスク上のすべてのボリュームを削除し、[ディスクの管理ディスク (パーティションではありません) を右クリックし、GPT ディスクに変換] をクリックします。  ボリュームが 2 テラバイト未満の場合は、GPT を使用する代わりに、マスター ブート レコード (MBR) と呼ばれるパーティション スタイルを使用できます。

9. 公開するボリュームまたは LUN の形式を確認します。 形式については、NTFS お勧めします (監視ディスクでは、する必要があります NTFS を使用する)。

### <a name="step-2-install-the-file-server-role-and-failover-cluster-feature"></a>手順 2:ファイル サーバーの役割とフェールオーバー クラスター機能をインストールします。

この手順で、ファイル サーバーの役割とフェールオーバー クラスター機能がインストールされます。 Windows Server 2016 または Windows Server 2019 のいずれか、両方のサーバーを実行する必要があります。

#### <a name="using-server-manager"></a>サーバー マネージャーを使用

1. 開いている**サーバー マネージャー**下で、**管理**ドロップダウンを選択します**追加の役割と機能の**します。

   ![機能を追加します。](media\Cluster-File-Server\Cluster-FS-Add-Feature.png)

2. 場合、**開始する前に**ウィンドウが開き、選択**次**します。

3. **インストールの種類**を選択します**役割ベースまたは機能ベースのインストール**と**次**します。

4. 確認**サーバー プールからサーバーを選択**は選択すると、マシンの名前を強調表示、および**次**。

5. サーバーの役割、役割の一覧から開く**ファイル サービス**を選択します**ファイル サーバー**と**次**します。

   ![ロールを追加します。](media\Cluster-File-Server\Cluster-FS-Add-FS-Role-1.png)

6. 機能は、機能の一覧から、次のように選択します。**フェールオーバー クラスタ リング**します。  インストールされても、管理ツールの一覧を示すポップアップ ダイアログが表示されます。  すべて選択されている、選択**機能の追加**と**次**。

   ![機能を追加します。](media\Cluster-File-Server\Cluster-FS-Add-WSFC-1.png)

7. [確認] ページで、インストールを選択します。

8. インストールが完了すると、コンピューターを再起動します。

9. 2 つ目のコンピューター上の手順を繰り返します。

#### <a name="using-powershell"></a>PowerShell を使用する

1. [スタート] ボタンを右クリックして選択し、管理用の PowerShell セッションを開く**Windows PowerShell (管理者)** します。
2. ファイル サーバーの役割をインストールするには、コマンドを実行します。

    ```PowerShell
    Install-WindowsFeature -Name FS-FileServer
    ```

3. フェールオーバー クラスタ リング機能とを管理ツールをインストールするには、コマンドを実行します。

    ```PowerShell
    Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools
    ```

4. これらが完了すると、コマンドを使用してインストールを確認できます。

    ```PowerShell
    Get-WindowsFeature -Name FS-FileServer
    Get-WindowsFeature -Name Failover-Clustering
    ```

5. インストールされていることを確認するには、コマンドを使用してコンピューターを再起動します。

    ```PowerShell
    Restart-Computer
    ```

6. 2 つ目のサーバーで手順を繰り返します。

### <a name="step-3-validate-the-cluster-configuration"></a>手順 3:クラスター構成を検証する

クラスターを作成する前に強くお勧め、構成を検証します。 検証では、サーバー、ネットワーク、ストレージの構成を一連のフェールオーバー クラスターの特定の要件を満たしていることを確認できます。

#### <a name="using-failover-cluster-manager"></a>フェールオーバー クラスター マネージャーを使用

1. **サーバー マネージャー**、選択、**ツール**ドロップダウンを選択して**フェールオーバー クラスター マネージャー**します。

2. **フェールオーバー クラスター マネージャー**、中央の列の下に移動して、**管理**選択**構成の検証**です。

3. 場合、**開始する前に**ウィンドウが開き、選択**次**します。

4. **またはクラスターのサーバーの選択**ウィンドウで、クラスターのノードとなる 2 つのマシンの名前に追加します。  たとえば、名前は NODE1 および NODE2 場合、名前を入力し、選択**追加**します。  選択することもできます、**参照**名前を Active Directory を検索するボタンをクリックします。  両方が表示されたら**選択されているサーバー**、選択**次**します。

5. **テスト オプション**ウィンドウで、 **(推奨) すべてのテストを実行する**と**次**します。

6. **確認** ページで、表示されますがチェックのすべてのテストの一覧。  選択**次**とテストが開始されます。

7. 完了すると、**概要**テストの実行後、ページが表示されます。 結果を解釈する際に役立つヘルプ トピックを表示する をクリックして**クラスター検証テストの詳細**します。

8. 概要 ページでは、レポートの表示をクリックし、テスト結果を確認します。 構成に必要な変更を加えるし、テストを再実行します。 <br>ウィザードを閉じた後は、テストの結果を表示するを参照してください。 *SystemRoot\Cluster\Reports\Validation Report date and time.html*します。

9. フェールオーバー クラスターの管理で、ウィザードを閉じた後に、クラスターの検証についてのヘルプ トピックを表示するには、ヘルプ をクリックしてください、ヘルプ トピックをクリックして、目次 タブをクリックして、フェールオーバー クラスター ヘルプの内容を展開およびフェールオーバー クラスター構成の検証 をクリックしてください.

#### <a name="using-powershell"></a>PowerShell を使用する

1. [スタート] ボタンを右クリックして選択し、管理用の PowerShell セッションを開く**Windows PowerShell (管理者)** します。

2. フェールオーバー クラスタ リングのマシン (たとえば、NODE1 と NODE2 コンピューター名) を検証するには、コマンドを実行します。

    ```PowerShell
    Test-Cluster -Node "NODE1","NODE2"
    ```
4. ウィザードを閉じた後は、テストの結果を表示するには、指定されたファイルを参照してください (SystemRoot\Cluster\Reports で\)構成に必要な変更を加えるし、テストを再実行します。

詳細については、次を参照してください。[フェールオーバー クラスター構成の検証](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134244(v=ws.11))です。

### <a name="step-4-create-the-cluster"></a>手順 4:クラスターを作成します。

次はマシンと構成からクラスターを作成します。

#### <a name="using-failover-cluster-manager"></a>フェールオーバー クラスター マネージャーを使用

1. **サーバー マネージャー**、選択、**ツール**ドロップダウンを選択して**フェールオーバー クラスター マネージャー**します。

2. **フェールオーバー クラスター マネージャー**、中央の列の下に移動して、**管理**選択**クラスターの作成**です。

3. 場合、**開始する前に**ウィンドウが開き、選択**次**します。

4. **サーバーの選択**ウィンドウで、クラスターのノードとなる 2 つのマシンの名前に追加します。  たとえば、名前は NODE1 および NODE2 場合、名前を入力し、選択**追加**します。  選択することもできます、**参照**名前を Active Directory を検索するボタンをクリックします。  両方が表示されたら**選択されているサーバー**、選択**次**します。

5. **クラスター管理用のアクセス ポイント**ウィンドウで、使用する場合は、クラスターの名前を入力します。  ファイル共有への接続に使用する名前ではないことに注意してください。  これは、単に、クラスターを管理するため。

   > [!NOTE]
   > 静的 IP アドレスを使用している場合は、クラスター名を使用する IP アドレスの入力を使用してネットワークを選択する必要があります。  独自の IP アドレスを DHCP を使用している場合、IP アドレスを自動的に構成されます。

6. 選択**次**します。

7. **確認**構成を確認し、選択の確認 ページで、**次**クラスターを作成します。

8. **概要** ページで、表示されますが、作成、構成します。  作成のレポートを表示するレポートの表示を選択することができます。

#### <a name="using-powershell"></a>PowerShell を使用する

1. [スタート] ボタンを右クリックして選択し、管理用の PowerShell セッションを開く**Windows PowerShell (管理者)** します。

2. 静的 IP アドレスを使用している場合、クラスターを作成するには、次のコマンドを実行します。  マシン名は NODE1 および NODE2 など、クラスターの名前は、クラスターになります、および IP アドレスは 1.1.1.1 になります。

   ```PowerShell
    New-Cluster -Name CLUSTER -Node "NODE1","NODE2" -StaticAddress 1.1.1.1
   ```

3. IP アドレスの DHCP を使用している場合、クラスターを作成するには、次のコマンドを実行します。  たとえば、マシン名は NODE1 および NODE2 とクラスターの名前がクラスターになります。

   ```PowerShell    
   New-Cluster -Name CLUSTER -Node "NODE1","NODE2"
   ```

### <a name="steps-for-configuring-a-file-server-failover-cluster"></a>ファイル サーバーのフェールオーバー クラスターを構成する手順

次のファイル サーバーのフェールオーバー クラスターを構成するには以下の手順。

1. **サーバー マネージャー**、選択、**ツール**ドロップダウンを選択して**フェールオーバー クラスター マネージャー**します。

2. フェールオーバー クラスター マネージャーが開いたら、その作成したクラスターの名前に自動的に表示されます。  そうでない場合は、中央の列の下に移動**管理**選択**クラスターに接続する**します。  作成したクラスターの名前を入力し、 **OK**します。

3. コンソール ツリーで、クリックして、">"、その下にある項目を展開するために作成したクラスターの横にある記号。

4. マウスの右クリック**ロール**選択**役割の構成**します。

5. 場合、**開始する前に**ウィンドウが開き、選択**次**します。

6. ロールの一覧で選択**ファイル サーバー**と**次**します。

7. ファイル サーバーの種類を選択**汎用ファイル サーバー**と**次**します。<br>詳細については、スケール アウト ファイル サーバーは、次を参照してください。[スケール アウト ファイル サーバーの概要](sofs-overview.md)します。

   ![ファイル サーバーの種類](media\Cluster-File-Server\Cluster-FS-File-Server-Type.png)

8. **クライアント アクセス ポイント**ウィンドウで、使用する場合は、ファイル サーバーの名前を入力します。  クラスターの名前ではないことに注意してください。  これは、ファイルの接続を共有します。  たとえばに接続する場合\\サーバー、サーバーが入力された名前にするとします。

   > [!NOTE]
   > 静的 IP アドレスを使用している場合は、クラスター名を使用する IP アドレスの入力を使用してネットワークを選択する必要があります。  独自の IP アドレスを DHCP を使用している場合、IP アドレスを自動的に構成されます。

6. 選択**次**します。

7. **記憶域の**ウィンドウで、共有を保持する追加のドライブ (監視ではない) を選択および**次へ**。

8. **確認**ページで、構成を確認し、選択**次**します。

9. **概要** ページで、表示されますが、作成、構成します。  ファイル サーバー ロールの作成のレポートを表示するレポートの表示を選択することができます。

10. **ロール**コンソール ツリーで、作成した名として表示されている作成した新しいロールが表示されます。  強調表示され、下、**アクション**、右側のペインが選択**共有を追加する**します。

11. 次のように入力共有ウィザードを実行します。

    - 共有の種類
    - 場所/パスの共有フォルダーになります
    - 共有ユーザーの名前に接続します。
    - 暗号化などのキャッシュ アクセス ベースの列挙などの追加設定
    - ファイル レベルのアクセス許可の既定値以外になる場合

12. **確認**構成を確認し、選択の確認 ページで、**作成**ファイル サーバー共有を作成します。

13. **結果**ページで、共有が作成された場合は、閉じるを選択します。  共有を作成できなかった場合に表示されます発生したエラー。

14. 選択**閉じる**します。

15. 追加の共有をこのプロセスを繰り返します。