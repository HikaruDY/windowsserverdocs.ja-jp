---
ms.assetid: 75cc1d24-fa2f-45bd-8f3b-1bbd4a1aead0
title: クラスター対応更新の要件とベスト プラクティス
ms.prod: windows-server-threshold
ms.topic: article
ms.manager: dongill
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 08/06/2018
description: クラスター対応更新を使用して、Windows Server を実行するクラスターで更新プログラムをインストールするための要件。
ms.openlocfilehash: 32fa77ca2c24d75347d61f9bdeb4c5c93a20d89d
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2019
ms.locfileid: "66439682"
---
# <a name="cluster-aware-updating-requirements-and-best-practices"></a>クラスター対応更新の要件とベスト プラクティス

>適用対象:Windows Server 2019、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

このセクションでは、要件と使用するために必要な依存関係について説明します。 [Cluster-aware Updating](cluster-aware-updating.md) (CAU) Windows Server を実行するフェールオーバー クラスターに更新を適用します。

> [!NOTE]  
> プラグを使用する場合は、更新プログラムを適用する準備が、クラスター環境と独立して検証する必要があります\-以外で**Microsoft.WindowsUpdatePlugin**します。 非を使用している場合\-Microsoft プラグ\-詳細については、発行元にお問い合わせください。 プラグインの詳細については\-、アドインを参照してください[方法プラグイン\-アドイン機能](cluster-aware-updating-plug-ins.md)します。   

## <a name="BKMK_REQ_CLUS"></a>フェールオーバー クラスタ リング機能とフェールオーバー クラスタ リング ツールをインストールします。  
CAU を利用するには、フェールオーバー クラスタリング機能とフェールオーバー クラスタリング ツールをインストールする必要があります。 フェールオーバー クラスタ リング ツールは、CAU ツールを含む\(clusterawareupdating.dll\)、フェールオーバー クラスタ リングのコマンドレットと CAU 操作に必要なその他のコンポーネント。 フェールオーバー クラスタリング機能のインストール手順については、「 [フェールオーバー クラスタリング機能とツールのインストール](create-failover-cluster.md#install-the-failover-clustering-feature)」をご覧ください。  

フェールオーバー クラスタ リング ツールの正確なインストール要件は、CAU がフェールオーバー クラスターでクラスター化された役割として更新プログラムを調整するかどうかに依存して\(自己を使用して\-更新モード\)またはリモート コンピューターから。 Self\-CAU ツールを使用して、フェールオーバー クラスターで CAU のクラスター化された役割のインストール モードの CAU をさらに更新が必要です。    

次の表は、2 つの CAU 更新モードの CAU 機能インストール要件をまとめたものです。  

|インストールされているコンポーネント|Self\-更新モード|リモート\-更新モード|  
|-----------------------|-----------------------|-------------------------|  
|フェールオーバー クラスタリング機能|すべてのクラスター ノードで必要|すべてのクラスター ノードで必要|  
|フェールオーバー クラスタリング ツール|すべてのクラスター ノードで必要|リモコンの必須\-コンピューターの更新<br />-すべてのクラスター ノードで実行する必要する、 [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレット|  
|CAU のクラスター化された役割|必須|不要|  

## <a name="obtain-an-administrator-account"></a>管理者アカウントの取得  
CAU 機能を使用するには、次の管理者要件が必要です。  

-   プレビューまたは CAU ユーザー インターフェイスを使用して更新アクションを適用する\(UI\)か、クラスター対応更新のコマンドレットをすべてのクラスター ノードでローカル管理者権限とアクセス許可を持つドメイン アカウントを使用する必要があります。 アカウントは、すべてのノードに十分な特権を持っていない場合、は、これらのアクションを実行するときに必要な資格情報を指定する、クラスター対応更新 ウィンドウで求められます。 使用する、 [Cluster-aware Updating](https://docs.microsoft.com/powershell/module/clusterawareupdating/?view=win10-ps)コマンドレットでは、コマンドレット パラメーターとして必要な資格情報を指定することができます。  

-   CAU をリモートで使用する場合\-クラスター ノードでローカル管理者権限とアクセス許可がしないアカウントでサインインしているときに、更新モードをする必要があります、CAU ツールを実行に管理者としてをローカル管理者アカウントを使用して、更新コーディネーター コンピューター、またはを持つアカウントを使用して、**認証後にクライアントを偽装**ユーザー権限。 

-   CAU ベスト プラクティス アナライザーを実行するには、クラスター ノードに対して管理者特権と実行に使用されるコンピューターに対してローカル管理者特権を持つアカウントを使用する必要があります、 [Test-causetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps)コマンドレットまたは分析するにはクラスター更新の準備がクラスター対応更新 ウィンドウを使用します。 詳細については、「 [クラスター更新の準備のテスト](#BKMK_BPA)」を参照してください。  

## <a name="verify-the-cluster-configuration"></a>クラスター構成の検証  
次は、CAU による更新をサポートするためのフェールオーバー クラスターの一般要件です。 ノードのリモート管理の追加構成要件はこのトピックの後半の「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」にあります。  

-   クラスターの定足数が確保されるだけ十分な数のクラスター ノードがオンラインになっている必要があります。  

-   すべてのクラスター ノードが同じ Active Directory ドメインにある必要があります。  

-   クラスター名は DNS を利用し、ネットワーク上で解決する必要があります。  

-   CAU をリモートで使用する場合\-モードを更新するには、Update Coordinator コンピューターで、フェールオーバー クラスター ノードへのネットワーク接続が必要し、フェールオーバー クラスターと同じ Active Directory ドメインにする必要があります。  

-   すべてのクラスター ノードでクラスター サービスを実行している必要があります。 既定では、このサービスはすべてのクラスター ノードにインストールされ、自動的に開始するように構成されています。  

-   前の PowerShell を使用する\-投稿を更新または\-CAU 更新実行中にスクリプトの更新をスクリプトがすべてのクラスター ノードにインストールされているか、可用性の高いネットワーク ファイル共有にアクセスできるすべてのノードにいることを確認してください。 スクリプトがネットワーク ファイル共有に保存される場合、Everyone グループの読み取りアクセスのフォルダーを構成します。  

## <a name="BKMK_NODE_CONFIG"></a>ノードのリモート管理を構成します。  
クラスター対応更新を使用するには、リモート管理のため、クラスターのすべてのノードを構成する必要があります。 既定では、タスクだけ行う必要がありますのリモート管理のノードを構成する[自動再起動を許可するファイアウォール規則を有効にする](#BKMK_FW)します。 

次の表では、環境は、既定値から分化場合に、完全なリモート管理の要件が一覧表示します。

これらの要件は、「 [フェールオーバー クラスタリング機能とフェールオーバー クラスタリング ツールのインストール](#BKMK_REQ_CLUS) 」のイントール要件と本トピックの前のセクションで説明した一般的なクラスタリング要件に追加されるものです。  

|要件|既定の状態|Self\-更新モード|リモート\-更新モード|  
|---------------|---|-----------------------|-------------------------|  
|[自動再起動を許可するファイアウォール規則を有効にします。](#BKMK_FW)|Disabled|ファイアウォールが使用される場合にすべてのクラスター ノードで必要|ファイアウォールが使用される場合にすべてのクラスター ノードで必要|  
|[Windows Management Instrumentation を有効にします。](#BKMK_WMI)|有効|すべてのクラスター ノードで必要|すべてのクラスター ノードで必要|  
|[Windows PowerShell 3.0 または 4.0 と Windows PowerShell リモート処理を有効にします。](#BKMK_PS)|有効|すべてのクラスター ノードで必要|次を実行するすべてのクラスター ノードで必要:<br /><br />- [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレット<br />-PowerShell pre\-更新し、投稿\-更新実行中にスクリプトを更新<br />クラスター更新のクラスター対応更新 ウィンドウを使用する準備のテストまたは[テスト\-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) Windows PowerShell コマンドレット|  
|[.NET Framework 4.6 または 4.5 をインストールします。](#BKMK_NET)|有効|すべてのクラスター ノードで必要|次を実行するすべてのクラスター ノードで必要:<br /><br />- [Save-caudebugtrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps)コマンドレット<br />-PowerShell pre\-更新し、投稿\-更新実行中にスクリプトを更新<br />クラスター更新のクラスター対応更新 ウィンドウを使用する準備のテストまたは[テスト\-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) Windows PowerShell コマンドレット|  

### <a name="BKMK_FW"></a>自動再起動を許可するファイアウォール規則を有効にします。  
更新プログラムが適用された後に自動再起動を許可する\(更新プログラムのインストールには、再起動が必要な場合\)場合は、Windows ファイアウォールまたは非\-Microsoft ファイアウォールが、クラスター ノードで使用されるでのファイアウォール規則を有効にする必要があります次のトラフィックを許可する各ノード:  

-   プロトコル:TCP  

-   方向: 受信  

-   プログラム: wininit.exe  

-   ポート:RPC 動的ポート  

-   プロファイル:ドメイン  

Windows ファイアウォールをクラスター ノードで使用する場合、クラスター ノードごとに **[リモート シャットダウン]** Windows ファイアウォール規則グループを有効にします。 クラスター対応更新 ウィンドウを使用すると更新プログラムを適用し、自身を構成する\-更新オプション、**リモート シャット ダウン**Windows ファイアウォール規則グループが各クラスター ノードで自動的に有効にします。  

> [!NOTE]  
> Windows ファイアウォールのグループ ポリシー設定と競合する場合、 **Remote Shutdown** Windows ファイアウォール規則グループは有効になりません。    

**リモート シャット ダウン**ファイアウォール規則グループは指定することで有効になっていることも、 **– EnableFirewallRules**パラメーターは、次の CAU コマンドレットを実行している場合。[Add-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole?view=win10-ps)、 [Invoke-caurun](https://docs.microsoft.com/powershell/module/clusterawareupdating/Invoke-CauRun?view=win10-ps)、および[SetCauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole?view=win10-ps)します。  

次の PowerShell の例では、クラスター ノードの自動再起動を有効にする追加のメソッドを示します。  

```PowerShell  
Set-NetFirewallRule -Group "@firewallapi.dll,-36751" -Profile Domain -Enabled true  
```  

### <a name="BKMK_WMI"></a>Windows Management Instrumentation (WMI) を有効にします。 
Windows Management Instrumentation を使用してリモート管理には、すべてのクラスター ノードを構成する必要があります\(WMI\)します。 これは既定で有効になっています。  

リモート管理を手動で有効にするには、次のように操作します。  

1.  サービス コンソールで、 **[Windows リモート管理]** サービスを開始し、起動タイプを **[自動]** に設定します。  

2.  実行、 [Set-wsmanquickconfig](https://docs.microsoft.com/powershell/module/Microsoft.WsMan.Management/Set-WSManQuickConfig?view=powershell-6)コマンドレット、または管理者特権のコマンドから、次のコマンドの実行を要求します。  

    ```PowerShell  
    winrm quickconfig -q  
    ```  

Windows ファイアウォールが、クラスター ノードで使用される場合を WMI リモート処理をサポートする受信ファイアウォールの規則の**Windows リモート管理\(HTTP\-で\)** 各ノードで有効にする必要があります。  既定では、この規則は有効になっています。  

### <a name="BKMK_PS"></a>Windows PowerShell と Windows PowerShell リモート処理を有効にします。  
自己を有効にする\-モードおよびリモートで特定の CAU 機能の更新\-モードを更新するには、PowerShell をインストールし、すべてのクラスター ノードでリモート コマンドを実行するを有効にします。 既定では、PowerShell をインストールして、リモート処理用に有効にします。  

PowerShell リモート処理を有効にするには、次のメソッドのいずれかを使用します。  

-   実行、 [Enable-psremoting](https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Enable-PSRemoting)コマンドレット。  

-   ドメインを構成する\-Windows リモート管理のグループ ポリシー設定をレベル\(WinRM\)します。  

PowerShell リモート処理を有効にする方法の詳細については、次を参照してください。 [About_remote_requirements](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_remote_requirements?view=powershell-6)します。  

### <a name="BKMK_NET"></a>.NET Framework 4.6 または 4.5 をインストールします。  
自己を有効にする\-モードおよびリモートで特定の CAU 機能の更新\-モード、.NET Framework 4.6、または (Windows Server 2012 R2) で .NET Framework 4.5 に更新がすべてのクラスター ノードにインストールする必要があります。 既定では、NET Framework がインストールされています。  

をまだインストールされていない場合は、PowerShell を使用して、.NET Framework 4.6 (または 4.5) をインストールするには、次のコマンドを使用します。

```PowerShell
Install-WindowsFeature -Name NET-Framework-45-Core
```

## <a name="BKMK_BEST_PRAC"></a>クラスター対応更新の使用に関する推奨事項のベスト プラクティスします。 

### <a name="BKMK_BP_WUA"></a>Microsoft 更新プログラムを適用するための推奨事項

お勧めしますが、既定値は、更新プログラムを適用する CAU の使用を開始するときに**Microsoft.WindowsUpdatePlugin**プラグイン\-でクラスターでは、停止するその他のメソッドを使用して、クラスターに Microsoft からソフトウェア更新プログラムをインストールするにはノード。  

> [!CAUTION]  
> 個々 のノードを自動的に更新するメソッドと CAU を組み合わせると\(固定されたタイム スケジュールで\)サービスと計画外のダウンタイムでの中断を含む、予期しない結果が発生することができます。  

次のガイドラインに従うことをお勧めします。  

-   最適な結果を得るために、たとえば、コントロール パネルの自動更新設定やグループ ポリシーを利用して構成される設定を利用し、クラスター ノードの自動更新設定を無効にすることをお勧めします。  

    > [!CAUTION]  
    > クラスター ノードの更新の自動インストールが CAU による更新のインストールに干渉し、CAU にエラーが発生することがあります。  

    必要であれば、次の自動更新設定が CAU と共存します。管理者が更新インストールのタイミングを制御できるためです。  

    -   更新のダウンロード前に通知するための設定とインストール前に通知するための設定  

    -   更新を自動的にダウンロードするための設定とインストール前に通知するための設定  

    ただし、自動更新が CAU 更新実行と同時に更新をダウンロードする場合、更新実行の完了に時間がかかることがあります。  

-   Windows Server Update Services などの更新システムを構成しない\(WSUS\)自動的に更新プログラムを適用する\(固定されたタイム スケジュールで\)クラスター ノードにします。  

-   WSUS サーバー、Windows 更新、マイクロソフト更新など、同じ更新元を利用するように、すべてのクラスター ノードを等しく構成する必要があります。  

-   構成管理システムを使用してネットワーク上のコンピューターにソフトウェア更新を適用する場合は、必要な更新または自動更新からクラスター ノードを除外してください。 構成管理システムの例として、Microsoft System Center Configuration Manager 2007 や Microsoft System Center Virtual Machine Manager 2008 があります。  

-   場合は内部のソフトウェア配布サーバー \(WSUS サーバーなど\)使用を含む、更新プログラムを展開し、それらのサーバーがクラスター ノードの承認済み更新プログラムを正しく識別することを確認します。  

#### <a name="BKMK_PROXY"></a>ブランチ オフィス シナリオでの Microsoft 更新プログラムを適用します。  
特定の支店シナリオで Microsoft Update または Windows Update からクラスター ノードにマイクロソフト更新をダウンロードするには、ノードごとに、ローカル システム アカウントのプロキシ設定を構成する必要があります。 たとえば、支店のクラスターがローカル プロキシ サーバーを利用し、Microsoft Update または Windows Update にアクセスして更新をダウンロードする場合にこの作業が必要になります。  

必要に応じて、ローカル プロキシ サーバーを指定し、ローカル アドレス例外を構成する各ノードで WinHTTP プロキシ設定を構成する\(ローカル アドレスのバイパス リストは、\)します。 その場合、管理者特権のコマンド プロンプトでクラスター ノードごとに次のコマンドを実行できます。  

```  
netsh winhttp set proxy <ProxyServerFQDN >:<port> "<local>"  
```  

場所 <*ProxyServerFQDN*> はプロキシ サーバーの完全修飾ドメイン名と <*ポート*> 経由で通信に使用するポート (通常はポート 443)。  

たとえば、プロキシ サーバーを指定するローカル システム アカウントの WinHTTP プロキシ設定を構成する*MyProxy.CONTOSO.com*ポート 443 と、ローカル アドレス例外で、次のコマンドを入力します。  

```  
netsh winhttp set proxy MyProxy.CONTOSO.com:443 "<local>"  
```  

### <a name="BKMK_BP_HF"></a>Microsoft.HotfixPlugin の使用に関する推奨事項  

-   修正プログラムのルート フォルダーと構成ファイルにアクセス許可を設定し、これらのファイルの保管に使用されるコンピューターに対してローカル管理者にのみ書き込みアクセスを許可することをお勧めします。 それにより、無許可のユーザーがこれらのファイルを改ざんし、修正プログラムの適用時にフェールオーバー クラスターの機能を損なうような事態を防止できます。  

-   サーバー メッセージ ブロックのデータの整合性を確保しやすく\(SMB\) 、修正プログラム ルート フォルダーのアクセスに使用される接続を設定します SMB 暗号化、SMB 共有フォルダーにそれを構成する可能性がある場合。 **Microsoft.HotfixPlugin** を利用するには、SMB 接続のデータ完全性を維持するように SMB 署名または SMB 暗号化を構成する必要があります。 

    詳細については、次を参照してください。 [、修正プログラム ルート フォルダーと修正プログラム構成ファイルへのアクセス制限](cluster-aware-updating-plug-ins.md#BKMK_ACL)します。

### <a name="additional-recommendations"></a>追加の推奨事項  

-   同じ時間にスケジュールされる可能性がある CAU 更新実行を邪魔しないように、スケジュールされている保守管理時間帯にクラスター名オブジェクトと仮想コンピューター オブジェクトにパスワード変更をスケジュールしないでください。  

-   前に適切なアクセス許可を設定する必要があります\-更新し、投稿\-更新スクリプトをネットワーク上に保存されているが承認されていないユーザーがこれらのファイルの潜在的な改ざんを防止するフォルダーを共有します。  

-   自身で CAU を構成する\-モードでは、仮想コンピューター オブジェクトを更新\(VCO\) Active Directory で CAU のクラスター化された役割を作成する必要があります。 CAU は、フェールオーバー クラスターに十分なアクセス許可があれば、CAU のクラスター化された役割が追加された時点でこのオブジェクトを自動的に作成できます。 ただし、一部の組織ではセキュリティ ポリシーにより、Active Directory にオブジェクトを事前登録する必要があります。 この手順については、「 [クラスター化された役割のアカウントを事前登録するための手順](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731002\(v=ws.10\)#steps-for-prestaging-the-cluster-name-account)」をご覧ください。  

-   IT 組織内で同様に更新する必要があるフェールオーバー クラスター全体に更新実行設定を保存し、再利用するために、更新実行プロファイルを作成できます。 また、更新モードにもよりますが、すべてのリモート Update Coordinator コンピューターまたはフェールオーバー クラスターにアクセスできるファイル共有に更新実行プロファイルを保存し、管理できます。 詳細については、次を参照してください。[高度なオプションとに対して CAU 更新実行プロファイル](cluster-aware-updating-options.md)します。  

## <a name="BKMK_BPA"></a>テスト クラスターの更新の準備  
CAU ベスト プラクティス アナライザーを実行する\(BPA\)フェールオーバー クラスターとネットワーク環境が CAU によって適用されるソフトウェア更新プログラムの要件の多くを満たすかどうかをテストするモデル。 既定のプラグインを使用して、Microsoft 更新プログラムを適用する準備の環境を確認、テストの多く\-、 **Microsoft.WindowsUpdatePlugin**します。  

> [!NOTE]  
> プラグを使用してソフトウェア更新プログラムを適用する準備が、クラスター環境と独立して検証する必要があります\-以外で**Microsoft.WindowsUpdatePlugin**します。 非を使用している場合\-Microsoft プラグ\-で、ハードウェアの製造元によって提供されるようにお問い合わせください、パブリッシャーの詳細についてはします。  

BPA は次の 2 通りの方法で実行できます。  

1.  CAU コンソールで **[クラスター更新の準備の分析]** を選択します。 BPA は、準備のテストが完了したら、テスト レポートが表示されます。 クラスター ノードで問題が検出された場合、是正措置をとれるように、具体的な問題と問題が発生したノードが特定されます。 テストの完了には数分かかることがあります。  

2.  実行、 [Test-causetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup)コマンドレット。 コマンドレットは、フェールオーバー クラスタ リング用 Windows PowerShell モジュール (フェールオーバー クラスタ リング ツールの一部) がインストールされているローカルまたはリモート コンピューターで実行できます。 フェールオーバー クラスターのノードでもコマンドレットを実行できます。  

> [!NOTE]  
> -   クラスター ノードに対して管理者特権と実行に使用されるコンピューターに対してローカル管理者特権を持つアカウントを使用する必要があります、**テスト\-CauSetup**コマンドレットまたはクラスターの更新の準備を分析するにはクラスター対応更新 ウィンドウを使用します。 クラスター対応更新のウィンドウを使用してテストを実行するには、必要な資格情報でコンピュータにログオンする必要があります。  
> -   このテストでは、ソフトウェア更新をプレビューし、適用するために使用される CAU ツールは、クラスター更新の準備をテストするために使用されるコンピューターと同じコンピューターから、同じユーザー資格情報で実行するものと想定しています。  

> [!IMPORTANT]  
> 次の状況でクラスター更新の準備をテストすることをお勧めします。  
>   
> -   初めて CAU を利用してソフトウェア更新を適用する前。  
> -   クラスターにノードを追加したか、クラスターの検証ウィザードの実行を必要とする他のハードウェア変更をクラスターで実行した後。  
> -   更新ソースを変更または更新の設定や構成を変更した後\(CAU 以外\)ノードで更新プログラムのアプリケーションに影響することができます。  

### <a name="tests-for-cluster-updating-readiness"></a>クラスター更新の準備のテスト  
次の表は、クラスター更新の準備のテスト、一部の共通問題、解消手順についてまとめたものです。  


|                                                      テスト                                                      |                                                                                                                                               考えられる問題と影響                                                                                                                                               |                                                                                                                                                                                         解消手順                                                                                                                                                                                         |
|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                     フェールオーバー クラスターを利用できる必要があります                                     |                                                                                       フェールオーバー クラスター名を解決できません。または、1 つまたは複数のノードにアクセスできません。 BPA がクラスターの準備テストを実行できません。                                                                                        |                                                                   -BPA 実行中に指定されたクラスターの名前のスペルを確認します。<br />-クラスターのすべてのノードがオンラインで、実行中であることを確認します。<br />-こと検証構成ウィザードを正常にクラスターで実行できます、フェールオーバーを確認します。                                                                    |
|                    WMI を利用し、フェールオーバー クラスター ノードのリモート管理を有効にする必要があります                    |                                                1 つまたは複数のフェールオーバー クラスター ノードは、Windows Management Instrumentation を使用してリモート管理を有効になっていません\(WMI\)します。 ノードのリモート管理が構成されていない場合、CAU はクラスター ノードを更新できません。                                                 |                                                                                                  WMI を利用し、すべてのフェールオーバー クラスター ノードのリモート管理を有効にします。 詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                                                   |
|                      PowerShell リモート処理は、各フェールオーバー クラスター ノードで有効にする必要があります。                       |                                                           PowerShell がインストールされていないか、1 つまたは複数のフェールオーバー クラスター ノード上のリモート処理を有効になっていません。 CAU を自己を構成できません\-更新モードまたは特定の機能を使用して、リモートで\-モードを更新します。                                                            |                                                                                             PowerShell は、すべてのクラスター ノードにインストールされているし、リモート処理が有効になってを確認してください。<br /><br />詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                                             |
|                                            フェールオーバー クラスター バージョン                                            |                                                                            フェールオーバー クラスター内の 1 つまたは複数のノードには、Windows Server 2016、Windows Server 2012 R2、または Windows Server 2012 を実行しないでください。 CAU がフェールオーバー クラスターを更新できません。                                                                             |                                                                   Windows Server 2016、Windows Server 2012 R2、または Windows Server 2012 BPA 実行中に指定されているフェールオーバー クラスターが実行されていることを確認します。<br /><br />詳細については、「 [クラスター構成の検証](#BKMK_REQ_CLUS) 」を参照してください。                                                                   |
| 必須バージョンの .NET Framework と Windows PowerShell をすべてのフェールオーバー クラスター ノードにインストールする必要があります |                                                                                              .NET framework 4.6、4.5 または Windows PowerShell は、1 つまたは複数のクラスター ノードにインストールされていません。 一部の CAU 機能が動作しないことがあります。                                                                                              |                                                                            必要な場合は、すべてのクラスター ノードで .NET Framework 4.6 または 4.5 と Windows PowerShell がインストールされていることを確認します。<br /><br />詳細については、「 [リモート管理のノードの構成](#BKMK_NODE_CONFIG) 」を参照してください。                                                                             |
|                           クラスター サービスがすべてのクラスター ノードで実行されている必要があります                           |                                                                                                            クラスター サービスが 1 つまたは複数のノードで実行されていません。 CAU がフェールオーバー クラスターを更新できません。                                                                                                             |                        -いることを確認、クラスター サービス\(clussvc\)が、クラスター内のすべてのノードで開始し、自動的に開始するように構成されます。<br />-こと検証構成ウィザードを正常にクラスターで実行できます、フェールオーバーを確認します。<br /><br />詳細については、「 [クラスター構成の検証](#BKMK_REQ_CLUS) 」を参照してください。                         |
|     フェールオーバー クラスター ノードに更新を自動インストールするように自動更新を構成してはなりません     |                                           少なくとも 1 つのクラスター ノードで、そのノードにマイクロソフト更新を自動インストールするように自動更新が構成されています。 CAU とその他の更新方法を組み合わせると、予期しないダウンタイムまたは予測できない結果を招くことがあります。                                            |                                                     1 つまたは複数のクラスター ノードで Windows Update 機能の自動更新が構成されている場合、更新を自動インストールするように自動更新が構成されていないことを確認します。<br /><br />詳細については、「 [マイクロソフト更新適用の推奨事項](#BKMK_BP_WUA)」を参照してください。                                                     |
|                          フェールオーバー クラスター ノードは同じ更新元を使用する必要があります                          |                                                    1 つまたは複数のクラスター ノードで、残りのノードとは異なる更新元がマイクロソフト更新に使用されるように構成されています。 CAU では、クラスター ノードに更新が等しく適用されない可能性があります。                                                    |                                                                        WSUS サーバー、Windows Update、Microsoft Update など、同じ更新元を使用するようにすべてのクラスター ノードが構成されていることを確認します。<br /><br />詳細については、「 [マイクロソフト更新適用の推奨事項](#BKMK_BP_WUA)」を参照してください。                                                                         |
|       リモート シャットダウンを許可するファイアウォール規則をフェールオーバー クラスターの各ノードで有効にする必要があります       |                 1 つまたは複数のフェールオーバー クラスター ノードで、リモート シャットダウンを許可するファイアウォール規則が有効になっていないか、グループ ポリシー設定によりこの規則の有効化が阻止されています。 ノードの自動再起動を要求する更新を適用する更新実行が適切に完了しないことがあります。                  |                                                                    場合は Windows ファイアウォールまたは非\-Microsoft ファイアウォールが、クラスター ノードで使用される、リモート シャット ダウンを許可するファイアウォール ルールを構成します。<br /><br />詳細については、「 [自動再起動を許可するファイアウォール規則の有効化](#BKMK_FW) 」を参照してください。                                                                    |
|          各フェールオーバー クラスター ノードのプロキシ サーバー設定をローカル プロキシ サーバーに設定する必要があります          |                             1 つまたは複数のフェールオーバー クラスター ノードのプロキシ サーバー構成が正しくありません。<br /><br />ローカル プロキシ サーバーが使用されている場合、クラスターが Microsoft Update または Windows Update にアクセスできるように、各ノードのプロキシ サーバー設定を適切に構成する必要があります。                              |                                            必要に応じて各クラスター ノードの WinHTTP プロキシ設定がローカル プロキシ サーバーに設定されていることを確認します。 環境内でプロキシ サーバーが使用されていない場合、この警告は無視できます。<br /><br />詳細については、「 [Apply updates in branch office scenarios](#BKMK_PROXY) 」を参照してください。                                            |
|        自己を有効にするフェールオーバー クラスターに CAU のクラスター化された役割をインストールする必要があります\-更新モード        |                                                                                                   CAU のクラスター化された役割がこのフェールオーバー クラスターにインストールされていません。 このロールが必要です。 クラスターの自己\-を更新しています。                                                                                                   |      自身で CAU を使用する\-更新モード、フェールオーバー クラスターで、次の方法のいずれかで CAU のクラスター化された役割を追加します。<br /><br />-実行する、 [Add-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole) PowerShell コマンドレット。<br />-選択、**クラスター構成の自己\-オプションを更新して**クラスター対応更新 ウィンドウでのアクション。      |
|         自己を有効にするフェールオーバー クラスターで CAU のクラスター化された役割を有効に\-更新モード         | CAU のクラスター化された役割が無効になっています。 たとえば、CAU のクラスター化された役割がインストールされていない、またはを使用して無効になっている、[を無効にする\-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Disable-CauClusterRole) PowerShell コマンドレット。 このロールが必要です。 クラスターの自己\-を更新しています。 | 自身で CAU を使用する\-更新モードでは、次の方法のいずれかでこのフェールオーバー クラスターで CAU のクラスター化された役割を有効にします。<br /><br />-実行する、 [Enable-cauclusterrole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Enable-CauClusterRole) PowerShell コマンドレット。<br />-選択、**クラスター構成の自己\-オプションを更新して**クラスター対応更新 ウィンドウでのアクション。 |
|      構成された CAU プラグイン\-で個人\-更新モードがすべてのフェールオーバー クラスター ノードに登録する必要があります      |                                                              CAU プラグインがこのフェールオーバー クラスターの 1 つまたは複数のノードで CAU のクラスター化された役割にアクセスできない\-self で構成されているモジュールで\-オプションを更新します。 自己\-更新実行が失敗する可能性があります。                                                              |           ように構成された CAU プラグイン\-がインストールされているすべてのクラスター ノード上の CAU プラグインを提供する製品のインストール手順を実行して\-でします。<br />-実行する、[登録\-CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin)プラグを登録する PowerShell コマンドレット\-で必要なクラスター ノード上。           |
|                すべてのフェールオーバー クラスター ノードが登録済みの CAU プラグインの同じセット必要\-アドイン                 |                                                                             自己\-更新実行が失敗する場合、プラグ\-が構成されている更新実行で使用するがないすべてのクラスター ノードで利用可能ないずれかに変更されました。                                                                              |           ように構成された CAU プラグイン\-がインストールされているすべてのクラスター ノード上の CAU プラグインを提供する製品のインストール手順を実行して\-でします。<br />-実行する、[登録\-CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin)プラグを登録する PowerShell コマンドレット\-で必要なクラスター ノード上。           |
|                               構成された更新実行オプションを有効にする必要があります                                |                                                                          Self\-このフェールオーバー クラスターが構成されているオプションのスケジュールと更新実行の更新が不完全かが無効です。 自己\-更新実行が失敗する可能性があります。                                                                           |                                                            有効な自己構成\-スケジュールと更新実行オプションのセットを更新しています。 たとえば、使用することができます、[設定\-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole)クラスター化された役割の PowerShell コマンドレット、CAU を構成します。                                                            |
|                  少なくとも 2 つのフェールオーバー クラスター ノードが CAU のクラスター化された役割の実行可能な所有者になる必要があります                  |                                                                                        更新実行で自動起動\-更新モードは、CAU のクラスター化された役割に移動する実行可能な所有者ノードがあるないために失敗します。                                                                                         |                                                                                                                フェールオーバー クラスタリング ツールを使用し、すべてのクラスター ノードが CAU のクラスター化された役割の実行可能な所有者として構成されていることを確認します。 これは既定の構成です。                                                                                                                |
|                  すべてのフェールオーバー クラスター ノードは Windows PowerShell スクリプトにアクセスできる必要があります                  |                                                                        CAU のクラスター化された役割のすべての実行可能な所有者ノードが構成されているより前の Windows PowerShell にアクセスできる\-更新し、投稿\-スクリプトを更新します。 自己\-更新実行は失敗します。                                                                        |                                                                                                                    CAU のクラスター化された役割のすべての実行可能な所有者ノードに構成されている PowerShell の以前へのアクセス許可があることを確認します。\-更新と投稿\-スクリプトを更新します。                                                                                                                     |
|                   すべてのフェールオーバー クラスター ノードで同じ Windows PowerShell スクリプトを使用する必要があります                   |                                                     CAU のクラスター化された役割のすべての実行可能な所有者ノードを使用して、指定したより前の Windows PowerShell の同じコピー\-更新し、投稿\-スクリプトを更新します。 自己\-失敗または予期しない動作を示す更新実行可能性があります。                                                     |                                                                                                                                   CAU のクラスター化された役割のすべての実行可能な所有者ノードが同じより前の PowerShell を使用することを確認\-更新し、投稿\-スクリプトを更新します。                                                                                                                                   |
|         更新実行で、WarnAfter 設定には StopAfter 設定より小さい値を指定する必要があります         |                                                                           指定されている CAU 更新実行タイムアウト値は警告タイムアウトを無効にします。 警告イベント ログが生成される前に更新実行が取り消される可能性があります。                                                                            |                                                                                                                                      更新実行オプションで、 **[WarnAfter]** オプションの値に **[StopAfter]** オプションの値よりも小さい値を指定します。                                                                                                                                       |

## <a name="see-also"></a>関連項目  

-   [クラスター対応更新の概要](cluster-aware-updating.md)